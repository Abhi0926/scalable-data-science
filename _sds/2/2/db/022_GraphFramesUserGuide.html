<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>022_GraphFramesUserGuide - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":false,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"class-node","description":"Class Node","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"class-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":false,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"class-node","spark_version":"3.5.x-scala2.11","num_workers":8,"autoscale":null,"aws_attributes":{"availability":"SPOT_WITH_FALLBACK","instance_profile_arn":null,"first_on_demand":5.0,"spot_bid_price_percent":100,"zone_id":"us-west-2a"},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"shouldShowCommandStatus":false,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"allowRunOnPendingClusters":true,"applications":false,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-eff9552bcb6cb65f96a0d9bb2b5123594d8a53fff456b3440fa6908f4263ef99","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0.1 RC (Scala 2.11)","packageLabel":"spark-image-bcd7a7b6247d51a673ce291722d0fee3654dfe50b5b04c8fba19b97c95f53fd5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-fc7e6ce873948365eb11f107b2b8b14ddd1311f5b95157dbc55667a7b1464708","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-00449cd26af8335b76ed4fe6a9cdbc7388977da83136f52ca90e548080270683","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-29871daabc403ee59cefd38533228f5815e3a5cece18deab18ce35ac8705e7a3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5ca78b83c7960ace704b397edc40a010fc3a75f713587d908a9296b771fb8530","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5e2a1a9d6a9d35bcd2a031a42f8d5ebdebd1f37f917cd95c861ac17578722b21","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-9c570ceec585af02b6759d89a19584bdf222b1bf6f3e0ebc700a7b4d0bf492a8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-d70218f5efeba85df5c5a4a4bd76135221e1b01728fbdeecead023e2d322bbb8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d1b81198d41215abe0c72e5ce4f56168b3b2acc6cb178e291f2bf04fd4f4be03","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-71baec97f74825bef2ca870a7520340c8f5ce25583e0b94960dd5242f2d813e0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":true,"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.67.1037","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":5000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":true,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":true,"enableCustomSpotPricing":true,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":1000,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":false,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"UNKNOWN_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"SPOT_WITH_FALLBACK","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2a","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":true,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":false,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":false,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableUserPromptForPendingRpc":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":false,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":198660,"name":"022_GraphFramesUserGuide","language":"scala","commands":[{"version":"CommandV1","origId":198661,"guid":"de21ccb6-e208-49c8-bb80-923b377e50b8","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n\n# [SDS-2.2, Scalable Data Science](https://lamastex.github.io/scalable-data-science/sds/2/2/)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"220463af-a147-454c-bafc-ee8a380bc2a7"},{"version":"CommandV1","origId":241020,"guid":"e5f38d77-4b08-433f-8159-18244c4015f5","subtype":"command","commandType":"auto","position":0.375,"command":"%md\nArchived YouTube video of this live unedited lab-lecture:\n\n[![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/GbyTz8Z6E-M/0.jpg)](https://www.youtube.com/embed/GbyTz8Z6E-M?start=0&end=2991&autoplay=1)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"708a928d-35c0-4054-b970-fa461ecb533b"},{"version":"CommandV1","origId":198662,"guid":"b52bc4bf-eeb2-41c6-b69a-21d6c9734fab","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n## Distribued Vertex Programming using GraphX\n\nThis is an augmentation of [http://go.databricks.com/hubfs/notebooks/3-GraphFrames-User-Guide-scala.html](http://go.databricks.com/hubfs/notebooks/3-GraphFrames-User-Guide-scala.html)\n\nSee:\n\n* [https://amplab.cs.berkeley.edu/wp-content/uploads/2014/09/graphx.pdf](https://amplab.cs.berkeley.edu/wp-content/uploads/2014/09/graphx.pdf)\n* [https://amplab.github.io/graphx/](https://amplab.github.io/graphx/)\n* [https://spark.apache.org/docs/latest/graphx-programming-guide.html](https://spark.apache.org/docs/latest/graphx-programming-guide.html)\n* [https://databricks.com/blog/2016/03/03/introducing-graphframes.html](https://databricks.com/blog/2016/03/03/introducing-graphframes.html)\n* [https://databricks.com/blog/2016/03/16/on-time-flight-performance-with-spark-graphframes.html](https://databricks.com/blog/2016/03/16/on-time-flight-performance-with-spark-graphframes.html)\n* [http://ampcamp.berkeley.edu/big-data-mini-course/graph-analytics-with-graphx.html](http://ampcamp.berkeley.edu/big-data-mini-course/graph-analytics-with-graphx.html)\n\nAnd of course the databricks guide:\n* [https://docs.databricks.com/spark/latest/graph-analysis/index.html](https://docs.databricks.com/spark/latest/graph-analysis/index.html)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f281f9ba-6aa9-4a97-b228-f1473f61d43e"},{"version":"CommandV1","origId":198663,"guid":"d81a3304-6d7c-4032-a7d9-de824186db5d","subtype":"command","commandType":"auto","position":0.5546875,"command":"//This allows easy embedding of publicly available information into any other notebook\n//when viewing in git-book just ignore this block - you may have to manually chase the URL in frameIt(\"URL\").\n//Example usage:\n// displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation#Topics_in_LDA\",250))\ndef frameIt( u:String, h:Int ) : String = {\n      \"\"\"<iframe \n src=\"\"\"\"+ u+\"\"\"\"\n width=\"95%\" height=\"\"\"\" + h + \"\"\"\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>\"\"\"\n   }\ndisplayHTML(frameIt(\"https://amplab.github.io/graphx/\",700))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://amplab.github.io/graphx/\"\n width=\"95%\" height=\"700\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506581952808,"submitTime":1506581952790,"finishTime":1506581952953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aab09255-44e2-4b03-954f-dd4f4069c5bb"},{"version":"CommandV1","origId":198664,"guid":"2c269ffd-1bf5-4234-bc70-4a5520c4e28a","subtype":"command","commandType":"auto","position":0.58203125,"command":"displayHTML(frameIt(\"https://spark.apache.org/docs/latest/graphx-programming-guide.html#optimized-representation\",800))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://spark.apache.org/docs/latest/graphx-programming-guide.html#optimized-representation\"\n width=\"95%\" height=\"800\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:34: error: not found: value frameIt\n       displayHTML(frameIt(&quot;https://spark.apache.org/docs/latest/graphx-programming-guide.html#optimized-representation&quot;,800))\n                   ^\n</div>","error":null,"workflows":[],"startTime":1506575925345,"submitTime":1506575934802,"finishTime":1506575925461,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"86af3671-3043-4f84-8d90-39364aa7c405"},{"version":"CommandV1","origId":198665,"guid":"74bf5777-f88e-43bf-80d2-50c439a5e223","subtype":"command","commandType":"auto","position":0.71875,"command":"%md \n# GraphFrames User Guide (Scala)\n\nGraphFrames is a package for Apache Spark which provides DataFrame-based Graphs. It provides high-level APIs in Scala, Java, and Python. It aims to provide both the functionality of GraphX and extended functionality taking advantage of Spark DataFrames. This extended functionality includes motif finding, DataFrame-based serialization, and highly expressive graph queries.\n\nThe GraphFrames package is available from [Spark Packages](http://spark-packages.org/package/graphframes/graphframes).\n\nThis notebook demonstrates examples from the [GraphFrames User Guide](http://graphframes.github.io/user-guide.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375236878,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d0e136a-8388-4c2c-b3fc-90b427eb90f5"},{"version":"CommandV1","origId":198666,"guid":"79d92961-7965-4459-9425-f3b2666a8986","subtype":"command","commandType":"auto","position":0.9375,"command":"displayHTML(frameIt(\"https://databricks.com/blog/2016/03/03/introducing-graphframes.html\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://databricks.com/blog/2016/03/03/introducing-graphframes.html\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/ml-features.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1462416652806,"submitTime":1462416482947,"finishTime":1462416652944,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea5a611d-34fb-474d-9b3b-72aa45638fe6"},{"version":"CommandV1","origId":198667,"guid":"b0085ba9-7f1a-4f51-9dee-d81b256739b0","subtype":"command","commandType":"auto","position":1.09375,"command":"// we first need to install the library - graphframes as a Spark package - and attach it to our cluster\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\n\nimport org.graphframes._","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.graphframes._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506579262406,"submitTime":1506579262188,"finishTime":1506579268813,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05b67201-9006-4a7a-97cd-ea735fb88820"},{"version":"CommandV1","origId":198668,"guid":"bf3c3275-ac7f-4b0c-88e7-a8aa3b45ba22","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n##Creating GraphFrames\n\nLet us try to create an example social network from the blog: \n* [https://databricks.com/blog/2016/03/03/introducing-graphframes.html](https://databricks.com/blog/2016/03/03/introducing-graphframes.html).\n\n![https://databricks.com/wp-content/uploads/2016/03/social-network-graph-diagram.png](https://databricks.com/wp-content/uploads/2016/03/social-network-graph-diagram.png)\n\nUsers can create GraphFrames from vertex and edge DataFrames.\n\n* **Vertex DataFrame:** A vertex DataFrame should contain a special column named `id` which specifies unique IDs for each vertex in the graph.\n* **Edge DataFrame:** An edge DataFrame should contain two special columns: `src` (source vertex ID of edge) and `dst` (destination vertex ID of edge).\n\nBoth DataFrames can have arbitrary other columns. Those columns can represent vertex and edge attributes.\n\nIn our example, we can use a GraphFrame can store data or properties associated with each vertex and edge. \n\nIn our social network, each user might have an age and name, and each connection might have a relationship type.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375237064,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1d983ce-5201-4ea1-bf98-fa11b551f47a"},{"version":"CommandV1","origId":198669,"guid":"712f2fcc-7de7-43f7-96e0-89b7a5226450","subtype":"command","commandType":"auto","position":2.0,"command":"%md\nCreate the vertices and edges","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"335b6387-c91e-4664-a579-3de651965098"},{"version":"CommandV1","origId":198670,"guid":"617a7127-b647-4129-9159-dbf263e45564","subtype":"command","commandType":"auto","position":2.5,"command":"// Vertex DataFrame\nval v = sqlContext.createDataFrame(List(\n  (\"a\", \"Alice\", 34),\n  (\"b\", \"Bob\", 36),\n  (\"c\", \"Charlie\", 30),\n  (\"d\", \"David\", 29),\n  (\"e\", \"Esther\", 32),\n  (\"f\", \"Fanny\", 36),\n  (\"g\", \"Gabby\", 60)\n)).toDF(\"id\", \"name\", \"age\")\n// Edge DataFrame\nval e = sqlContext.createDataFrame(List(\n  (\"a\", \"b\", \"friend\"),\n  (\"b\", \"c\", \"follow\"),\n  (\"c\", \"b\", \"follow\"),\n  (\"f\", \"c\", \"follow\"),\n  (\"e\", \"f\", \"follow\"),\n  (\"e\", \"d\", \"friend\"),\n  (\"d\", \"a\", \"friend\"),\n  (\"a\", \"e\", \"friend\")\n)).toDF(\"src\", \"dst\", \"relationship\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">v: org.apache.spark.sql.DataFrame = [id: string, name: string ... 1 more field]\ne: org.apache.spark.sql.DataFrame = [src: string, dst: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579276151,"submitTime":1506579276129,"finishTime":1506579278251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"222d4037-b350-458b-bd2c-1407ee386873"},{"version":"CommandV1","origId":198671,"guid":"ab04b7e4-bea9-4225-91c3-0a66b75258be","subtype":"command","commandType":"auto","position":3.0,"command":"%md \nLet's create a graph from these vertices and these edges:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7fa42626-7a0e-474e-9517-cd4981589408"},{"version":"CommandV1","origId":198672,"guid":"d9a93f99-ee5e-44ed-b966-dfe3c4a38c2a","subtype":"command","commandType":"auto","position":3.5,"command":"val g = GraphFrame(v, e)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">g: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">error: missing or invalid dependency detected while loading class file 'GraphFrame.class'.\nCould not access type Logging in package org.apache.spark,\nbecause it (or its dependencies) are missing. Check your build definition for\nmissing or conflicting dependencies. (Re-run with `-Ylog-classpath` to see the problematic classpath.)\nA full rebuild may help if 'GraphFrame.class' was compiled against an incompatible version of org.apache.spark.\n</div>","error":null,"workflows":[],"startTime":1506579288290,"submitTime":1506579288271,"finishTime":1506579288687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1126d068-b892-4f21-aea3-276a8cc31db2"},{"version":"CommandV1","origId":198673,"guid":"e77b49b8-97fd-4350-b981-1a169900a759","subtype":"command","commandType":"auto","position":3.75,"command":"%md\nLet's use the d3.graphs to visualise graphs (recall the D3 graphs in wiki-click example).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ee58e3b2-dbda-4293-a825-bf0d4d807a15"},{"version":"CommandV1","origId":198674,"guid":"875a72c3-eb0f-4a92-a4cc-c38bd21df0d7","subtype":"command","commandType":"auto","position":4.0,"command":"package d3\n// We use a package object so that we can define top level classes like Edge that need to be used in other cells\n// This was modified by Ivan Sadikov to make sure it is compatible the latest databricks notebook\n\nimport org.apache.spark.sql._\nimport com.databricks.backend.daemon.driver.EnhancedRDDFunctions.displayHTML\n\ncase class Edge(src: String, dest: String, count: Long)\n\ncase class Node(name: String)\ncase class Link(source: Int, target: Int, value: Long)\ncase class Graph(nodes: Seq[Node], links: Seq[Link])\n\nobject graphs {\n// val sqlContext = SQLContext.getOrCreate(org.apache.spark.SparkContext.getOrCreate())  /// fix\nval sqlContext = SparkSession.builder().getOrCreate().sqlContext\nimport sqlContext.implicits._\n  \ndef force(clicks: Dataset[Edge], height: Int = 100, width: Int = 960): Unit = {\n  val data = clicks.collect()\n  val nodes = (data.map(_.src) ++ data.map(_.dest)).map(_.replaceAll(\"_\", \" \")).toSet.toSeq.map(Node)\n  val links = data.map { t =>\n    Link(nodes.indexWhere(_.name == t.src.replaceAll(\"_\", \" \")), nodes.indexWhere(_.name == t.dest.replaceAll(\"_\", \" \")), t.count / 20 + 1)\n  }\n  showGraph(height, width, Seq(Graph(nodes, links)).toDF().toJSON.first())\n}\n\n/**\n * Displays a force directed graph using d3\n * input: {\"nodes\": [{\"name\": \"...\"}], \"links\": [{\"source\": 1, \"target\": 2, \"value\": 0}]}\n */\ndef showGraph(height: Int, width: Int, graph: String): Unit = {\n\ndisplayHTML(s\"\"\"\n<style>\n\n.node_circle {\n  stroke: #777;\n  stroke-width: 1.3px;\n}\n\n.node_label {\n  pointer-events: none;\n}\n\n.link {\n  stroke: #777;\n  stroke-opacity: .2;\n}\n\n.node_count {\n  stroke: #777;\n  stroke-width: 1.0px;\n  fill: #999;\n}\n\ntext.legend {\n  font-family: Verdana;\n  font-size: 13px;\n  fill: #000;\n}\n\n.node text {\n  font-family: \"Helvetica Neue\",\"Helvetica\",\"Arial\",sans-serif;\n  font-size: 17px;\n  font-weight: 200;\n}\n\n</style>\n\n<div id=\"clicks-graph\">\n<script src=\"//d3js.org/d3.v3.min.js\"><\/script>\n<script>\n\nvar graph = $graph;\n\nvar width = $width,\n    height = $height;\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n    .charge(-700)\n    .linkDistance(180)\n    .size([width, height]);\n\nvar svg = d3.select(\"#clicks-graph\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    \nforce\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n\nvar link = svg.selectAll(\".link\")\n    .data(graph.links)\n    .enter().append(\"line\")\n    .attr(\"class\", \"link\")\n    .style(\"stroke-width\", function(d) { return Math.sqrt(d.value); });\n\nvar node = svg.selectAll(\".node\")\n    .data(graph.nodes)\n    .enter().append(\"g\")\n    .attr(\"class\", \"node\")\n    .call(force.drag);\n\nnode.append(\"circle\")\n    .attr(\"r\", 10)\n    .style(\"fill\", function (d) {\n    if (d.name.startsWith(\"other\")) { return color(1); } else { return color(2); };\n})\n\nnode.append(\"text\")\n      .attr(\"dx\", 10)\n      .attr(\"dy\", \".35em\")\n      .text(function(d) { return d.name });\n      \n//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements\nforce.on(\"tick\", function () {\n    link.attr(\"x1\", function (d) {\n        return d.source.x;\n    })\n        .attr(\"y1\", function (d) {\n        return d.source.y;\n    })\n        .attr(\"x2\", function (d) {\n        return d.target.x;\n    })\n        .attr(\"y2\", function (d) {\n        return d.target.y;\n    });\n    d3.selectAll(\"circle\").attr(\"cx\", function (d) {\n        return d.x;\n    })\n        .attr(\"cy\", function (d) {\n        return d.y;\n    });\n    d3.selectAll(\"text\").attr(\"x\", function (d) {\n        return d.x;\n    })\n        .attr(\"y\", function (d) {\n        return d.y;\n    });\n});\n<\/script>\n</div>\n\"\"\")\n}\n  \n  def help() = {\ndisplayHTML(\"\"\"\n<p>\nProduces a force-directed graph given a collection of edges of the following form:</br>\n<tt><font color=\"#a71d5d\">case class</font> <font color=\"#795da3\">Edge</font>(<font color=\"#ed6a43\">src</font>: <font color=\"#a71d5d\">String</font>, <font color=\"#ed6a43\">dest</font>: <font color=\"#a71d5d\">String</font>, <font color=\"#ed6a43\">count</font>: <font color=\"#a71d5d\">Long</font>)</tt>\n</p>\n<p>Usage:<br/>\n<tt><font color=\"#a71d5d\">import</font> <font color=\"#ed6a43\">d3._</font></tt><br/>\n<tt><font color=\"#795da3\">graphs.force</font>(</br>\n&nbsp;&nbsp;<font color=\"#ed6a43\">height</font> = <font color=\"#795da3\">500</font>,<br/>\n&nbsp;&nbsp;<font color=\"#ed6a43\">width</font> = <font color=\"#795da3\">500</font>,<br/>\n&nbsp;&nbsp;<font color=\"#ed6a43\">clicks</font>: <font color=\"#795da3\">Dataset</font>[<font color=\"#795da3\">Edge</font>])</tt>\n</p>\"\"\")\n  }\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Warning: classes defined within packages cannot be redefined without a cluster restart.\nCompilation successful.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506579538418,"submitTime":1506579538396,"finishTime":1506579539527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6978a74b-57bb-4f72-8ab9-0705e224db96"},{"version":"CommandV1","origId":198675,"guid":"4f67bcca-fa3c-4565-93d1-b99fc6c6910c","subtype":"command","commandType":"auto","position":4.4375,"command":"d3.graphs.help()","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"\n<p>\nProduces a force-directed graph given a collection of edges of the following form:</br>\n<tt><font color=\"#a71d5d\">case class</font> <font color=\"#795da3\">Edge</font>(<font color=\"#ed6a43\">src</font>: <font color=\"#a71d5d\">String</font>, <font color=\"#ed6a43\">dest</font>: <font color=\"#a71d5d\">String</font>, <font color=\"#ed6a43\">count</font>: <font color=\"#a71d5d\">Long</font>)</tt>\n</p>\n<p>Usage:<br/>\n<tt><font color=\"#a71d5d\">import</font> <font color=\"#ed6a43\">d3._</font></tt><br/>\n<tt><font color=\"#795da3\">graphs.force</font>(</br>\n&nbsp;&nbsp;<font color=\"#ed6a43\">height</font> = <font color=\"#795da3\">500</font>,<br/>\n&nbsp;&nbsp;<font color=\"#ed6a43\">width</font> = <font color=\"#795da3\">500</font>,<br/>\n&nbsp;&nbsp;<font color=\"#ed6a43\">clicks</font>: <font color=\"#795da3\">Dataset</font>[<font color=\"#795da3\">Edge</font>])</tt>\n</p>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:43: error: not found: value d3\n       d3.graphs.help()\n       ^\n</div>","error":null,"workflows":[],"startTime":1506579554516,"submitTime":1506579554495,"finishTime":1506579554733,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7aa53f34-86e4-4ff0-8b4b-cb2c48d24787"},{"version":"CommandV1","origId":198676,"guid":"3e6ff98e-377a-4a26-bc41-573a79df5e4c","subtype":"command","commandType":"auto","position":4.546875,"command":"import org.apache.spark.sql.functions.lit // import the lit function in sql\nval gE= g.edges.select($\"src\", $\"dst\".as(\"dest\"), lit(1L).as(\"count\")) // for us the column count is just an edge incidence","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.lit\ngE: org.apache.spark.sql.DataFrame = [src: string, dest: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">Unclosed block</div>","error":null,"workflows":[],"startTime":1506579560984,"submitTime":1506579560966,"finishTime":1506579561311,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6daf882f-7467-4f48-8574-2c3ad7b5fc9f"},{"version":"CommandV1","origId":198677,"guid":"7613ee59-f4cf-482a-9331-1e8a11ee1fd7","subtype":"command","commandType":"auto","position":4.6015625,"command":"display(gE)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","b",1],["b","c",1],["c","b",1],["f","c",1],["e","f",1],["e","d",1],["d","a",1],["a","e",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"string\"","metadata":"{}"},{"name":"dest","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506579564268,"submitTime":1506579564251,"finishTime":1506579564561,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d41cd426-e28a-4ace-932f-58a92deff89d"},{"version":"CommandV1","origId":198678,"guid":"d5d1b696-0038-4457-ad90-a3d540e1e20d","subtype":"command","commandType":"auto","position":4.65625,"command":"d3.graphs.force(\n  height = 500,\n  width = 500,\n  clicks = gE.as[d3.Edge])","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"\n<style>\n\n.node_circle {\n  stroke: #777;\n  stroke-width: 1.3px;\n}\n\n.node_label {\n  pointer-events: none;\n}\n\n.link {\n  stroke: #777;\n  stroke-opacity: .2;\n}\n\n.node_count {\n  stroke: #777;\n  stroke-width: 1.0px;\n  fill: #999;\n}\n\ntext.legend {\n  font-family: Verdana;\n  font-size: 13px;\n  fill: #000;\n}\n\n.node text {\n  font-family: \"Helvetica Neue\",\"Helvetica\",\"Arial\",sans-serif;\n  font-size: 17px;\n  font-weight: 200;\n}\n\n</style>\n\n<div id=\"clicks-graph\">\n<script src=\"//d3js.org/d3.v3.min.js\"><\/script>\n<script>\n\nvar graph = {\"nodes\":[{\"name\":\"e\"},{\"name\":\"f\"},{\"name\":\"a\"},{\"name\":\"b\"},{\"name\":\"c\"},{\"name\":\"d\"}],\"links\":[{\"source\":2,\"target\":3,\"value\":1},{\"source\":3,\"target\":4,\"value\":1},{\"source\":4,\"target\":3,\"value\":1},{\"source\":1,\"target\":4,\"value\":1},{\"source\":0,\"target\":1,\"value\":1},{\"source\":0,\"target\":5,\"value\":1},{\"source\":5,\"target\":2,\"value\":1},{\"source\":2,\"target\":0,\"value\":1}]};\n\nvar width = 500,\n    height = 500;\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n    .charge(-700)\n    .linkDistance(180)\n    .size([width, height]);\n\nvar svg = d3.select(\"#clicks-graph\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    \nforce\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n\nvar link = svg.selectAll(\".link\")\n    .data(graph.links)\n    .enter().append(\"line\")\n    .attr(\"class\", \"link\")\n    .style(\"stroke-width\", function(d) { return Math.sqrt(d.value); });\n\nvar node = svg.selectAll(\".node\")\n    .data(graph.nodes)\n    .enter().append(\"g\")\n    .attr(\"class\", \"node\")\n    .call(force.drag);\n\nnode.append(\"circle\")\n    .attr(\"r\", 10)\n    .style(\"fill\", function (d) {\n    if (d.name.startsWith(\"other\")) { return color(1); } else { return color(2); };\n})\n\nnode.append(\"text\")\n      .attr(\"dx\", 10)\n      .attr(\"dy\", \".35em\")\n      .text(function(d) { return d.name });\n      \n//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements\nforce.on(\"tick\", function () {\n    link.attr(\"x1\", function (d) {\n        return d.source.x;\n    })\n        .attr(\"y1\", function (d) {\n        return d.source.y;\n    })\n        .attr(\"x2\", function (d) {\n        return d.target.x;\n    })\n        .attr(\"y2\", function (d) {\n        return d.target.y;\n    });\n    d3.selectAll(\"circle\").attr(\"cx\", function (d) {\n        return d.x;\n    })\n        .attr(\"cy\", function (d) {\n        return d.y;\n    });\n    d3.selectAll(\"text\").attr(\"x\", function (d) {\n        return d.x;\n    })\n        .attr(\"y\", function (d) {\n        return d.y;\n    });\n});\n<\/script>\n</div>\n","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:50: error: type mismatch;\n found   : org.apache.spark.sql.Dataset[d3ivan.Edge]\n required: org.apache.spark.sql.Dataset[d3.Edge]\n         clicks = gE.as[d3ivan.Edge])\n                       ^\n</div>","error":null,"workflows":[],"startTime":1506579579329,"submitTime":1506579579313,"finishTime":1506579579804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a30bd6f-9cea-48a6-a10a-78e9c025fea3"},{"version":"CommandV1","origId":198679,"guid":"2db17ab5-0fb4-4392-a825-38ca65778fb4","subtype":"command","commandType":"auto","position":4.875,"command":"// This example graph also comes with the GraphFrames package.\nval g0 = examples.Graphs.friends","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">g0: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579597423,"submitTime":1506579597404,"finishTime":1506579597661,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"559a635a-89f5-4e1d-b547-0a0bfeb39636"},{"version":"CommandV1","origId":198680,"guid":"9723521a-2249-4d53-9fbf-b7849de08fe6","subtype":"command","commandType":"auto","position":4.9375,"command":"d3.graphs.force( // let us see g0 now in one cell\n  height = 500,\n  width = 500,\n  clicks = g0.edges.select($\"src\", $\"dst\".as(\"dest\"), lit(1L).as(\"count\")).as[d3.Edge])","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"\n<style>\n\n.node_circle {\n  stroke: #777;\n  stroke-width: 1.3px;\n}\n\n.node_label {\n  pointer-events: none;\n}\n\n.link {\n  stroke: #777;\n  stroke-opacity: .2;\n}\n\n.node_count {\n  stroke: #777;\n  stroke-width: 1.0px;\n  fill: #999;\n}\n\ntext.legend {\n  font-family: Verdana;\n  font-size: 13px;\n  fill: #000;\n}\n\n.node text {\n  font-family: \"Helvetica Neue\",\"Helvetica\",\"Arial\",sans-serif;\n  font-size: 17px;\n  font-weight: 200;\n}\n\n</style>\n\n<div id=\"clicks-graph\">\n<script src=\"//d3js.org/d3.v3.min.js\"><\/script>\n<script>\n\nvar graph = {\"nodes\":[{\"name\":\"e\"},{\"name\":\"f\"},{\"name\":\"a\"},{\"name\":\"b\"},{\"name\":\"c\"},{\"name\":\"d\"}],\"links\":[{\"source\":2,\"target\":3,\"value\":1},{\"source\":3,\"target\":4,\"value\":1},{\"source\":4,\"target\":3,\"value\":1},{\"source\":1,\"target\":4,\"value\":1},{\"source\":0,\"target\":1,\"value\":1},{\"source\":0,\"target\":5,\"value\":1},{\"source\":5,\"target\":2,\"value\":1},{\"source\":2,\"target\":0,\"value\":1}]};\n\nvar width = 500,\n    height = 500;\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n    .charge(-700)\n    .linkDistance(180)\n    .size([width, height]);\n\nvar svg = d3.select(\"#clicks-graph\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    \nforce\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n\nvar link = svg.selectAll(\".link\")\n    .data(graph.links)\n    .enter().append(\"line\")\n    .attr(\"class\", \"link\")\n    .style(\"stroke-width\", function(d) { return Math.sqrt(d.value); });\n\nvar node = svg.selectAll(\".node\")\n    .data(graph.nodes)\n    .enter().append(\"g\")\n    .attr(\"class\", \"node\")\n    .call(force.drag);\n\nnode.append(\"circle\")\n    .attr(\"r\", 10)\n    .style(\"fill\", function (d) {\n    if (d.name.startsWith(\"other\")) { return color(1); } else { return color(2); };\n})\n\nnode.append(\"text\")\n      .attr(\"dx\", 10)\n      .attr(\"dy\", \".35em\")\n      .text(function(d) { return d.name });\n      \n//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements\nforce.on(\"tick\", function () {\n    link.attr(\"x1\", function (d) {\n        return d.source.x;\n    })\n        .attr(\"y1\", function (d) {\n        return d.source.y;\n    })\n        .attr(\"x2\", function (d) {\n        return d.target.x;\n    })\n        .attr(\"y2\", function (d) {\n        return d.target.y;\n    });\n    d3.selectAll(\"circle\").attr(\"cx\", function (d) {\n        return d.x;\n    })\n        .attr(\"cy\", function (d) {\n        return d.y;\n    });\n    d3.selectAll(\"text\").attr(\"x\", function (d) {\n        return d.x;\n    })\n        .attr(\"y\", function (d) {\n        return d.y;\n    });\n});\n<\/script>\n</div>\n","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:52: error: not found: value g0\n                clicks = g0.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)).as[d3.Edge])\n                         ^\n</div>","error":null,"workflows":[],"startTime":1506579611122,"submitTime":1506579611104,"finishTime":1506579611672,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"65e2eee9-ab26-45cb-af43-dfaa1e53fb3a"},{"version":"CommandV1","origId":198681,"guid":"1361f528-7c55-4a32-860d-97377b17d6a1","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Basic graph and DataFrame queries\n\nGraphFrames provide several simple graph queries, such as node degree.\n\nAlso, since GraphFrames represent graphs as pairs of vertex and edge DataFrames, it is easy to make powerful queries directly on the vertex and edge DataFrames. Those DataFrames are made available as vertices and edges fields in the GraphFrame.\n\n### Simple queries are simple\n\nGraphFrames make it easy to express queries over graphs. Since GraphFrame vertices and edges are stored as DataFrames, many queries are just DataFrame (or SQL) queries.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375237932,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b26c8a43-98f2-4077-ad02-8caf280a7edf"},{"version":"CommandV1","origId":198682,"guid":"5bf23b9f-87eb-4f24-a9ff-0ef5af0cef44","subtype":"command","commandType":"auto","position":6.25,"command":"display(g.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","Alice",34],["b","Bob",36],["c","Charlie",30],["d","David",29],["e","Esther",32],["f","Fanny",36],["g","Gabby",60]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579660829,"submitTime":1506579660811,"finishTime":1506579661112,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"819.77778","height":"205.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6b7b63b-d835-48b0-92e8-2a8cc9373603"},{"version":"CommandV1","origId":198683,"guid":"492a626c-c55d-4b6b-a2b9-98460cf2f7ff","subtype":"command","commandType":"auto","position":6.5,"command":"display(g0.vertices) // this is the same query on the graph loaded as an example from GraphFrame package","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","Alice",34],["b","Bob",36],["c","Charlie",30],["d","David",29],["e","Esther",32],["f","Fanny",36],["g","Gabby",60]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506579681511,"submitTime":1506579681493,"finishTime":1506579681697,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"825.5","height":"183.5","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da36ca1b-efd6-4ba1-abbd-458df49dac56"},{"version":"CommandV1","origId":198684,"guid":"15f69662-2d44-4e4d-b1aa-0a35d1551721","subtype":"command","commandType":"auto","position":6.75,"command":"display(g.edges)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","b","friend"],["b","c","follow"],["c","b","follow"],["f","c","follow"],["e","f","follow"],["e","d","friend"],["d","a","friend"],["a","e","friend"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"string\"","metadata":"{}"},{"name":"dst","type":"\"string\"","metadata":"{}"},{"name":"relationship","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579695584,"submitTime":1506579695567,"finishTime":1506579695801,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"814.77778","height":"204.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e4a5945-8ad4-42d8-b167-7fcc2c346bdf"},{"version":"CommandV1","origId":198685,"guid":"66e1e1aa-de31-4511-958e-619ddcb3972e","subtype":"command","commandType":"auto","position":7.5,"command":"%md \nThe incoming degree of the vertices:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa29ad84-784e-4b0a-800b-28620b4da439"},{"version":"CommandV1","origId":198686,"guid":"522b8d94-68f1-413e-bbbd-0f94677b5cbc","subtype":"command","commandType":"auto","position":8.25,"command":"display(g.inDegrees)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["f",1],["e",1],["d",1],["c",2],["b",2],["a",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"inDegree","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579704724,"submitTime":1506579704707,"finishTime":1506579706290,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"829.77778","height":"167.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"872fc09d-89da-4ec0-aa33-02bd7f08e4a1"},{"version":"CommandV1","origId":198687,"guid":"d061ddf4-97be-4d83-80d5-c8e9e0e47d0b","subtype":"command","commandType":"auto","position":8.5,"command":"%md \nThe outgoing degree of the vertices:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07cd7613-d39d-4fcf-a6cb-6db61efec590"},{"version":"CommandV1","origId":198688,"guid":"5c4ccb2f-6010-403f-89f9-e4ea2d009517","subtype":"command","commandType":"auto","position":8.75,"command":"display(g.outDegrees)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["f",1],["e",2],["d",1],["c",1],["b",1],["a",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"outDegree","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579711592,"submitTime":1506579711574,"finishTime":1506579712514,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5180419-e89b-4202-9319-9f75f15cb3c3"},{"version":"CommandV1","origId":198689,"guid":"4a8729ab-5420-4ed0-afac-8378f4ad8f4e","subtype":"command","commandType":"auto","position":8.875,"command":"%md \nThe degree of the vertices:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c4ab866-d495-48bb-97c7-df8dcddd60c6"},{"version":"CommandV1","origId":198690,"guid":"e1b0a7ea-12a3-4714-9283-69550929172b","subtype":"command","commandType":"auto","position":9.0,"command":"display(g.degrees)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["f",2],["e",3],["d",2],["c",3],["b",3],["a",3]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"degree","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579717558,"submitTime":1506579717539,"finishTime":1506579718396,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d6433f17-8361-4061-a505-4c778b70cf89"},{"version":"CommandV1","origId":198691,"guid":"a5554878-4f70-40d9-aa1d-27ce6d6cf03b","subtype":"command","commandType":"auto","position":9.125,"command":"%md \nYou can run queries directly on the vertices DataFrame. For example, we can find the age of the youngest person in the graph:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"97c8f12b-3b15-453e-9e8a-f2256a9595be"},{"version":"CommandV1","origId":198692,"guid":"c00bf312-edd7-4075-a819-89497908fb08","subtype":"command","commandType":"auto","position":9.25,"command":"val youngest = g.vertices.groupBy().min(\"age\")\ndisplay(youngest)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[29]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"min(age)","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579741855,"submitTime":1506579741838,"finishTime":1506579742221,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"408.5","height":"109.5","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dc113c4-254d-4db7-a9f9-1b6039b0b6f8"},{"version":"CommandV1","origId":198693,"guid":"43b7ac6c-dd0d-4a9f-bb32-231cdb3f2ab0","subtype":"command","commandType":"auto","position":9.75,"command":"%md \nLikewise, you can run queries on the edges DataFrame. \n\nFor example, let us count the number of 'follow' relationships in the graph:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bcacdbb7-2a09-401d-8f61-19d87ff5b240"},{"version":"CommandV1","origId":198694,"guid":"88fdea62-0839-41e3-a715-58bbbf76b2fc","subtype":"command","commandType":"auto","position":10.25,"command":"val numFollows = g.edges.filter(\"relationship = 'follow'\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">numFollows: Long = 4\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579752201,"submitTime":1506579752183,"finishTime":1506579752585,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01843d50-ee08-43c2-9070-2ddbddb15f34"},{"version":"CommandV1","origId":198695,"guid":"e3cdd40b-1a55-4598-9bed-94915abc0fa4","subtype":"command","commandType":"auto","position":11.25,"command":"%md \n##Motif finding\n\nMore complex relationships involving edges and vertices can be built using motifs. \n\nThe following cell finds the pairs of vertices with edges in both directions between them. \n\nThe result is a dataframe, in which the column names are given by the motif keys.\n\nCheck out the [GraphFrame User Guide](http://graphframes.github.io/user-guide.html#motif-finding) for more details on the API.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375239295,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b6fd88d8-98c4-4c6f-92db-c4e7cde27ab4"},{"version":"CommandV1","origId":198696,"guid":"f215c64e-77d9-4004-b886-fc91572430bf","subtype":"command","commandType":"auto","position":12.25,"command":"// Search for pairs of vertices with edges in both directions between them, i.e., find undirected or bidirected edges.\nval motifs = g.find(\"(a)-[e1]->(b); (b)-[e2]->(a)\")\ndisplay(motifs)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["b","Bob",36],["b","c","follow"],["c","Charlie",30],["c","b","follow"]],[["c","Charlie",30],["c","b","follow"],["b","Bob",36],["b","c","follow"]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"a","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e1","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"b","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e2","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506579808740,"submitTime":1506579808722,"finishTime":1506579809635,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1037","height":"170","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a573fbd9-458b-43f5-89ea-27f5f6253ef3"},{"version":"CommandV1","origId":198697,"guid":"66fb7367-0942-423c-91a3-7ab6760a7d9d","subtype":"command","commandType":"auto","position":12.75,"command":"%md \nSince the result is a DataFrame, more complex queries can be built on top of the motif. \n\nLet us find all the reciprocal relationships in which one person is older than 30:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"875aa251-c0a3-42d3-a8bc-373f2c5b6fd4"},{"version":"CommandV1","origId":198698,"guid":"7b4c629b-ff1b-4a21-9d5b-eb96fef8731b","subtype":"command","commandType":"auto","position":13.25,"command":"val filtered = motifs.filter(\"b.age > 30\")\ndisplay(filtered)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["c","Charlie",30],["c","b","follow"],["b","Bob",36],["b","c","follow"]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"a","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e1","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"b","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e2","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:41: error: not found: value motifs\n              val filtered = motifs.filter(&quot;b.age &gt; 30&quot;)\n                             ^\n</div>","error":null,"workflows":[],"startTime":1506579827469,"submitTime":1506579827452,"finishTime":1506579828008,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1235.77778","height":"137.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7b92e85-8980-42e5-9d75-0845bfddf2aa"},{"version":"CommandV1","origId":198699,"guid":"01ba0810-d2bc-48e4-bcce-3986609ee907","subtype":"command","commandType":"auto","position":13.5,"command":"%md\n**You Try!**\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b2c2b1b8-9b97-4c02-be7a-86bcdc794ff6"},{"version":"CommandV1","origId":198700,"guid":"86b921e6-9d9f-4e79-bca8-ff7df755185c","subtype":"command","commandType":"auto","position":13.625,"command":"//Search for all \"directed triangles\" or triplets of vertices: a,b,c with edges: a->b, b->c and c->a\n//uncomment the next 2 lines and replace the \"...\" below\nval motifs3 = g.find(\"(a)-[e1]->(b); (b)-[e2]->(c); (c)-[e3]->(a) \")\ndisplay(motifs3)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["e","Esther",32],["e","d","friend"],["d","David",29],["d","a","friend"],["a","Alice",34],["a","e","friend"]],[["d","David",29],["d","a","friend"],["a","Alice",34],["a","e","friend"],["e","Esther",32],["e","d","friend"]],[["a","Alice",34],["a","e","friend"],["e","Esther",32],["e","d","friend"],["d","David",29],["d","a","friend"]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"a","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e1","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"b","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e2","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e3","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"org.graphframes.InvalidParseException: Failed to parse bad motif string: '(a)-[e1]->(b); (b)-[e2]->(c); (c)-[e3]->(a);'.  Returned message: `!' expected but end of source found","error":"<div class=\"ansiout\">\tat org.graphframes.pattern.Pattern$.parse(patterns.scala:55)\n\tat org.graphframes.GraphFrame.find(GraphFrame.scala:263)</div>","workflows":[],"startTime":1506579929505,"submitTime":1506579929492,"finishTime":1506579930209,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f96b06f3-e7cc-4497-9d91-47ce9cc4144c"},{"version":"CommandV1","origId":198701,"guid":"4ccfc54d-a681-4e80-8251-65d8d059a25f","subtype":"command","commandType":"auto","position":13.75,"command":"%md\n**Stateful queries**\n\nMany motif queries are stateless and simple to express, as in the examples above. The next examples demonstrate more complex queries which carry state along a path in the motif. These queries can be expressed by combining GraphFrame motif finding with filters on the result, where the filters use sequence operations to construct a series of DataFrame Columns.\n\nFor example, suppose one wishes to identify a chain of 4 vertices with some property defined by a sequence of functions. That is, among chains of 4 vertices `a->b->c->d`, identify the subset of chains matching this complex filter:\n\n* Initialize state on path.\n* Update state based on vertex a.\n* Update state based on vertex b.\n* Etc. for c and d.\n* If final state matches some condition, then the chain is accepted by the filter.\n\nThe below code snippets demonstrate this process, where we identify chains of 4 vertices such that at least 2 of the 3 edges are `friend` relationships. In this example, the state is the current count of `friend` edges; in general, it could be any DataFrame Column.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375239810,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2455831e-b504-4186-9fd7-11e08f68cc93"},{"version":"CommandV1","origId":198702,"guid":"a2efa314-43a9-4cdc-b47c-77389ce5bf06","subtype":"command","commandType":"auto","position":14.25,"command":"// Find chains of 4 vertices.\nval chain4 = g.find(\"(a)-[ab]->(b); (b)-[bc]->(c); (c)-[cd]->(d)\")\n\n// Query on sequence, with state (cnt)\n//  (a) Define method for updating state given the next element of the motif.\ndef sumFriends(cnt: Column, relationship: Column): Column = {\n  when(relationship === \"friend\", cnt + 1).otherwise(cnt)\n}\n//  (b) Use sequence operation to apply method to sequence of elements in motif.\n//      In this case, the elements are the 3 edges.\nval condition = Seq(\"ab\", \"bc\", \"cd\").\n  foldLeft(lit(0))((cnt, e) => sumFriends(cnt, col(e)(\"relationship\")))\n//  (c) Apply filter to DataFrame.\nval chainWith2Friends2 = chain4.where(condition >= 2)\ndisplay(chainWith2Friends2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["e","Esther",32],["e","d","friend"],["d","David",29],["d","a","friend"],["a","Alice",34],["a","e","friend"],["e","Esther",32]],[["e","Esther",32],["e","d","friend"],["d","David",29],["d","a","friend"],["a","Alice",34],["a","b","friend"],["b","Bob",36]],[["d","David",29],["d","a","friend"],["a","Alice",34],["a","e","friend"],["e","Esther",32],["e","d","friend"],["d","David",29]],[["d","David",29],["d","a","friend"],["a","Alice",34],["a","e","friend"],["e","Esther",32],["e","f","follow"],["f","Fanny",36]],[["d","David",29],["d","a","friend"],["a","Alice",34],["a","b","friend"],["b","Bob",36],["b","c","follow"],["c","Charlie",30]],[["a","Alice",34],["a","e","friend"],["e","Esther",32],["e","d","friend"],["d","David",29],["d","a","friend"],["a","Alice",34]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"a","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"ab","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"b","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"bc","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"c","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"cd","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"d","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580556659,"submitTime":1506580556651,"finishTime":1506580557696,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6dd9e87-79eb-47c3-a905-4cccba248980"},{"version":"CommandV1","origId":198703,"guid":"efe64145-ef3a-4c0f-8e66-8db84f2884c7","subtype":"command","commandType":"auto","position":14.75,"command":"%md\n### Bold idea!\nCan you think of a way to use stateful queries in social media networks to find perpetrators of hate-speech online who are possibly worthy of an investigation by domain experts, say in the intelligence or security domain, for potential prosecution on charges of having incited another person to cause physical violence... This is a real problem today!\n\nAn idea for a product?","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e51d8319-0d20-4f85-aafa-fcbc94ee6cda"},{"version":"CommandV1","origId":198704,"guid":"cf61fcc5-c5cb-4f4c-b225-e0c14acbeb6a","subtype":"command","commandType":"auto","position":15.25,"command":"%md\n###Subgraphs\n\nSubgraphs are built by filtering a subset of edges and vertices. For example, the following subgraph only contains people who are friends and who are more than 30 years old.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375240128,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"104e3c55-b9ce-4861-ba1e-3ec62b9b739f"},{"version":"CommandV1","origId":198705,"guid":"c2ccd2b2-57f5-4666-8d8e-cd6e3fd135af","subtype":"command","commandType":"auto","position":16.25,"command":"// Select subgraph of users older than 30, and edges of type \"friend\"\nval v2 = g.vertices.filter(\"age > 30\")\nval e2 = g.edges.filter(\"relationship = 'friend'\")\nval g2 = GraphFrame(v2, e2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">v2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, name: string ... 1 more field]\ne2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [src: string, dst: string ... 1 more field]\ng2: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580810561,"submitTime":1506580810543,"finishTime":1506580810740,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c587e1df-4d8a-4dce-a38d-109e180e696d"},{"version":"CommandV1","origId":198706,"guid":"95c4d494-c76f-4e18-829c-923ca04533f4","subtype":"command","commandType":"auto","position":17.25,"command":"display(g2.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","Alice",34],["b","Bob",36],["e","Esther",32],["f","Fanny",36],["g","Gabby",60]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580818428,"submitTime":1506580818411,"finishTime":1506580818653,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"597.77778","height":"203.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9415c252-f425-4d1b-a035-a225cc2b93e3"},{"version":"CommandV1","origId":198707,"guid":"657aa747-52f0-45b1-b6b1-bf227abe5d9a","subtype":"command","commandType":"auto","position":18.25,"command":"display(g2.edges)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","b","friend"],["e","d","friend"],["d","a","friend"],["a","e","friend"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"string\"","metadata":"{}"},{"name":"dst","type":"\"string\"","metadata":"{}"},{"name":"relationship","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580824230,"submitTime":1506580824212,"finishTime":1506580824475,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"580.77778","height":"201.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c33abcb0-e48b-4d02-abc0-90f491c56760"},{"version":"CommandV1","origId":198708,"guid":"393db99f-638e-445e-bd01-0ccf1a584e62","subtype":"command","commandType":"auto","position":18.75,"command":"d3.graphs.force( // let us see g2 now in one cell\n  height = 500,\n  width = 500,\n  clicks = g2.edges.select($\"src\", $\"dst\".as(\"dest\"), lit(1L).as(\"count\")).as[d3.Edge])","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"\n<style>\n\n.node_circle {\n  stroke: #777;\n  stroke-width: 1.3px;\n}\n\n.node_label {\n  pointer-events: none;\n}\n\n.link {\n  stroke: #777;\n  stroke-opacity: .2;\n}\n\n.node_count {\n  stroke: #777;\n  stroke-width: 1.0px;\n  fill: #999;\n}\n\ntext.legend {\n  font-family: Verdana;\n  font-size: 13px;\n  fill: #000;\n}\n\n.node text {\n  font-family: \"Helvetica Neue\",\"Helvetica\",\"Arial\",sans-serif;\n  font-size: 17px;\n  font-weight: 200;\n}\n\n</style>\n\n<div id=\"clicks-graph\">\n<script src=\"//d3js.org/d3.v3.min.js\"><\/script>\n<script>\n\nvar graph = {\"nodes\":[{\"name\":\"a\"},{\"name\":\"e\"},{\"name\":\"d\"},{\"name\":\"b\"}],\"links\":[{\"source\":0,\"target\":3,\"value\":1},{\"source\":1,\"target\":2,\"value\":1},{\"source\":2,\"target\":0,\"value\":1},{\"source\":0,\"target\":1,\"value\":1}]};\n\nvar width = 500,\n    height = 500;\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n    .charge(-700)\n    .linkDistance(180)\n    .size([width, height]);\n\nvar svg = d3.select(\"#clicks-graph\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    \nforce\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n\nvar link = svg.selectAll(\".link\")\n    .data(graph.links)\n    .enter().append(\"line\")\n    .attr(\"class\", \"link\")\n    .style(\"stroke-width\", function(d) { return Math.sqrt(d.value); });\n\nvar node = svg.selectAll(\".node\")\n    .data(graph.nodes)\n    .enter().append(\"g\")\n    .attr(\"class\", \"node\")\n    .call(force.drag);\n\nnode.append(\"circle\")\n    .attr(\"r\", 10)\n    .style(\"fill\", function (d) {\n    if (d.name.startsWith(\"other\")) { return color(1); } else { return color(2); };\n})\n\nnode.append(\"text\")\n      .attr(\"dx\", 10)\n      .attr(\"dy\", \".35em\")\n      .text(function(d) { return d.name });\n      \n//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements\nforce.on(\"tick\", function () {\n    link.attr(\"x1\", function (d) {\n        return d.source.x;\n    })\n        .attr(\"y1\", function (d) {\n        return d.source.y;\n    })\n        .attr(\"x2\", function (d) {\n        return d.target.x;\n    })\n        .attr(\"y2\", function (d) {\n        return d.target.y;\n    });\n    d3.selectAll(\"circle\").attr(\"cx\", function (d) {\n        return d.x;\n    })\n        .attr(\"cy\", function (d) {\n        return d.y;\n    });\n    d3.selectAll(\"text\").attr(\"x\", function (d) {\n        return d.x;\n    })\n        .attr(\"y\", function (d) {\n        return d.y;\n    });\n});\n<\/script>\n</div>\n","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506580830073,"submitTime":1506580830055,"finishTime":1506580830611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0096b355-3bfe-4600-bd33-8430bdbb46c4"},{"version":"CommandV1","origId":198709,"guid":"5daca413-3dec-457e-9baa-2e5dbd221ffe","subtype":"command","commandType":"auto","position":19.25,"command":"%md \n**Complex triplet filters**\n\nThe following example shows how to select a subgraph based upon triplet filters which operate on:\n\n* an edge and \n* its src and \n* dst vertices. \n\nThis example could be extended to go beyond triplets by using more complex motifs.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375241027,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d21f75b8-603e-4b82-9c29-16c66322a21c"},{"version":"CommandV1","origId":198710,"guid":"d9c1f175-d0e9-453f-a6fb-3ac4662d08db","subtype":"command","commandType":"auto","position":20.25,"command":"// Select subgraph based on edges \"e\" of type \"follow\"\n// pointing from a younger user \"a\" to an older user \"b\".\nval paths = g.find(\"(a)-[e]->(b)\")\n  .filter(\"e.relationship = 'follow'\")\n  .filter(\"a.age < b.age\")\n// \"paths\" contains vertex info. Extract the edges.\nval e2 = paths.select(\"e.src\", \"e.dst\", \"e.relationship\")\n// In Spark 1.5+, the user may simplify this call:\n//  val e2 = paths.select(\"e.*\")\n\n// Construct the subgraph\nval g2 = GraphFrame(g.vertices, e2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">paths: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [a: struct&lt;id: string, name: string ... 1 more field&gt;, e: struct&lt;src: string, dst: string ... 1 more field&gt; ... 1 more field]\ne2: org.apache.spark.sql.DataFrame = [src: string, dst: string ... 1 more field]\ng2: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580888686,"submitTime":1506580888669,"finishTime":1506580888955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc71a4a0-4da0-48ca-84a8-ad9073418205"},{"version":"CommandV1","origId":198711,"guid":"678b9066-049a-4ed8-9342-14dccd93d326","subtype":"command","commandType":"auto","position":21.25,"command":"display(g2.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","Alice",34],["b","Bob",36],["c","Charlie",30],["d","David",29],["e","Esther",32],["f","Fanny",36],["g","Gabby",60]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580894231,"submitTime":1506580894214,"finishTime":1506580894452,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"871.77778","height":"240.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e2bf94db-49da-49a2-94d5-8d0c68e464c3"},{"version":"CommandV1","origId":198712,"guid":"d637b5d8-7422-4677-9674-29d45a1d113e","subtype":"command","commandType":"auto","position":22.25,"command":"display(g2.edges)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["c","b","follow"],["e","f","follow"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"string\"","metadata":"{}"},{"name":"dst","type":"\"string\"","metadata":"{}"},{"name":"relationship","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506580924745,"submitTime":1506580924727,"finishTime":1506580925302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"894.77778","height":"121.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2c89f166-1f10-4067-9069-e76fde7329b3"},{"version":"CommandV1","origId":198713,"guid":"ed4e0272-6a04-4434-b1e9-2dad4322c6ac","subtype":"command","commandType":"auto","position":23.25,"command":"%md \n## Standard graph algorithms\n\nGraphFrames comes with a number of standard graph algorithms built in:\n\n* Breadth-first search (BFS)\n* Connected components\n* Strongly connected components\n* Label Propagation Algorithm (LPA)\n* PageRank\n* Shortest paths\n* Triangle count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375241686,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"720204d3-4fa2-4af0-9bfa-fbd7cceb4ffa"},{"version":"CommandV1","origId":198714,"guid":"d90f47cc-d6dc-458c-80cd-b926ed682867","subtype":"command","commandType":"auto","position":24.25,"command":"%md \n### Breadth-first search (BFS)\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375241873,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cbdcd4a8-dfd3-4566-83ca-65e556ee772d"},{"version":"CommandV1","origId":198715,"guid":"f00a6ffa-25b4-4bd1-8778-5966973bd019","subtype":"command","commandType":"auto","position":24.875,"command":"%md\n\nRead \n\n* [http://graphframes.github.io/user-guide.html#breadth-first-search-bfs](http://graphframes.github.io/user-guide.html#breadth-first-search-bfs).","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:3: error: ']' expected but ':' found.\nSee [http://graphframes.github.io/user-guide.html#breadth-first-search-bfs](http://graphframes.github.io/user-guide.html#breadth-first-search-bfs).\n         ^\n</div>","error":null,"workflows":[],"startTime":1506580992978,"submitTime":1506580992978,"finishTime":1506580993021,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6a622ffa-f71b-46f1-b2a2-0e3052ba7714"},{"version":"CommandV1","origId":198716,"guid":"8d5778d0-ef80-42be-a470-37720a58fa13","subtype":"command","commandType":"auto","position":24.9375,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Breadth-first_search\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/Breadth-first_search\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506582474161,"submitTime":1506582474143,"finishTime":1506582474292,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ac8834e-ef55-4d4c-baf5-dd65d34714af"},{"version":"CommandV1","origId":198717,"guid":"41d02d13-eb5a-49dd-accb-48806912a179","subtype":"command","commandType":"auto","position":25.0,"command":"%md\nSearch from \"Esther\" for users of age < 32.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c30609a-3a86-4f7f-864b-1f1c7b00d5a7"},{"version":"CommandV1","origId":198718,"guid":"9d761483-97df-462f-a7ad-dcce8b4dbf34","subtype":"command","commandType":"auto","position":25.25,"command":"// Search from \"Esther\" for users of age <= 32.\nval paths: DataFrame = g.bfs.fromExpr(\"name = 'Esther'\").toExpr(\"age < 32\").run()\ndisplay(paths)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["e","Esther",32],["e","d","friend"],["d","David",29]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"from","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e0","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"to","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506581517635,"submitTime":1506581517617,"finishTime":1506581518408,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"25ff5d8f-6730-43e7-adf2-dc6339185034"},{"version":"CommandV1","origId":198719,"guid":"9e482406-ad87-42c2-a350-dd018f0681b4","subtype":"command","commandType":"auto","position":25.5,"command":"val paths: DataFrame = g.bfs.fromExpr(\"name = 'Esther' OR name = 'Bob'\").toExpr(\"age < 32\").run()\ndisplay(paths)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["b","Bob",36],["b","c","follow"],["c","Charlie",30]],[["e","Esther",32],["e","d","friend"],["d","David",29]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"from","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e0","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"to","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"java.lang.IllegalArgumentException: requirement failed: toExpr is required.","error":"<div class=\"ansiout\">\tat scala.Predef$.require(Predef.scala:224)\n\tat org.graphframes.lib.BFS.run(BFS.scala:124)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:47)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:58)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:60)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:62)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:64)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:66)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:68)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:70)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:72)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:74)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw$$iw.&lt;init&gt;(&lt;console&gt;:76)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$read$$iw.&lt;init&gt;(&lt;console&gt;:78)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$eval$.$print$lzycompute(&lt;console&gt;:7)\n\tat line38b71c5954894ee29ea660fdbd5c7817119.$eval$.$print(&lt;console&gt;:6)</div>","workflows":[],"startTime":1506581645605,"submitTime":1506581645598,"finishTime":1506581646363,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1040.77778","height":"119.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e065156e-37c7-4dbb-84a1-d7e10fe47db4"},{"version":"CommandV1","origId":198720,"guid":"70124795-58d9-4a97-827b-ddab237343bc","subtype":"command","commandType":"auto","position":25.75,"command":"%md \nThe search may also be limited by edge filters and maximum path lengths.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"264d4d7b-ab61-49ec-b4b1-e7f7178c9188"},{"version":"CommandV1","origId":198721,"guid":"ab6bc353-1dee-410a-b1b2-a2c2c5e2dda7","subtype":"command","commandType":"auto","position":26.25,"command":"val filteredPaths = g.bfs.fromExpr(\"name = 'Esther'\").toExpr(\"age < 32\")\n  .edgeFilter(\"relationship != 'friend'\")\n  .maxPathLength(3)\n  .run()\ndisplay(filteredPaths)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["e","Esther",32],["e","f","follow"],["f","Fanny",36],["f","c","follow"],["c","Charlie",30]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"from","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e0","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"v1","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"},{"name":"e1","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"src\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"relationship\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"to","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"age\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506581658505,"submitTime":1506581658487,"finishTime":1506581661302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1232.77778","height":"158.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6422598a-de67-49e1-be48-64e459da4258"},{"version":"CommandV1","origId":198722,"guid":"64071da3-890a-4457-ad6b-ae8b3522fc1a","subtype":"command","commandType":"auto","position":27.25,"command":"%md \n\n### Connected components\n\nCompute the connected component membership of each vertex and return a graph with each vertex assigned a component ID.\n\nREAD [http://graphframes.github.io/user-guide.html#connected-components](http://graphframes.github.io/user-guide.html#connected-components).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375242333,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22efded5-34c6-4364-8d72-897e2efc6f42"},{"version":"CommandV1","origId":198723,"guid":"dfe6681a-8e03-41d0-8a26-ccfafb3884c5","subtype":"command","commandType":"auto","position":27.5,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Connected_component_(graph_theory)\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/Connected_component_(graph_theory)\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506582083357,"submitTime":1506582083340,"finishTime":1506582083467,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5facb093-c3d5-4217-b21a-e945d2e287ad"},{"version":"CommandV1","origId":198724,"guid":"22643686-ea06-4e5c-9d4a-122aab69961f","subtype":"command","commandType":"auto","position":27.625,"command":"%md\nFrom [http://graphframes.github.io/user-guide.html#connected-components](http://graphframes.github.io/user-guide.html#connected-components):-\n\nNOTE: With GraphFrames 0.3.0 and later releases, the default Connected Components algorithm requires setting a Spark checkpoint directory. Users can revert to the old algorithm using `.setAlgorithm(\"graphx\")`.\n\nSee [https://jaceklaskowski.gitbooks.io/mastering-apache-spark/spark-rdd-checkpointing.html](https://jaceklaskowski.gitbooks.io/mastering-apache-spark/spark-rdd-checkpointing.html) to see why we need to check-point to keep the RDD lineage DAGs from growing out of control.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b9c43b22-911e-482a-9805-4f108c1a80cc"},{"version":"CommandV1","origId":198725,"guid":"cd967e2a-d9c5-4837-a6db-0b89d22d3146","subtype":"command","commandType":"auto","position":27.75,"command":"sc.setCheckpointDir(\"/_checkpoint\") // just a directory in distributed file system\nval result = g.connectedComponents.run() \ndisplay(result)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","Alice",34,412316860416],["b","Bob",36,412316860416],["c","Charlie",30,412316860416],["d","David",29,412316860416],["e","Esther",32,412316860416],["f","Fanny",36,412316860416],["g","Gabby",60,146028888064]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"component","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"java.lang.IllegalArgumentException: Path must be absolute: _checkpoint/efa30794-22f4-43fd-be2f-533413c098fd","error":"<div class=\"ansiout\">\tat com.databricks.common.path.AbstractPath$.fromHadoopPath(AbstractPath.scala:113)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV1.mkdirs(DatabricksFileSystemV1.scala:218)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.mkdirs(DatabricksFileSystem.scala:139)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1881)\n\tat org.apache.spark.SparkContext$$anonfun$setCheckpointDir$2.apply(SparkContext.scala:2158)\n\tat org.apache.spark.SparkContext$$anonfun$setCheckpointDir$2.apply(SparkContext.scala:2155)\n\tat scala.Option.map(Option.scala:146)\n\tat org.apache.spark.SparkContext.setCheckpointDir(SparkContext.scala:2155)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:47)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:60)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:62)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:64)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:66)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:68)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:70)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:72)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:74)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:76)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw$$iw.&lt;init&gt;(&lt;console&gt;:78)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$read$$iw.&lt;init&gt;(&lt;console&gt;:80)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$eval$.$print$lzycompute(&lt;console&gt;:7)\n\tat line38b71c5954894ee29ea660fdbd5c7817153.$eval$.$print(&lt;console&gt;:6)</div>","workflows":[],"startTime":1506582846920,"submitTime":1506582846915,"finishTime":1506582901140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"905.77778","height":"255.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66d569ed-0a82-4933-83f9-5d75dcbc481c"},{"version":"CommandV1","origId":198726,"guid":"03dd65e0-990d-4be3-84b4-471556130697","subtype":"command","commandType":"auto","position":28.25,"command":"%md\nFun Exercise: Try to modify the d3.graph function to allow a visualisation of a given Sequence of `component` ids in the above `result`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0bd6011d-26d0-45bd-9eac-c8707ff3e900"},{"version":"CommandV1","origId":198727,"guid":"b184807a-a88a-472f-a662-b885c794f10a","subtype":"command","commandType":"auto","position":28.75,"command":"%md \n\n## Strongly connected components\n\nCompute the strongly connected component (SCC) of each vertex and return a graph with each vertex assigned to the SCC containing that vertex.\n\nREAD [http://graphframes.github.io/user-guide.html#strongly-connected-components](http://graphframes.github.io/user-guide.html#strongly-connected-components).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375242660,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9b43b97a-4e3a-419b-824e-b1baa9d8303f"},{"version":"CommandV1","origId":198728,"guid":"273a4ff4-949c-4836-a026-1629b86a6332","subtype":"command","commandType":"auto","position":29.25,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Strongly_connected_component\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/Strongly_connected_component\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:45: error: not found: value frameIt\n       displayHTML(frameIt(&quot;https://en.wikipedia.org/wiki/Strongly_connected_component&quot;,800))\n                   ^\n</div>","error":null,"workflows":[],"startTime":1506581987216,"submitTime":1506581987203,"finishTime":1506581987326,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"615d2ca0-fc77-43a5-99a8-e0033ffa48fe"},{"version":"CommandV1","origId":198729,"guid":"481bdd23-74f8-405f-82c5-f6614c20f781","subtype":"command","commandType":"auto","position":30.25,"command":"val result = g.stronglyConnectedComponents.maxIter(10).run()\ndisplay(result.orderBy(\"component\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["e","Esther",32.0,0.0],["d","David",29.0,0.0],["a","Alice",34.0,0.0],["b","Bob",36.0,2.0],["c","Charlie",30.0,2.0],["f","Fanny",36.0,5.0],["g","Gabby",60.0,7.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"age","type":"\"integer\""},{"name":"component","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1462417698863,"submitTime":1462417528974,"finishTime":1462417731953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"862.77778","height":"207.77778","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5d2ece00-8bdd-417a-99be-6ca190bdadd0"},{"version":"CommandV1","origId":198730,"guid":"35bac57a-fc46-4f1d-b86d-313ea4a31818","subtype":"command","commandType":"auto","position":31.25,"command":"%md \n\n## Label propagation\n\nRun static Label Propagation Algorithm for detecting communities in networks.\n\nEach node in the network is initially assigned to its own community. At every superstep, nodes send their community affiliation to all neighbors and update their state to the mode community affiliation of incoming messages.\n\nLPA is a standard community detection algorithm for graphs. It is very inexpensive computationally, although \n\n* (1) convergence is not guaranteed and \n* (2) one can end up with trivial solutions (all nodes are identified into a single community).\n\nREAD: [http://graphframes.github.io/user-guide.html#label-propagation-algorithm-lpa](http://graphframes.github.io/user-guide.html#label-propagation-algorithm-lpa).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375243050,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31ecdc1b-ecef-4207-bb08-da65d87bd196"},{"version":"CommandV1","origId":198731,"guid":"f3e81769-0e1e-414b-8e54-6acb869f2e7e","subtype":"command","commandType":"auto","position":31.75,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Label_Propagation_Algorithm\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/Label_Propagation_Algorithm\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506583040998,"submitTime":1506583040980,"finishTime":1506583041138,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a218f507-c2f5-4a03-8601-ef21cb10e8db"},{"version":"CommandV1","origId":198732,"guid":"1b548aef-1c1a-425a-a9dc-b31829cfe922","subtype":"command","commandType":"auto","position":32.25,"command":"val result = g.labelPropagation.maxIter(5).run()\ndisplay(result.orderBy(\"label\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["g","Gabby",60,146028888064],["b","Bob",36,1047972020224],["d","David",29,1047972020224],["f","Fanny",36,1047972020224],["a","Alice",34,1382979469312],["c","Charlie",30,1382979469312],["e","Esther",32,1382979469312]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"label","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:53: error: value vertices is not a member of org.apache.spark.sql.DataFrame\n              display(result.vertices.orderBy(&quot;label&quot;))\n                             ^\n</div>","error":null,"workflows":[],"startTime":1506583115222,"submitTime":1506583115203,"finishTime":1506583118632,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"823","height":"268","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8ab30f3-9686-4e04-84ce-ee8ef1e824f0"},{"version":"CommandV1","origId":198733,"guid":"17f6a5f2-50b2-4b1f-98e8-5a63c537d64b","subtype":"command","commandType":"auto","position":33.25,"command":"%md \n\n## PageRank\n\nIdentify important vertices in a graph based on connections.\n\nREAD: [http://graphframes.github.io/user-guide.html#pagerank](http://graphframes.github.io/user-guide.html#pagerank).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375243247,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"584a4a4f-a94e-4933-8e06-318b7e146eeb"},{"version":"CommandV1","origId":198734,"guid":"62c1190e-3ffd-41dd-92af-ffa02255f282","subtype":"command","commandType":"auto","position":34.0,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/PageRank\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/PageRank\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506583231627,"submitTime":1506583231607,"finishTime":1506583231756,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba7cfea2-5451-4c72-981e-8b447d8a7a41"},{"version":"CommandV1","origId":198735,"guid":"8d34c997-2253-4acc-b5c8-518c7a5fc72c","subtype":"command","commandType":"auto","position":34.25,"command":"// Run PageRank until convergence to tolerance \"tol\".\nval results = g.pageRank.resetProbability(0.15).tol(0.01).run()\ndisplay(results.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b","Bob",36,2.2131428039184433],["e","Esther",32,0.309074279296875],["a","Alice",34,0.37429242187499995],["f","Fanny",36,0.27366105468749996],["g","Gabby",60,0.15],["d","David",29,0.27366105468749996],["c","Charlie",30,2.240080617201845]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"pagerank","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583256744,"submitTime":1506583256724,"finishTime":1506583262043,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06d44d42-3a87-46bc-804e-c28c9263dd51"},{"version":"CommandV1","origId":198736,"guid":"f5123e5b-e2bd-4fa5-a7ae-ad63199193e6","subtype":"command","commandType":"auto","position":35.0,"command":"display(results.edges)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["a","b","friend",0.5],["b","c","follow",1.0],["e","f","follow",0.5],["e","d","friend",0.5],["c","b","follow",1.0],["a","e","friend",0.5],["f","c","follow",1.0],["d","a","friend",1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"string\"","metadata":"{}"},{"name":"dst","type":"\"string\"","metadata":"{}"},{"name":"relationship","type":"\"string\"","metadata":"{}"},{"name":"weight","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583276652,"submitTime":1506583276632,"finishTime":1506583278214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4fb776b6-a4c0-4b52-a6f2-4aed2ff1c9b1"},{"version":"CommandV1","origId":198737,"guid":"ac1ab7dc-f3f5-4a32-b8ab-ce86bba44021","subtype":"command","commandType":"auto","position":35.25,"command":"// Run PageRank for a fixed number of iterations.\nval results2 = g.pageRank.resetProbability(0.15).maxIter(10).run()\ndisplay(results2.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b","Bob",36,1.842259190054981],["e","Esther",32,0.31616362485373634],["a","Alice",34,0.39143465933514154],["f","Fanny",36,0.28427148788098855],["g","Gabby",60,0.15],["d","David",29,0.28427148788098855],["c","Charlie",30,1.877540087856477]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"pagerank","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583299616,"submitTime":1506583299595,"finishTime":1506583301623,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2941bf9d-e278-4ae7-a9e0-93991250b8ce"},{"version":"CommandV1","origId":198738,"guid":"aa4e6e4e-921a-47e6-b00b-cae1a816bcab","subtype":"command","commandType":"auto","position":36.25,"command":"// Run PageRank personalized for vertex \"a\"\nval results3 = g.pageRank.resetProbability(0.15).maxIter(10).sourceId(\"a\").run()\ndisplay(results3.vertices)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b","Bob",36,0.2699384803126761],["e","Esther",32,0.07527103448140514],["a","Alice",34,0.1771083164268356],["f","Fanny",36,0.0318921369727478],["g","Gabby",60,0.0],["d","David",29,0.0318921369727478],["c","Charlie",30,0.24655465114397318]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"pagerank","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583323139,"submitTime":1506583323117,"finishTime":1506583325206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"121bfce7-fd90-457f-b2ac-089fba1a0d07"},{"version":"CommandV1","origId":198739,"guid":"762099b7-95b2-47d7-8ae4-21164a9a1898","subtype":"command","commandType":"auto","position":37.25,"command":"%md\n## Shortest paths\n\nComputes shortest paths to the given set of landmark vertices, where landmarks are specified by vertex ID.\n\nREAD [http://graphframes.github.io/user-guide.html#shortest-paths](http://graphframes.github.io/user-guide.html#shortest-paths).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375243641,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aafb9806-5cc4-43e0-abef-8d2d14000cf5"},{"version":"CommandV1","origId":198740,"guid":"315555cf-3b94-4812-bfa0-84de7c8c27c3","subtype":"command","commandType":"auto","position":37.75,"command":"displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Shortest_path_problem\",500))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://en.wikipedia.org/wiki/Shortest_path_problem\"\n width=\"95%\" height=\"500\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506583526557,"submitTime":1506583526533,"finishTime":1506583526666,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"081595f2-dfc6-471d-9c78-dcf2b8388bf5"},{"version":"CommandV1","origId":198741,"guid":"93efd2d8-f947-4955-bdc8-6998a6bb936a","subtype":"command","commandType":"auto","position":38.25,"command":"val paths = g.shortestPaths.landmarks(Seq(\"a\", \"d\")).run()\ndisplay(paths)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["b","Bob",36,{}],["e","Esther",32,{"d":1,"a":2}],["a","Alice",34,{"a":0,"d":2}],["f","Fanny",36,{}],["g","Gabby",60,{}],["d","David",29,{"d":0,"a":1}],["c","Charlie",30,{}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"},{"name":"distances","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"integer\",\"valueContainsNull\":false}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583550810,"submitTime":1506583550784,"finishTime":1506583552585,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"356a6a31-cade-4cbc-8f92-812d8a53074f"},{"version":"CommandV1","origId":198742,"guid":"38a84f9d-e8c8-474e-867f-4e8dcd7ce6e2","subtype":"command","commandType":"auto","position":39.25,"command":"%md \n\n### Triangle count\n\nComputes the number of triangles passing through each vertex.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1456375243735,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5011bc37-f0d5-4ee2-b3c2-d4441e12bbfb"},{"version":"CommandV1","origId":198743,"guid":"bcbcea25-1439-4356-b9e8-7bed6e268a8d","subtype":"command","commandType":"auto","position":39.75,"command":"%md\nSee [http://graphframes.github.io/user-guide.html#triangle-count](http://graphframes.github.io/user-guide.html#triangle-count)","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"http://graphframes.github.io/user-guide.html#triangle-count\"\n width=\"95%\" height=\"300\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/ml-features.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1462418973506,"submitTime":1462418803550,"finishTime":1462418973639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9236b945-223f-42bd-b916-cdeddc1738b8"},{"version":"CommandV1","origId":198744,"guid":"07010f4d-2dc2-41a1-9a11-96cfb7f862ae","subtype":"command","commandType":"auto","position":40.25,"command":"val results = g.triangleCount.run()\ndisplay(results)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"g","Gabby",60],[0,"f","Fanny",36],[1,"e","Esther",32],[1,"d","David",29],[0,"c","Charlie",30],[0,"b","Bob",36],[1,"a","Alice",34]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506583631737,"submitTime":1506583631732,"finishTime":1506583635557,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2c317b70-a10a-4bdc-9514-3695a1183639"},{"version":"CommandV1","origId":198745,"guid":"83357db0-f031-4aff-ae64-e593661619d0","subtype":"command","commandType":"auto","position":41.25,"command":"%md\n\nThere is a lot more... dig into the docs to find out about belief propogation algorithm now!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e6430c2-19ef-4aaa-a120-2735069057de"},{"version":"CommandV1","origId":198746,"guid":"4d8e644a-af61-46ee-97bb-cde08a776726","subtype":"command","commandType":"auto","position":42.25,"command":"%md\n\nSee [http://graphframes.github.io/user-guide.html#message-passing-via-aggregatemessages](http://graphframes.github.io/user-guide.html#message-passing-via-aggregatemessages)\n\n","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"http://graphframes.github.io/user-guide.html#message-passing-via-aggregatemessages\"\n width=\"95%\" height=\"700\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/ml-features.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1462419091040,"submitTime":1462418921085,"finishTime":1462419091149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61f1de37-4ea0-455e-85e1-594f4c031d38"}],"dashboards":[],"guid":"f3db8671-8586-4b4c-805c-ebc27a4b5ca9","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
