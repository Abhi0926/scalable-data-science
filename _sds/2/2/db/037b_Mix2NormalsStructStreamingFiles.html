<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>037b_Mix2NormalsStructStreamingFiles - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":false,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"class-node","description":"Class Node","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"class-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":false,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"class-node","spark_version":"3.5.x-scala2.11","num_workers":8,"autoscale":null,"aws_attributes":{"availability":"SPOT_WITH_FALLBACK","instance_profile_arn":null,"first_on_demand":5.0,"spot_bid_price_percent":100,"zone_id":"us-west-2a"},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"shouldShowCommandStatus":false,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"allowRunOnPendingClusters":true,"applications":false,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-eff9552bcb6cb65f96a0d9bb2b5123594d8a53fff456b3440fa6908f4263ef99","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0.1 RC (Scala 2.11)","packageLabel":"spark-image-bcd7a7b6247d51a673ce291722d0fee3654dfe50b5b04c8fba19b97c95f53fd5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-fc7e6ce873948365eb11f107b2b8b14ddd1311f5b95157dbc55667a7b1464708","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-00449cd26af8335b76ed4fe6a9cdbc7388977da83136f52ca90e548080270683","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-29871daabc403ee59cefd38533228f5815e3a5cece18deab18ce35ac8705e7a3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5ca78b83c7960ace704b397edc40a010fc3a75f713587d908a9296b771fb8530","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5e2a1a9d6a9d35bcd2a031a42f8d5ebdebd1f37f917cd95c861ac17578722b21","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-9c570ceec585af02b6759d89a19584bdf222b1bf6f3e0ebc700a7b4d0bf492a8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-d70218f5efeba85df5c5a4a4bd76135221e1b01728fbdeecead023e2d322bbb8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d1b81198d41215abe0c72e5ce4f56168b3b2acc6cb178e291f2bf04fd4f4be03","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-71baec97f74825bef2ca870a7520340c8f5ce25583e0b94960dd5242f2d813e0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":true,"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.67.1037","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":5000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":true,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":true,"enableCustomSpotPricing":true,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":1000,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":false,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"UNKNOWN_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"SPOT_WITH_FALLBACK","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2a","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":true,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":false,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":false,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableUserPromptForPendingRpc":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":false,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":207845,"name":"037b_Mix2NormalsStructStreamingFiles","language":"scala","commands":[{"version":"CommandV1","origId":207882,"guid":"0ce91bf7-ab68-4100-99ed-0bf5aa240136","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n# [SDS-2.2, Scalable Data Science](https://lamastex.github.io/scalable-data-science/sds/2/2/)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f40f4d6b-3c25-429b-a588-fb17cc47edd5"},{"version":"CommandV1","origId":244022,"guid":"f69ace10-41cc-47b6-9afe-2030b6e4356a","subtype":"command","commandType":"auto","position":0.75,"command":"%md\nArchived YouTube video of this live unedited lab-lecture:\n\n[![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/fXo7AfE3Umg/0.jpg)](https://www.youtube.com/embed/fXo7AfE3Umg?start=0&end=2670&autoplay=1) [![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/sAttqpQq4nA/0.jpg)](https://www.youtube.com/embed/sAttqpQq4nA?start=0&end=2630&autoplay=1) [![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/byAZtT_EdO4/0.jpg)](https://www.youtube.com/embed/byAZtT_EdO4?start=0&end=1045&autoplay=1) [![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/bhHH74vkqHE/0.jpg)](https://www.youtube.com/embed/bhHH74vkqHE?start=0&end=487&autoplay=1)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"547f225c-56ee-43d7-b8f9-e38b205b05f1"},{"version":"CommandV1","origId":207846,"guid":"67d9c06e-1e82-4438-b6c5-4bfaa663514a","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Write files periodically with normal mixture samples for structured streaming\n\nThis notebook can be used to write files every few seconds into the distributed file system where each of these files contains a time stamp field followed by randomly drawn words.\n\nAfter running the commands in this notebook you should have a a set of files named by the minute and second for easy setting up of structured streaming jobs in another notebook.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2873d2d6-e9b3-49dc-bdce-2fb555a419f6"},{"version":"CommandV1","origId":207867,"guid":"ff193610-9127-4f22-a336-b82d46464daf","subtype":"command","commandType":"auto","position":10.0,"command":"%md\n## Mixture of 2 Normals\nHere we will write some Gaussian mixture samples to files.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bfa146d9-79f9-4215-9cdb-64fd4cc3bbe3"},{"version":"CommandV1","origId":207868,"guid":"25e0288e-3d03-460c-b8db-8ca6b2ee651d","subtype":"command","commandType":"auto","position":11.0,"command":"import scala.util.Random\nimport scala.util.Random._\n\n// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters\ndef myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {\n  val sample = if (r.nextDouble <= normalWeight) {r.nextGaussian+normalLocation } \n               else {r.nextGaussian + abnormalLocation} \n  Thread.sleep(5L) // sleep 5 milliseconds\n  val now = (new java.text.SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss.SSS\")).format(new java.util.Date())\n  return (now,sample)\n   }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import scala.util.Random\nimport scala.util.Random._\nmyMixtureOf2Normals: (normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: scala.util.Random)(String, Double)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:42: error: not found: type Random\n       def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : Double = {\n                                                                                                           ^\n</div>","error":null,"workflows":[],"startTime":1511344515710,"submitTime":1511344527659,"finishTime":1511344516024,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58f3e424-065b-4d93-8fa8-f806799d7d6f"},{"version":"CommandV1","origId":207869,"guid":"586c2ede-a84d-4572-89f4-938abd68e5ad","subtype":"command","commandType":"auto","position":12.0,"command":"val r = new Random(1L)\nprintln(myMixtureOf2Normals(1.0, 10.0, 0.99, r), myMixtureOf2Normals(1.0, 10.0, 0.99, r))\n// should always produce samples as (0.5876430182311466,-0.34037937678788865) when seed = 1L","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">((2017-11-22 09:55:37.997,0.5876430182311466),(2017-11-22 09:55:38.002,-0.34037937678788865))\nr: scala.util.Random = scala.util.Random@44ccefc6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:46: error: not found: type Random\n       val r = new Random(1L)\n                   ^\n</div>","error":null,"workflows":[],"startTime":1511344537836,"submitTime":1511344549786,"finishTime":1511344538002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"efc22b20-8b26-4ddb-8def-400142542aeb"},{"version":"CommandV1","origId":207896,"guid":"ec39e107-6cc1-46c0-94c3-6064e77c03be","subtype":"command","commandType":"auto","position":12.5,"command":"display(sc.parallelize(Vector.fill(1000){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).toDF.select(\"_2\")) // histogram of 1000 samples","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.63847575097573],[0.8497955378433464],[1.0173381805959432],[-0.026960935205721848],[-0.06096818465288045],[0.6235321652739503],[1.1594225593708558],[2.6812781205628102],[2.3144624015522943],[3.2746230371718874],[0.6239556140200029],[0.6428284914761508],[-0.42618967795971496],[0.4090774320731605],[0.731226227370048],[1.392728206581036],[1.3354355936933495],[0.17821385872329187],[-0.23317608061362294],[0.47289802886431465],[-1.9401934414671596],[10.214120281108658],[1.892684662207417],[1.0166947170672929],[0.022709372842290798],[2.1067186310892803],[-0.2704224394550252],[1.1899806078296409],[1.9798405611441416],[1.674277523545705],[1.7051472629603235],[0.30230911121326054],[1.3131677682296694],[0.6862907308874912],[1.5472597655237206],[-0.21817241232347429],[2.7926715721364213],[1.076185529891312],[1.553330079653454],[1.8513287666787783],[0.9573896481551991],[0.05970253671115444],[1.1541469640881448],[0.2802123113351551],[-0.5344837021313593],[1.725283845177347],[1.755161663154593],[-0.5917988890618884],[-0.16673131970385602],[-0.8875029732034849],[0.8698903603546103],[2.114856053952625],[2.497996116473529],[9.58947465374601],[2.9441080471551846],[2.5155704683949165],[0.17630763054020993],[0.18281600980713353],[1.9274188319901921],[-0.5948223586642365],[-1.2010559428888148],[0.39178009640886724],[1.8700313397445891],[1.9822181107950154],[1.2988415493692078],[0.19172302714886202],[1.8821092899972611],[1.3022299642012503],[1.4752832590499911],[0.3609863067031439],[1.9323022237840024],[1.69205485183195],[2.837382612764204],[0.1910603148124741],[0.341728700100859],[2.2890102177414597],[0.9364985206830795],[-0.09834860359562425],[1.9684980059019335],[2.1078374167392218],[0.8418311806515589],[-0.06692278803103968],[3.0610863387705947],[2.5970193768494565],[1.7322441665190011],[1.906475635230355],[0.7904177135359902],[2.251629313442862],[0.821157571251303],[0.604717877958487],[-0.02786225541637921],[0.25604168086650014],[2.227036911451595],[0.5553767689608333],[1.2188030914528114],[0.4514774439330318],[0.6543905674437465],[0.40245654155097643],[0.5060580393139191],[0.39607300301218784],[1.2148439132942364],[-1.1732951662319397],[2.73880972901814],[1.8021623567418805],[1.7158266876051977],[-0.05753772099978405],[0.8372348006260973],[1.0550026092093487],[-0.195219134074764],[0.8383022815662486],[1.2379684980482244],[-0.9744247939864081],[0.34334678488869397],[0.9559281181537529],[0.1404041195836977],[-0.3013816873777868],[2.3896906481802835],[0.32642106560403683],[1.1731296744694082],[1.5569305149964348],[1.5889387851920198],[0.4731172095886468],[1.8856173342031206],[2.3639372705821358],[-0.04477980164340978],[1.0290704620759326],[1.9189177950037783],[-1.0270431347512887],[0.29509917268188934],[0.2778311015556939],[2.0003447521256588],[1.1150669950847454],[0.8896045579010659],[0.6672200055719166],[2.835109610406893],[0.7007330220501728],[0.9750338145448016],[1.5645635468047536],[0.9674358170359617],[0.25227970595044513],[1.375957412863052],[1.308418670787698],[1.9419970123581474],[0.8365053262598314],[1.9114557211166892],[3.8001770349623225],[0.8274099015781488],[0.8067385461002958],[-1.4655370928162954],[1.8238007602460073],[0.5594066359278937],[1.6110515128363136],[0.6652500763228728],[1.0793393655154422],[2.245390820036886],[0.35470134173051693],[1.2952852735590668],[1.8610829534004827],[0.33089671577831126],[1.1590236911322995],[2.2514554017998076],[1.3216086127545497],[0.5881415761335955],[3.0225970797989596],[1.9673222329020743],[1.9658660340337613],[1.8710008504436737],[1.845446759447753],[0.14370718520286974],[1.908535196201739],[1.0842042894798714],[2.3715209552442835],[1.5054700276157238],[3.2507198636175434],[1.2191172203825102],[0.8790791380073175],[-1.0037247733674635],[0.9049623487323446],[1.2089925367368337],[0.6882976824476612],[2.5434935418288713],[1.0027620856353483],[-0.27959350084891055],[0.3279655527731484],[1.5786118902182438],[-0.39629416278043617],[1.1770224496224355],[2.383953754814976],[1.091832388214859],[1.6301831536311209],[0.935425666376106],[2.1401208410667696],[1.5922472337477118],[0.34768463336762756],[3.4257932035179848],[0.7149821525322468],[1.5415488633926249],[1.6496390565891736],[0.9593424220951506],[0.6518631532504793],[3.403687949320813],[0.8320258402390563],[0.12142126647709839],[3.597300820980316],[0.14741363170749655],[0.8462912401166103],[1.0584643703479584],[1.1487138176792762],[0.3488425183144027],[1.391612358634887],[1.505017789786627],[0.5244087078660062],[0.2705096241707795],[2.216688343494393],[-1.6589238926022496],[1.708690947086617],[2.961208276039951],[0.06522128902971014],[1.930831478373714],[1.1607184811130336],[1.6688339248285566],[1.6470200278340348],[2.449696037385742],[0.8251476817941197],[1.40403402944069],[1.2942215447658563],[1.7120981908967403],[-0.08929122874418227],[3.7731683503114843],[-0.06239748698038494],[1.1840870589278099],[1.441608712447355],[1.208878651490341],[1.8920599151149384],[0.02527569684835118],[0.38124154100408325],[-0.2393929330098632],[0.1338106966810938],[0.2676880074695901],[2.1281668027663505],[0.3098286754011822],[0.4585965277423747],[-0.025930812376542933],[2.083732337529618],[0.6731348015628896],[0.1312853060580106],[1.6205120279909435],[0.03665204102481068],[0.38840609319995334],[0.16412699262051766],[1.0044846177991755],[0.45217422200704216],[-0.18519175139069355],[-0.29646999575663124],[0.47945009163424923],[1.7615776520354332],[0.35352511094407846],[0.5902336217395934],[1.7471513985001184],[0.4125022414098265],[0.7484837707176137],[2.4227348582478037],[1.0572595828548697],[3.0750919548401128],[1.0066299184508531],[0.011704717372072126],[0.5249712753060873],[-0.3285040378625381],[1.342275367397042],[0.4464461744940117],[1.8011252317891455],[0.814252403591333],[1.394324297666107],[1.746173303844829],[0.9316948966812066],[0.200871837759239],[0.21504170344279683],[1.3508727155177145],[1.5029472339851955],[1.3410205427121795],[-0.29787456681066304],[0.5368515430517165],[0.4903528739420413],[1.385472033421005],[-0.2770976989604108],[0.14383609785529106],[2.136175000080348],[1.3623047924484522],[1.7982361871358026],[0.31744493918444716],[1.6350814336974835],[2.1281399761210897],[2.502566064523463],[-0.24563123892361882],[1.1658851718667056],[0.9774056737281539],[-0.9759524597979035],[1.189619858484149],[1.5319416027989528],[2.1398379560783063],[-0.8795632577020192],[0.9740025013919826],[2.1670377423670066],[1.8772156837816794],[1.4824573418919358],[2.0936166431428],[0.48330193647070885],[1.1693862084127395],[2.9630411557020633],[0.7910395376475294],[2.2572758761916054],[0.5908398656455651],[1.0801869359536456],[1.6034174887237207],[2.06427635708377],[1.7447902837676048],[2.031505217347445],[0.7818721634007395],[0.7546588629356998],[0.21941395803984998],[1.269969127498187],[0.6995395205381358],[1.6248745281288801],[0.8263012944805543],[1.4386440510670049],[2.190301845034811],[0.21078498872972096],[0.9513469983933799],[1.7125428803482596],[1.398303536566959],[1.1206534766009186],[2.290467145367123],[0.0047109383568383345],[2.294594854357012],[1.4766168147668075],[1.1557121731747513],[1.9080418901330192],[1.8649147337827425],[1.4389071560055176],[0.10082531163297859],[0.9702568121268303],[2.7799453357863033],[2.24549312231816],[0.5235703215957042],[0.0474734605167747],[0.06947954022632907],[0.3108356478112668],[0.8394845735542491],[1.6339257039230628],[-0.0781874305278627],[10.700496016278244],[1.306079988619333],[1.0105357675060997],[0.994188218965991],[1.8719149336462086],[-1.802104678175969],[1.3547952390058997],[1.6863315414298679],[0.4044486829589423],[0.663151463812041],[1.1770322429105757],[0.352603150929493],[-0.3331634174041469],[0.3219528023599839],[-0.04993059725088589],[2.1359810727430015],[0.067435821150996],[0.8152880685205637],[1.3355438274268063],[0.2584888411640408],[2.1807115216184654],[1.6447860615623693],[1.3607208126185033],[-0.7821045197212251],[0.7038349029306756],[2.1151467870965206],[6.485239215670013E-4],[0.7343141400907413],[1.481231890529832],[0.7436383571380679],[0.3623319184166701],[1.631447713261156],[1.9006969436568095],[1.4157080835736964],[1.1280983721670481],[0.9426963726981692],[0.24856063619656132],[2.255628154607799],[2.252115121208546],[0.7841223760628484],[2.3421293755672297],[2.8348182486914295],[1.7318785148989992],[0.9762383915277096],[0.2616760398200866],[-2.0755223554176574],[0.8670675571509455],[2.396557755329019],[1.1056101876800475],[0.2021889628502218],[1.1500629266145144],[-0.05934104215058822],[1.3810015349944087],[1.4678912177406023],[2.673868252550129],[1.124862297586977],[1.1197692140235738],[0.5797093329389853],[0.6109162599915521],[1.494308943924204],[1.1433812164404558],[-0.03285316146399686],[0.6761399530014083],[1.1616013112893129],[0.36992246959386677],[-0.22957870942980962],[1.8420697014408531],[1.668302982091929],[-0.9984398554534477],[1.273607856169444],[1.050632908723346],[3.256210339328564],[1.0280169417144063],[0.25615873705323133],[1.7462784369850581],[1.062093713031747],[1.2932300520227344],[-0.7938447295027886],[-0.7609148389003666],[1.4574415363357067],[2.135798938708896],[2.348280132734578],[0.8734588034850551],[9.973604957378543],[0.35196987232964316],[0.9035385778892631],[2.831102216825725],[1.0048753977495803],[0.10451954987326095],[1.1013729655881508],[1.7585193090606088],[1.226418453772686],[1.4531562937415308],[0.7619165788941504],[0.5461009604744256],[0.6008649427727283],[1.3780057162734836],[1.4622978840755851],[0.34759263562314335],[0.5736485977723396],[2.3452708258883352],[0.9744585521015179],[1.285268161746166],[3.3071183043196593],[2.5080380549754593],[1.4259274788963952],[-0.025903667885951664],[10.986550512370714],[-0.07581817475272645],[0.6416173679276148],[0.9534229122939114],[2.132841239825161],[0.6563712251065035],[0.5765226219933468],[1.5821498064982138],[0.8155216333285705],[2.405818410234607],[2.1354048597660134],[0.1630525718563236],[0.8804014022168887],[1.7677390861016287],[-0.08660285888231711],[1.4957055199119156],[1.1686901432590528],[1.230599828613972],[0.8291351676730639],[0.16369805405490445],[1.7141910766526713],[-0.06948651912105075],[1.1025296196845764],[2.085963027757715],[2.3289725923192126],[0.09123696930094438],[0.7863635245315979],[1.2210644347049109],[2.536308464119898],[0.7390652688383932],[1.7955412008455056],[-0.4063994398735684],[0.417663857272753],[0.7572268352036777],[2.2956618964137903],[0.8643802079825195],[0.6085757743161285],[0.8861852158953121],[0.20486279885097103],[1.6421903961418307],[-1.4786102936414443],[1.61151014329611],[1.458781222964441],[0.9231917785415031],[2.987811838778618],[-0.11728923230585608],[-0.5667637111213064],[0.6043249745554822],[0.5250792304891077],[1.7590856628461462],[2.9472816508826574],[-0.5091218022791495],[0.2743637223565212],[0.7727501145356438],[1.402853616121213],[1.7554959619234003],[0.7230708651518659],[-0.6084691576920431],[0.17482707245078832],[2.067354421609911],[0.7901599165913906],[0.01652492308966036],[2.2069354262628993],[0.5663855120607604],[1.3454449336721601],[2.2789771861802697],[-0.22026555210551368],[2.0631465437978855],[2.039163346272715],[-1.055015394694371],[1.7388420238468236],[1.872637961652257],[3.2010804478144554],[1.3562671867479166],[-0.32950571604262713],[-0.12503275455021545],[1.277154825764409],[0.8843613626221687],[1.0729763052881904],[2.3265082147700946],[1.396457159161225],[2.0285111744592372],[1.330964559152572],[2.2179887039102653],[0.6284429614059523],[0.3504227161829304],[1.059416715157096],[2.138857533311191],[0.8094290918556053],[0.46138825363082825],[1.7155270828145763],[1.2795402627927337],[1.923106069471253],[1.5104912344606418],[0.5207525194340703],[0.9946842162070768],[0.035622068453996514],[0.18537526816937433],[0.6111284963963912],[0.8203863356928468],[2.6753862253484195],[1.650835985592774],[1.5665183929170006],[1.8194416800691129],[2.0526203700510672],[-0.651338434409015],[1.7895684845926731],[2.418781611162374],[1.0787214433473757],[0.18911021430460961],[-0.2730870440651234],[1.1132512450740597],[1.0791906170600118],[0.655348601135614],[1.8662289569576362],[1.627670496605692],[11.004554142758568],[0.1965392063488054],[1.544545432892698],[1.5832867870520477],[1.8981385396481731],[2.8183382851231302],[0.5740375808180014],[-0.22669316378819526],[-0.24362648940070186],[0.6735629913863805],[2.602135296264379],[8.790069946983575],[2.5322332152585725],[3.3409503348064518],[0.687556087265665],[3.0425649254546347],[2.303391429846904],[1.4423838621149456],[1.4532350387273563],[1.4533824084502533],[0.03587876263951717],[2.20315841028769],[0.36244134638228875],[0.6105194199863686],[-0.45389649712820246],[1.0252296817007915],[3.1243573699805918],[-0.3343748567492124],[0.5029922338992889],[1.7237601942074183],[1.3511410651578275],[1.0909840953480212],[-0.32919830466100297],[2.141237972293073],[0.5392802259404192],[2.0625972069627694],[1.244091480416753],[0.5541089423362922],[0.6229771138177793],[1.6750943089353725],[0.6582509099634593],[1.3833368320356623],[1.5435711785532977],[0.522680525295731],[1.1915344402925043],[0.35720513834862744],[-0.008565981412975487],[1.5372133772727767],[0.05533905500333114],[2.106400343304179],[0.9291634254575988],[0.85445925115937],[1.4490678502266374],[2.1619334568272004],[0.2576823307255467],[3.0652975358670402],[1.7957493894493899],[1.3815187097537076],[0.7289953121054422],[0.6648198928488573],[2.796805936556927],[-0.6218526047970672],[3.443106828552411],[0.5417960512110482],[0.132679330973015],[1.682704565079506],[-0.9024146545484664],[1.7184762053500053],[-1.0864413777491877],[2.4082299567533854],[0.6867344491764446],[0.6342469814283839],[1.4948735109252287],[-0.009172542759290137],[1.6946662014403582],[0.5055706186920743],[0.8321247164414739],[-1.9229724798355035],[2.0668198169520764],[0.6061498747704183],[1.1542480718044577],[0.8061008067230262],[3.082304566988994],[0.860398339444179],[0.8735622227950341],[1.645389530143016],[0.31526948080501604],[1.752922329065294],[1.569150260594506],[1.7989690892449675],[1.8128536428855522],[2.174392027870953],[2.0629021196034616],[2.846679590420721],[1.6394381805033087],[0.5575890384195411],[-0.061635562922423226],[0.8770394819777554],[0.18278872308418326],[0.6653187571193362],[0.3097532566309745],[1.4422363582612099],[2.2343382287346265],[1.324757244250018],[-0.6265562099516999],[0.7530623041134055],[2.4548974876953755],[1.1505257093180181],[0.18314366349299938],[1.0957673061461137],[1.5898966599318236],[-0.8021527506395465],[2.9919524601934695],[0.16404921511675252],[-1.2374220758846475],[1.0926015540947187],[1.7047203204003867],[2.0361007784966425],[-1.1129955618534204],[1.2078806959684631],[1.3823025668814726],[-0.20117996650194825],[0.4368510042955428],[1.548393626209222],[0.4462763885045765],[0.9980172029792674],[0.2244700800716185],[-0.21800349448603162],[0.16417229737752437],[0.6207189588427342],[-0.6888898628873894],[0.5459693517409819],[0.9025080719803394],[-0.80260527881833],[1.6163270811863857],[2.633075725131599],[-0.7773305013995544],[0.2526721145132672],[-0.1366344706945435],[0.6144275159404241],[1.97335159695082],[0.653596005828342],[1.6116893597735258],[1.2014572106480943],[1.5512973474330294],[1.1163799230226856],[0.7681458989542176],[-1.3590749505030857],[1.808641901084573],[1.360253821157752],[1.650932132662064],[0.027784418591342397],[6.352095139713354E-4],[1.441774342046809],[1.2027746328482523],[2.3897838732271515],[-0.716495277439726],[1.4815526561707035],[0.6060868601377281],[1.0576521934236953],[0.48936224390584415],[1.9354637823092111],[0.9117750291708597],[1.5859428172890642],[0.3265619461022775],[1.4075266094882544],[0.1875530632757464],[0.03785747077498869],[0.1631893341844134],[1.3291278928477839],[2.052089759378511],[1.669824081897619],[2.1070512246301867],[0.6995955417782742],[0.8007672174475671],[0.7544785261517125],[0.35717027130006673],[0.1475616766180351],[1.058691342729173],[2.066376270854084],[0.7760634597252762],[0.8763163198863502],[0.7454179518243453],[0.4854355686115821],[1.5918037585502445],[1.0851213695662045],[2.0203357822531967],[1.7808274985539043],[3.3342822479741083],[0.5663200540954269],[1.2312898243010122],[2.441121828813979],[1.7131802924620656],[1.8828830522974154],[1.219662609175296],[0.6260480088733502],[0.6699112699464786],[2.9616463814694187],[0.4897205675463613],[1.3817814430979267],[2.368499575307164],[0.7666593765571403],[-0.2356306903167824],[0.11121972846306671],[0.13048302696943748],[2.0296555679842934],[0.6821008335751151],[0.824902101020345],[-1.4357280652706677],[0.43551196308521123],[0.42864594983955717],[1.5708973296624738],[0.7355576398800922],[1.7698063948887048],[1.5506318814642417],[0.07337999234267556],[-0.5590435862206975],[2.0708510087246363],[1.0937426555598604],[1.866409592951821],[1.4315729492342215],[0.4352270706743224],[-0.32282708992213793],[-0.7926070985572229],[4.1313375262139385],[2.5182310368999583],[1.5517727635341054],[1.2112227339558879],[1.088870081894894],[1.3840364826625247],[0.7313598601928168],[1.4979622853866332],[-0.09589043964797783],[0.18259590774466605],[-0.605015706579229],[0.479252514082421],[2.446158573827078],[0.9738579307442236],[0.8806136322907132],[-1.208394918011912],[-0.14037642146707818],[-0.08062071408017712],[0.325790154240306],[0.2876391391859443],[-0.054041048579440476],[0.8773670649720676],[2.367842331811702],[0.26889262808832914],[1.724119815882517],[1.7791641061471468],[0.734736381050196],[1.6845526251491851],[1.621893865768243],[2.0312929797085744],[0.7494718435492904],[1.2022212419280855],[1.8619921045777033],[0.7029888222716667],[1.994083595934665],[0.7072489103032473],[-1.1377100954267716],[2.043095143556785],[2.166457075549966],[0.5807453858478133],[1.4374121122629657],[0.954614007781135],[1.953034562155581],[-0.31599836594918784],[0.4068636792746446],[1.7729848751693704],[0.13604733276520964],[1.5733429242522448],[-0.24138972935741654],[1.9768168747035486],[0.8346709933535629],[-1.0458047931412482],[0.6197520625356908],[1.624038733446523],[1.2010762746847274],[-0.9819289179145085],[2.4170778788623286],[1.107936607297393],[1.3942450780076066],[1.3573378818806876],[0.041669854205718004],[-1.0230668880126963],[2.1672936942995924],[2.119034877005035],[2.617354118940299],[0.2064667615861927],[-0.5725286096934115],[2.1705557671839575],[1.074568348781358],[1.5117862398041413],[1.720961326096484],[0.5484584732722113],[-0.5487880960214739],[0.6889819892464035],[1.0619551547481028],[1.211942404937342],[1.6696784059290148],[1.3761977731682555],[3.071527103226564],[0.8205571465304501],[0.27290043128415853],[1.0653401225764465],[1.1614811977828927],[1.7383121079945434],[-0.1599579688189814],[0.7161844910476673],[1.5825851430026225],[1.729082954840492],[2.9837819396012546],[0.6578883627962699],[1.1377610134374765],[-0.6323774087781868],[0.46007501303967147],[2.6521967942692486],[-0.06125168548660631],[2.9103478438885473],[0.39594395800598337],[2.1923535711428848],[1.4697826622154868],[0.30222917190196086],[1.459617110508502],[1.5211379317237608],[0.5572602929344768],[1.6823380276685338],[1.5547569617336123],[0.967365035197969],[0.7566178166538748],[2.1650489378269775],[2.4253722899093866],[10.23186845160902],[0.1488435276719955],[1.334317069373473],[0.13187282300981706],[1.9930419173328975],[0.1443423696606898],[0.6007539040372134],[1.886587311852184],[0.28914373993637366],[1.9776682498960527],[2.4758782746217123],[2.7070897621357446],[0.9472622505602268],[1.2602098520570666],[-1.7566407142390892],[1.5745734897235473],[0.6130201020930863],[1.0358032358478906],[1.5052778526230153],[-1.0672425439622724],[1.5281373508721496],[0.5223419811330235],[1.8542151442789314],[1.2285178570916262],[2.7988645052766676],[-0.861627034243382],[0.9294699314786086],[2.2360036137643347],[0.28408155798843726],[0.943759844028374],[1.4808042306276197],[8.976182739712016],[3.5904784799076],[1.244680688295711],[2.015594144111281],[1.6682081811950065],[1.3062492721042696],[0.9597597738929083],[0.14081110195632118],[0.6802144777826231],[1.7427436989859513],[1.025119809243448],[2.363808744264097],[1.098939384496553],[2.365900700802084],[0.9639713759620857],[1.1879608636926524],[0.2648582754089548],[1.6006017120486895],[0.07519379906201751],[0.2198949605081273],[1.5190910869919414],[1.3945275248631226],[0.651205917924697],[0.6910676581885502],[2.041288605562429],[1.3322502409533927],[0.8190849792925787],[0.7731687411115308],[2.052287561083507],[1.8008966716911172],[1.231841585551883],[1.6898412909890235],[1.2644139086012807],[2.7531121025849865],[0.30461789013034024],[0.7788454265121008],[1.3219507722927721],[-0.45523491060288057],[1.2677313887765018],[1.7996640101307269],[0.4670890255653002],[2.4769073718909094],[0.3494158442146792],[0.22328815419586],[0.34206270424196084],[-0.12746179104408784],[2.197149144795371],[-0.6353823443308804],[1.0875581317673213],[0.9444545881585366],[1.965966128848457],[0.5039931206538372],[1.2106483228588576],[0.6580705742678696],[2.3578096465318747],[-0.5066449988185571],[1.0762171812349997],[1.0356862000259204],[-0.6471662591053053],[1.8235922438459014],[1.0820154631653591],[2.3564967540496595],[1.6506535694050806]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_2","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511344542222,"submitTime":1511344554146,"finishTime":1511344549974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"1164","height":"282","xColumns":[],"yColumns":["_2"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"histogram":[{"key":"bins","value":"100"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cd64e06d-59df-48cc-acf3-b3279817f4ea"},{"version":"CommandV1","origId":207870,"guid":"7af4f6cc-4910-4b64-8107-87083de7f8cb","subtype":"command","commandType":"auto","position":13.0,"command":"dbutils.fs.rm(\"/datasets/streamingFilesNormalMixture/\",true) // this is to delete the directory before staring a job","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res24: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511344660679,"submitTime":1511344672596,"finishTime":1511344661676,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c27cdc12-7c76-4c7c-bac1-041c20395985"},{"version":"CommandV1","origId":207871,"guid":"5108bedd-7303-4f8c-a673-20ea1a1348c1","subtype":"command","commandType":"auto","position":14.0,"command":"val r = new Random(12345L) // set seed for reproducibility\nvar a = 0;\n// for loop execution to write files to distributed fs\nfor( a <- 1 to 5){\n  // make a DataSet\n  val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}) // 100 samples from mixture\n               .coalesce(1) // this is to make sure that we have only one partition per dir\n               .toDF.as[(String,Double)]\n  val minute = (new java.text.SimpleDateFormat(\"mm\")).format(new java.util.Date())\n  val second = (new java.text.SimpleDateFormat(\"ss\")).format(new java.util.Date())\n  // write to dbfs\n  data.write.mode(SaveMode.Overwrite).csv(\"/datasets/streamingFilesNormalMixture/\" + minute +\"_\" + second)\n  Thread.sleep(5000L) // sleep 5 seconds\n}\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">r: scala.util.Random = scala.util.Random@67919852\na: Int = 0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:49: error: not enough arguments for method coalesce: (numPartitions: Int, shuffle: Boolean, partitionCoalescer: Option[org.apache.spark.rdd.PartitionCoalescer])(implicit ord: Ordering[(String, Double)])org.apache.spark.rdd.RDD[(String, Double)].\nUnspecified value parameter numPartitions.\n         val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).coalesce().toDF.as[(String,Double)]\n                                                                                                      ^\n</div>","error":null,"workflows":[],"startTime":1511346597668,"submitTime":1511346609647,"finishTime":1511346648532,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"60a43f66-d924-476c-8461-881ff4b6be46"},{"version":"CommandV1","origId":207872,"guid":"0daf83c4-153b-4213-b487-2075f68f112e","subtype":"command","commandType":"auto","position":14.5,"command":"display(dbutils.fs.ls(\"/datasets/streamingFilesNormalMixture/\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/datasets/streamingFilesNormalMixture/57_48/","57_48/",0],["dbfs:/datasets/streamingFilesNormalMixture/57_55/","57_55/",0],["dbfs:/datasets/streamingFilesNormalMixture/58_02/","58_02/",0],["dbfs:/datasets/streamingFilesNormalMixture/58_09/","58_09/",0],["dbfs:/datasets/streamingFilesNormalMixture/58_16/","58_16/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:56: error: value saveAsTextfile is not a member of org.apache.spark.sql.Dataset[Double]\n       data.saveAsTextfile(&quot;/datasets/streamingFiles/a&quot;)\n            ^\n</div>","error":null,"workflows":[],"startTime":1511344718618,"submitTime":1511344730571,"finishTime":1511344721268,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31573b0c-93bc-459d-afe1-4e70df114bfc"},{"version":"CommandV1","origId":207892,"guid":"7fd6ce7c-4e27-4d37-b062-71d410218fa3","subtype":"command","commandType":"auto","position":14.5625,"command":"display(dbutils.fs.ls(\"/datasets/streamingFilesNormalMixture/57_48/\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/datasets/streamingFilesNormalMixture/57_48/_SUCCESS","_SUCCESS",0],["dbfs:/datasets/streamingFilesNormalMixture/57_48/_committed_3065630503555994154","_committed_3065630503555994154",109],["dbfs:/datasets/streamingFilesNormalMixture/57_48/_started_3065630503555994154","_started_3065630503555994154",0],["dbfs:/datasets/streamingFilesNormalMixture/57_48/part-00000-tid-3065630503555994154-a76cadd5-380e-4fe5-a4bf-962ca479c8de-0-c000.csv","part-00000-tid-3065630503555994154-a76cadd5-380e-4fe5-a4bf-962ca479c8de-0-c000.csv",4313]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511344732295,"submitTime":1511344744247,"finishTime":1511344732694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e3cd226-3b7c-493f-9773-ebbd8dbb5953"},{"version":"CommandV1","origId":207890,"guid":"38bd928f-48d9-491e-8f59-d03962ad62f3","subtype":"command","commandType":"auto","position":14.625,"command":"%md\nTake a peek at what was written.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8114a31-2e5d-4ba9-9167-06f406d96492"},{"version":"CommandV1","origId":207873,"guid":"af56a886-e087-479c-9032-7e7917c8c246","subtype":"command","commandType":"auto","position":14.75,"command":"val df_csv = spark.read.option(\"inferSchema\", \"true\").csv(\"/datasets/streamingFilesNormalMixture/57_48/*.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df_csv: org.apache.spark.sql.DataFrame = [_c0: timestamp, _c1: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:54: error: value read is not a member of org.apache.spark.SparkContext\n       val df_csv = sc.read.option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/datasets/streamingFiles/a.csv&quot;)\n                       ^\n</div>","error":null,"workflows":[],"startTime":1511344766886,"submitTime":1511344778841,"finishTime":1511344770424,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"807947d4-89e2-485d-8d09-c95ea9e58042"},{"version":"CommandV1","origId":207893,"guid":"781e6d9c-f72d-4f35-bd31-eccb772040d6","subtype":"command","commandType":"auto","position":14.8125,"command":"df_csv.count() // 100 samples per file","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res28: Long = 100\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511344774516,"submitTime":1511344786473,"finishTime":1511344774803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c7d1329-886b-4fd9-82cb-4c1451ef153e"},{"version":"CommandV1","origId":207874,"guid":"7f1b1c15-6d63-4d29-ae35-b95f8c326ffa","subtype":"command","commandType":"auto","position":14.875,"command":"df_csv.show(10,false) // first 10","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------------+---------------------+\n|_c0                    |_c1                  |\n+-----------------------+---------------------+\n|2017-11-22 09:57:48.039|0.2576188264990721   |\n|2017-11-22 09:57:48.044|-0.13149698512045327 |\n|2017-11-22 09:57:48.049|1.4139063973267458   |\n|2017-11-22 09:57:48.054|-0.023833875968513496|\n|2017-11-22 09:57:48.059|0.7274784426774964   |\n|2017-11-22 09:57:48.064|-1.0658630481235276  |\n|2017-11-22 09:57:48.069|0.746959841932221    |\n|2017-11-22 09:57:48.075|0.30477096247050206  |\n|2017-11-22 09:57:48.08 |-0.06407620682061621 |\n|2017-11-22 09:57:48.085|1.8464307210258604   |\n+-----------------------+---------------------+\nonly showing top 10 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511344783816,"submitTime":1511344795772,"finishTime":1511344784121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4234656-8973-410a-811a-81fa2af82a87"}],"dashboards":[],"guid":"5c0d48df-4d53-436f-8aa8-0e28c85648f5","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
