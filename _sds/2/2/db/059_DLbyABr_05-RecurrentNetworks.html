<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>059_DLbyABr_05-RecurrentNetworks - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":false,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"class-node","description":"Class Node","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"class-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":false,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"class-node","spark_version":"3.5.x-scala2.11","num_workers":8,"autoscale":null,"aws_attributes":{"availability":"SPOT_WITH_FALLBACK","instance_profile_arn":null,"first_on_demand":5.0,"spot_bid_price_percent":100,"zone_id":"us-west-2a"},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"shouldShowCommandStatus":false,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"allowRunOnPendingClusters":true,"applications":false,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-eff9552bcb6cb65f96a0d9bb2b5123594d8a53fff456b3440fa6908f4263ef99","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0.1 RC (Scala 2.11)","packageLabel":"spark-image-bcd7a7b6247d51a673ce291722d0fee3654dfe50b5b04c8fba19b97c95f53fd5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-fc7e6ce873948365eb11f107b2b8b14ddd1311f5b95157dbc55667a7b1464708","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-00449cd26af8335b76ed4fe6a9cdbc7388977da83136f52ca90e548080270683","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-29871daabc403ee59cefd38533228f5815e3a5cece18deab18ce35ac8705e7a3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5ca78b83c7960ace704b397edc40a010fc3a75f713587d908a9296b771fb8530","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5e2a1a9d6a9d35bcd2a031a42f8d5ebdebd1f37f917cd95c861ac17578722b21","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-9c570ceec585af02b6759d89a19584bdf222b1bf6f3e0ebc700a7b4d0bf492a8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-d70218f5efeba85df5c5a4a4bd76135221e1b01728fbdeecead023e2d322bbb8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d1b81198d41215abe0c72e5ce4f56168b3b2acc6cb178e291f2bf04fd4f4be03","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-71baec97f74825bef2ca870a7520340c8f5ce25583e0b94960dd5242f2d813e0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":true,"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.67.1037","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":5000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":true,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":true,"enableCustomSpotPricing":true,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":1000,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":false,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"UNKNOWN_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"SPOT_WITH_FALLBACK","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2a","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":true,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":false,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":false,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableUserPromptForPendingRpc":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":false,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":216718,"name":"059_DLbyABr_05-RecurrentNetworks","language":"python","commands":[{"version":"CommandV1","origId":216719,"guid":"495a18bd-4a48-4059-ab18-bf5ba46f14d9","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n# [SDS-2.2, Scalable Data Science](https://lamastex.github.io/scalable-data-science/sds/2/2/)\n\nThis is used in a non-profit educational setting with kind permission of [Adam Breindel](https://www.linkedin.com/in/adbreind).\nThis is not licensed by Adam for use in a for-profit setting. Please contact Adam directly at `adbreind@gmail.com` to request or report such use cases or abuses. \nA few minor modifications and additional mathematical statistical pointers have been added by Raazesh Sainudiin when teaching PhD students in Uppsala University.\n\nPlease feel free to refer to basic concepts here:\n\n* Udacity's course on Deep Learning [https://www.udacity.com/course/deep-learning--ud730](https://www.udacity.com/course/deep-learning--ud730) by Google engineers: Arpan Chakraborty and Vincent Vanhoucke and their full video playlist:\n    * [https://www.youtube.com/watch?v=X_B9NADf2wk&index=2&list=PLAwxTw4SYaPn_OWPFT9ulXLuQrImzHfOV](https://www.youtube.com/watch?v=X_B9NADf2wk&index=2&list=PLAwxTw4SYaPn_OWPFT9ulXLuQrImzHfOV)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05d229f9-2cb2-4337-ae80-4daa58cd5d31"},{"version":"CommandV1","origId":244979,"guid":"03ba5c0b-2bb0-4e29-95c7-007ab2643df1","subtype":"command","commandType":"auto","position":0.75,"command":"%md\nArchived YouTube video of this live unedited lab-lecture:\n\n[![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/nHYXMZAHM1c/0.jpg)](https://www.youtube.com/embed/nHYXMZAHM1c?start=0&end=2465&autoplay=1) [![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/4cD8ieyHVh4/0.jpg)](https://www.youtube.com/embed/4cD8ieyHVh4?start=0&end=2353&autoplay=1)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45bdc0bf-8f41-4eed-8ab1-7a13b41676c2"},{"version":"CommandV1","origId":216720,"guid":"d3048611-073d-4129-bfd7-d171bd84b37f","subtype":"command","commandType":"auto","position":1.0,"command":"%md \n# Entering the 4th Dimension\n## Networks for Understanding Time-Oriented Patterns in Data\n\nCommon time-based problems include\n* Sequence modeling: \"What comes next?\" \n    * Likely next letter, word, phrase, category, cound, action, value\n* Sequence-to-Sequence modeling: \"What alternative sequence is a pattern match?\" (i.e., similar probability distribution)\n    * Machine translation, text-to-speech/speech-to-text, connected handwriting (specific scripts)\n    \n<img src=\"http://i.imgur.com/tnxf9gV.jpg\">","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"713f49e5-a53b-4e18-8b0a-7120589ab312"},{"version":"CommandV1","origId":216721,"guid":"cd8e40d5-8a8e-44ef-ad3e-b610edabb2c2","subtype":"command","commandType":"auto","position":2.0,"command":"%md \n### Simplified Approaches\n\n* If we know all of the sequence states and the probabilities of state transition...\n    * ... then we have a simple Markov Chain model.\n\n* If we *don't* know all of the states or probabilities (yet) but can make constraining assumptions and acquire solid information from observing (sampling) them...\n    * ... we can use a Hidden Markov Model approach.\n    \nThese approached have only limited capacity because they are effectively stateless and so have some degree of \"extreme retrograde amnesia.\"\n\n### Can we use a neural network to learn the \"next\" record in a sequence?\n\nFirst approach, using what we already know, might look like\n* Clamp input sequence to a vector of neurons in a feed-forward network\n* Learn a model on the class of the next input record\n\nLet's try it! This can work in some situations, although it's more of a setup and starting point for our next development.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"b5928488-5bad-4345-8ca8-c0d532d71e81"},{"version":"CommandV1","origId":216722,"guid":"07eb6796-9de8-4b9f-8ec5-78207311fc2e","subtype":"command","commandType":"auto","position":2.5,"command":"%md\nWe will make up a simple example of the English alphabet sequence wehere we try to predict the next alphabet from a sequence of length 3.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7fe99e6-d8d3-4a9e-8ccc-e41e20b76213"},{"version":"CommandV1","origId":216723,"guid":"0cd53924-0471-43c0-a023-8eab2c5c9a77","subtype":"command","commandType":"auto","position":3.0,"command":"alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nchar_to_int = dict((c, i) for i, c in enumerate(alphabet))\nint_to_char = dict((i, c) for i, c in enumerate(alphabet))\n\nseq_length = 3\ndataX = []\ndataY = []\nfor i in range(0, len(alphabet) - seq_length, 1):\n    seq_in = alphabet[i:i + seq_length]\n    seq_out = alphabet[i + seq_length]\n    dataX.append([char_to_int[char] for char in seq_in])\n    dataY.append(char_to_int[seq_out])\n    print (seq_in, '->', seq_out)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;ABC&apos;, &apos;-&gt;&apos;, &apos;D&apos;)\n(&apos;BCD&apos;, &apos;-&gt;&apos;, &apos;E&apos;)\n(&apos;CDE&apos;, &apos;-&gt;&apos;, &apos;F&apos;)\n(&apos;DEF&apos;, &apos;-&gt;&apos;, &apos;G&apos;)\n(&apos;EFG&apos;, &apos;-&gt;&apos;, &apos;H&apos;)\n(&apos;FGH&apos;, &apos;-&gt;&apos;, &apos;I&apos;)\n(&apos;GHI&apos;, &apos;-&gt;&apos;, &apos;J&apos;)\n(&apos;HIJ&apos;, &apos;-&gt;&apos;, &apos;K&apos;)\n(&apos;IJK&apos;, &apos;-&gt;&apos;, &apos;L&apos;)\n(&apos;JKL&apos;, &apos;-&gt;&apos;, &apos;M&apos;)\n(&apos;KLM&apos;, &apos;-&gt;&apos;, &apos;N&apos;)\n(&apos;LMN&apos;, &apos;-&gt;&apos;, &apos;O&apos;)\n(&apos;MNO&apos;, &apos;-&gt;&apos;, &apos;P&apos;)\n(&apos;NOP&apos;, &apos;-&gt;&apos;, &apos;Q&apos;)\n(&apos;OPQ&apos;, &apos;-&gt;&apos;, &apos;R&apos;)\n(&apos;PQR&apos;, &apos;-&gt;&apos;, &apos;S&apos;)\n(&apos;QRS&apos;, &apos;-&gt;&apos;, &apos;T&apos;)\n(&apos;RST&apos;, &apos;-&gt;&apos;, &apos;U&apos;)\n(&apos;STU&apos;, &apos;-&gt;&apos;, &apos;V&apos;)\n(&apos;TUV&apos;, &apos;-&gt;&apos;, &apos;W&apos;)\n(&apos;UVW&apos;, &apos;-&gt;&apos;, &apos;X&apos;)\n(&apos;VWX&apos;, &apos;-&gt;&apos;, &apos;Y&apos;)\n(&apos;WXY&apos;, &apos;-&gt;&apos;, &apos;Z&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512635536579,"submitTime":1512635536568,"finishTime":1512635536629,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"deletable":true,"editable":true},"streamStates":{},"nuid":"0e71403e-662b-489d-a5b6-e8e9a8e836e8"},{"version":"CommandV1","origId":216724,"guid":"fd3c29ee-5474-461e-9939-1d434eb6f433","subtype":"command","commandType":"auto","position":3.5,"command":"# dataX is just a reindexing of the alphabets in consecutive triplets of numbers\ndataX","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>\n[[0, 1, 2],\n [1, 2, 3],\n [2, 3, 4],\n [3, 4, 5],\n [4, 5, 6],\n [5, 6, 7],\n [6, 7, 8],\n [7, 8, 9],\n [8, 9, 10],\n [9, 10, 11],\n [10, 11, 12],\n [11, 12, 13],\n [12, 13, 14],\n [13, 14, 15],\n [14, 15, 16],\n [15, 16, 17],\n [16, 17, 18],\n [17, 18, 19],\n [18, 19, 20],\n [19, 20, 21],\n [20, 21, 22],\n [21, 22, 23],\n [22, 23, 24]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512635617347,"submitTime":1512635617336,"finishTime":1512635617421,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f3563c22-afeb-4f81-9c10-038819b582a4"},{"version":"CommandV1","origId":216725,"guid":"ad62e45e-d28f-42b4-91e6-fcb932278d39","subtype":"command","commandType":"auto","position":3.75,"command":"dataY # just a reindexing of the following alphabet after each consecutive triplet of numbers","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>\n[3,\n 4,\n 5,\n 6,\n 7,\n 8,\n 9,\n 10,\n 11,\n 12,\n 13,\n 14,\n 15,\n 16,\n 17,\n 18,\n 19,\n 20,\n 21,\n 22,\n 23,\n 24,\n 25]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1512635667165,"submitTime":1512635667154,"finishTime":1512635667196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba8c137e-b562-4fda-a577-3f941aff71bc"},{"version":"CommandV1","origId":216726,"guid":"a694af12-04c5-4a57-b7df-397f702d1c79","subtype":"command","commandType":"auto","position":4.0,"command":"%md \nTrain a network on that data:","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"e4af049d-e3c5-4d27-9174-28975d5f35b6"},{"version":"CommandV1","origId":216727,"guid":"b099c8fa-8e68-4690-a363-606d765d784b","subtype":"command","commandType":"auto","position":4.5,"command":"import numpy\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM # <- this is the Long-Short-term memory layer\nfrom keras.utils import np_utils\n\n# begin data generation ------------------------------------------\n# this is just a repeat of what we did above\nalphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nchar_to_int = dict((c, i) for i, c in enumerate(alphabet))\nint_to_char = dict((i, c) for i, c in enumerate(alphabet))\n\nseq_length = 3\ndataX = []\ndataY = []\nfor i in range(0, len(alphabet) - seq_length, 1):\n\tseq_in = alphabet[i:i + seq_length]\n\tseq_out = alphabet[i + seq_length]\n\tdataX.append([char_to_int[char] for char in seq_in])\n\tdataY.append(char_to_int[seq_out])\n\tprint (seq_in, '->', seq_out)\n# end data generation ---------------------------------------------\n\nX = numpy.reshape(dataX, (len(dataX), seq_length))\nX = X / float(len(alphabet)) # normalize the mapping of alphabets from integers into [0, 1]\ny = np_utils.to_categorical(dataY) # make the output we want to predict to be categorical\n\n# keras architecturing of a feed forward dense or fully connected Neural Network\nmodel = Sequential()\n# draw the architecture of the network given by next two lines, hint: X.shape[1] = 3, y.shape[1] = 26\nmodel.add(Dense(30, input_dim=X.shape[1], kernel_initializer='normal', activation='relu'))\nmodel.add(Dense(y.shape[1], activation='softmax'))\n\n# keras compiling and fitting\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\nmodel.fit(X, y, epochs=1000, batch_size=5, verbose=2)\n\nscores = model.evaluate(X, y)\nprint(\"Model Accuracy: %.2f \" % scores[1])\n\nfor pattern in dataX:\n\tx = numpy.reshape(pattern, (1, len(pattern)))\n\tx = x / float(len(alphabet))\n\tprediction = model.predict(x, verbose=0) # get prediction from fitted model\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tprint (seq_in, \"->\", result) # print the predicted outputs","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;ABC&apos;, &apos;-&gt;&apos;, &apos;D&apos;)\n(&apos;BCD&apos;, &apos;-&gt;&apos;, &apos;E&apos;)\n(&apos;CDE&apos;, &apos;-&gt;&apos;, &apos;F&apos;)\n(&apos;DEF&apos;, &apos;-&gt;&apos;, &apos;G&apos;)\n(&apos;EFG&apos;, &apos;-&gt;&apos;, &apos;H&apos;)\n(&apos;FGH&apos;, &apos;-&gt;&apos;, &apos;I&apos;)\n(&apos;GHI&apos;, &apos;-&gt;&apos;, &apos;J&apos;)\n(&apos;HIJ&apos;, &apos;-&gt;&apos;, &apos;K&apos;)\n(&apos;IJK&apos;, &apos;-&gt;&apos;, &apos;L&apos;)\n(&apos;JKL&apos;, &apos;-&gt;&apos;, &apos;M&apos;)\n(&apos;KLM&apos;, &apos;-&gt;&apos;, &apos;N&apos;)\n(&apos;LMN&apos;, &apos;-&gt;&apos;, &apos;O&apos;)\n(&apos;MNO&apos;, &apos;-&gt;&apos;, &apos;P&apos;)\n(&apos;NOP&apos;, &apos;-&gt;&apos;, &apos;Q&apos;)\n(&apos;OPQ&apos;, &apos;-&gt;&apos;, &apos;R&apos;)\n(&apos;PQR&apos;, &apos;-&gt;&apos;, &apos;S&apos;)\n(&apos;QRS&apos;, &apos;-&gt;&apos;, &apos;T&apos;)\n(&apos;RST&apos;, &apos;-&gt;&apos;, &apos;U&apos;)\n(&apos;STU&apos;, &apos;-&gt;&apos;, &apos;V&apos;)\n(&apos;TUV&apos;, &apos;-&gt;&apos;, &apos;W&apos;)\n(&apos;UVW&apos;, &apos;-&gt;&apos;, &apos;X&apos;)\n(&apos;VWX&apos;, &apos;-&gt;&apos;, &apos;Y&apos;)\n(&apos;WXY&apos;, &apos;-&gt;&apos;, &apos;Z&apos;)\nEpoch 1/1000\n0s - loss: 3.2624 - acc: 0.0000e+00\nEpoch 2/1000\n0s - loss: 3.2588 - acc: 0.0870\nEpoch 3/1000\n0s - loss: 3.2567 - acc: 0.0435\nEpoch 4/1000\n0s - loss: 3.2550 - acc: 0.0435\nEpoch 5/1000\n0s - loss: 3.2530 - acc: 0.0435\nEpoch 6/1000\n0s - loss: 3.2511 - acc: 0.0435\nEpoch 7/1000\n0s - loss: 3.2497 - acc: 0.0435\nEpoch 8/1000\n0s - loss: 3.2476 - acc: 0.0435\nEpoch 9/1000\n0s - loss: 3.2458 - acc: 0.0435\nEpoch 10/1000\n0s - loss: 3.2437 - acc: 0.0435\nEpoch 11/1000\n0s - loss: 3.2419 - acc: 0.0435\nEpoch 12/1000\n0s - loss: 3.2401 - acc: 0.0435\nEpoch 13/1000\n0s - loss: 3.2378 - acc: 0.0435\nEpoch 14/1000\n0s - loss: 3.2356 - acc: 0.0435\nEpoch 15/1000\n0s - loss: 3.2340 - acc: 0.0435\nEpoch 16/1000\n0s - loss: 3.2315 - acc: 0.0435\nEpoch 17/1000\n0s - loss: 3.2290 - acc: 0.0435\nEpoch 18/1000\n0s - loss: 3.2268 - acc: 0.0435\nEpoch 19/1000\n0s - loss: 3.2243 - acc: 0.0435\nEpoch 20/1000\n0s - loss: 3.2219 - acc: 0.0435\nEpoch 21/1000\n0s - loss: 3.2192 - acc: 0.0435\nEpoch 22/1000\n0s - loss: 3.2163 - acc: 0.0435\nEpoch 23/1000\n0s - loss: 3.2135 - acc: 0.0435\nEpoch 24/1000\n0s - loss: 3.2110 - acc: 0.0435\nEpoch 25/1000\n0s - loss: 3.2081 - acc: 0.0435\nEpoch 26/1000\n0s - loss: 3.2048 - acc: 0.0435\nEpoch 27/1000\n0s - loss: 3.2021 - acc: 0.0435\nEpoch 28/1000\n0s - loss: 3.1987 - acc: 0.0435\nEpoch 29/1000\n0s - loss: 3.1956 - acc: 0.0435\nEpoch 30/1000\n0s - loss: 3.1922 - acc: 0.0435\nEpoch 31/1000\n0s - loss: 3.1890 - acc: 0.0435\nEpoch 32/1000\n0s - loss: 3.1860 - acc: 0.0435\nEpoch 33/1000\n0s - loss: 3.1822 - acc: 0.0435\nEpoch 34/1000\n0s - loss: 3.1782 - acc: 0.0435\nEpoch 35/1000\n0s - loss: 3.1748 - acc: 0.0435\nEpoch 36/1000\n0s - loss: 3.1715 - acc: 0.0435\nEpoch 37/1000\n0s - loss: 3.1681 - acc: 0.0435\nEpoch 38/1000\n0s - loss: 3.1635 - acc: 0.0435\nEpoch 39/1000\n0s - loss: 3.1604 - acc: 0.0435\nEpoch 40/1000\n0s - loss: 3.1567 - acc: 0.0435\nEpoch 41/1000\n0s - loss: 3.1530 - acc: 0.0435\nEpoch 42/1000\n0s - loss: 3.1496 - acc: 0.0435\nEpoch 43/1000\n0s - loss: 3.1454 - acc: 0.0435\nEpoch 44/1000\n0s - loss: 3.1424 - acc: 0.0435\nEpoch 45/1000\n0s - loss: 3.1378 - acc: 0.0435\nEpoch 46/1000\n0s - loss: 3.1343 - acc: 0.0435\nEpoch 47/1000\n0s - loss: 3.1304 - acc: 0.0435\nEpoch 48/1000\n0s - loss: 3.1276 - acc: 0.0435\nEpoch 49/1000\n0s - loss: 3.1235 - acc: 0.0435\nEpoch 50/1000\n0s - loss: 3.1203 - acc: 0.0435\nEpoch 51/1000\n0s - loss: 3.1166 - acc: 0.0435\nEpoch 52/1000\n0s - loss: 3.1130 - acc: 0.0435\nEpoch 53/1000\n0s - loss: 3.1095 - acc: 0.0435\nEpoch 54/1000\n0s - loss: 3.1065 - acc: 0.0435\nEpoch 55/1000\n0s - loss: 3.1030 - acc: 0.0435\nEpoch 56/1000\n0s - loss: 3.0994 - acc: 0.0435\nEpoch 57/1000\n0s - loss: 3.0963 - acc: 0.0435\nEpoch 58/1000\n0s - loss: 3.0930 - acc: 0.0435\nEpoch 59/1000\n0s - loss: 3.0897 - acc: 0.0435\nEpoch 60/1000\n0s - loss: 3.0870 - acc: 0.0435\nEpoch 61/1000\n0s - loss: 3.0835 - acc: 0.0435\nEpoch 62/1000\n0s - loss: 3.0799 - acc: 0.0435\nEpoch 63/1000\n0s - loss: 3.0767 - acc: 0.0435\nEpoch 64/1000\n0s - loss: 3.0735 - acc: 0.0435\nEpoch 65/1000\n0s - loss: 3.0701 - acc: 0.0435\nEpoch 66/1000\n0s - loss: 3.0671 - acc: 0.0435\nEpoch 67/1000\n0s - loss: 3.0641 - acc: 0.0435\nEpoch 68/1000\n0s - loss: 3.0608 - acc: 0.0435\nEpoch 69/1000\n0s - loss: 3.0577 - acc: 0.0435\nEpoch 70/1000\n0s - loss: 3.0546 - acc: 0.0435\nEpoch 71/1000\n0s - loss: 3.0514 - acc: 0.0435\nEpoch 72/1000\n0s - loss: 3.0490 - acc: 0.0435\nEpoch 73/1000\n0s - loss: 3.0455 - acc: 0.0435\nEpoch 74/1000\n0s - loss: 3.0424 - acc: 0.0435\nEpoch 75/1000\n0s - loss: 3.0392 - acc: 0.0435\nEpoch 76/1000\n0s - loss: 3.0362 - acc: 0.0435\nEpoch 77/1000\n0s - loss: 3.0328 - acc: 0.0435\nEpoch 78/1000\n0s - loss: 3.0293 - acc: 0.0435\nEpoch 79/1000\n0s - loss: 3.0265 - acc: 0.0435\nEpoch 80/1000\n0s - loss: 3.0235 - acc: 0.0435\nEpoch 81/1000\n0s - loss: 3.0203 - acc: 0.0435\nEpoch 82/1000\n0s - loss: 3.0173 - acc: 0.0435\nEpoch 83/1000\n0s - loss: 3.0138 - acc: 0.0435\nEpoch 84/1000\n0s - loss: 3.0109 - acc: 0.0435\nEpoch 85/1000\n0s - loss: 3.0076 - acc: 0.0435\nEpoch 86/1000\n0s - loss: 3.0045 - acc: 0.0435\nEpoch 87/1000\n0s - loss: 3.0013 - acc: 0.0870\nEpoch 88/1000\n0s - loss: 2.9983 - acc: 0.0870\nEpoch 89/1000\n0s - loss: 2.9951 - acc: 0.0870\nEpoch 90/1000\n0s - loss: 2.9923 - acc: 0.0870\nEpoch 91/1000\n0s - loss: 2.9892 - acc: 0.0870\nEpoch 92/1000\n0s - loss: 2.9865 - acc: 0.0870\nEpoch 93/1000\n0s - loss: 2.9830 - acc: 0.0870\nEpoch 94/1000\n0s - loss: 2.9798 - acc: 0.0870\nEpoch 95/1000\n0s - loss: 2.9767 - acc: 0.0870\nEpoch 96/1000\n0s - loss: 2.9740 - acc: 0.0870\nEpoch 97/1000\n0s - loss: 2.9709 - acc: 0.0870\nEpoch 98/1000\n0s - loss: 2.9675 - acc: 0.0870\nEpoch 99/1000\n0s - loss: 2.9647 - acc: 0.0870\nEpoch 100/1000\n0s - loss: 2.9615 - acc: 0.0870\nEpoch 101/1000\n0s - loss: 2.9588 - acc: 0.0870\nEpoch 102/1000\n0s - loss: 2.9559 - acc: 0.0870\nEpoch 103/1000\n0s - loss: 2.9527 - acc: 0.0870\nEpoch 104/1000\n0s - loss: 2.9497 - acc: 0.0870\nEpoch 105/1000\n0s - loss: 2.9463 - acc: 0.0870\nEpoch 106/1000\n0s - loss: 2.9433 - acc: 0.0870\nEpoch 107/1000\n0s - loss: 2.9399 - acc: 0.0870\nEpoch 108/1000\n0s - loss: 2.9374 - acc: 0.0870\nEpoch 109/1000\n0s - loss: 2.9344 - acc: 0.0870\nEpoch 110/1000\n0s - loss: 2.9311 - acc: 0.0870\nEpoch 111/1000\n0s - loss: 2.9283 - acc: 0.0870\nEpoch 112/1000\n0s - loss: 2.9253 - acc: 0.0870\nEpoch 113/1000\n0s - loss: 2.9225 - acc: 0.0870\nEpoch 114/1000\n0s - loss: 2.9196 - acc: 0.0870\nEpoch 115/1000\n0s - loss: 2.9162 - acc: 0.1304\nEpoch 116/1000\n0s - loss: 2.9135 - acc: 0.1304\nEpoch 117/1000\n0s - loss: 2.9105 - acc: 0.1739\nEpoch 118/1000\n0s - loss: 2.9076 - acc: 0.1304\nEpoch 119/1000\n0s - loss: 2.9044 - acc: 0.1304\nEpoch 120/1000\n0s - loss: 2.9014 - acc: 0.1304\nEpoch 121/1000\n0s - loss: 2.8985 - acc: 0.1304\nEpoch 122/1000\n0s - loss: 2.8957 - acc: 0.1304\nEpoch 123/1000\n0s - loss: 2.8923 - acc: 0.1304\nEpoch 124/1000\n0s - loss: 2.8895 - acc: 0.0870\nEpoch 125/1000\n0s - loss: 2.8866 - acc: 0.0870\nEpoch 126/1000\n0s - loss: 2.8835 - acc: 0.0870\nEpoch 127/1000\n0s - loss: 2.8804 - acc: 0.0870\nEpoch 128/1000\n0s - loss: 2.8775 - acc: 0.0870\nEpoch 129/1000\n0s - loss: 2.8745 - acc: 0.0870\nEpoch 130/1000\n0s - loss: 2.8713 - acc: 0.0870\nEpoch 131/1000\n0s - loss: 2.8685 - acc: 0.0870\nEpoch 132/1000\n0s - loss: 2.8654 - acc: 0.0870\nEpoch 133/1000\n0s - loss: 2.8624 - acc: 0.0870\nEpoch 134/1000\n0s - loss: 2.8596 - acc: 0.0870\nEpoch 135/1000\n0s - loss: 2.8565 - acc: 0.0870\nEpoch 136/1000\n0s - loss: 2.8538 - acc: 0.0870\nEpoch 137/1000\n0s - loss: 2.8507 - acc: 0.0870\nEpoch 138/1000\n0s - loss: 2.8473 - acc: 0.0870\nEpoch 139/1000\n0s - loss: 2.8446 - acc: 0.0870\nEpoch 140/1000\n0s - loss: 2.8417 - acc: 0.0870\nEpoch 141/1000\n0s - loss: 2.8385 - acc: 0.0870\nEpoch 142/1000\n0s - loss: 2.8353 - acc: 0.0870\nEpoch 143/1000\n0s - loss: 2.8326 - acc: 0.0870\nEpoch 144/1000\n0s - loss: 2.8291 - acc: 0.0870\nEpoch 145/1000\n0s - loss: 2.8263 - acc: 0.0870\nEpoch 146/1000\n0s - loss: 2.8229 - acc: 0.0870\nEpoch 147/1000\n0s - loss: 2.8201 - acc: 0.0870\nEpoch 148/1000\n0s - loss: 2.8179 - acc: 0.0870\nEpoch 149/1000\n0s - loss: 2.8142 - acc: 0.0870\nEpoch 150/1000\n0s - loss: 2.8108 - acc: 0.0870\nEpoch 151/1000\n0s - loss: 2.8082 - acc: 0.0870\nEpoch 152/1000\n0s - loss: 2.8055 - acc: 0.0870\nEpoch 153/1000\n0s - loss: 2.8024 - acc: 0.0870\nEpoch 154/1000\n0s - loss: 2.7995 - acc: 0.0870\nEpoch 155/1000\n0s - loss: 2.7967 - acc: 0.0870\nEpoch 156/1000\n0s - loss: 2.7938 - acc: 0.0870\nEpoch 157/1000\n0s - loss: 2.7910 - acc: 0.0870\nEpoch 158/1000\n0s - loss: 2.7879 - acc: 0.0870\nEpoch 159/1000\n0s - loss: 2.7853 - acc: 0.0870\nEpoch 160/1000\n0s - loss: 2.7828 - acc: 0.0870\nEpoch 161/1000\n0s - loss: 2.7799 - acc: 0.0870\nEpoch 162/1000\n0s - loss: 2.7766 - acc: 0.0870\nEpoch 163/1000\n0s - loss: 2.7738 - acc: 0.0870\nEpoch 164/1000\n0s - loss: 2.7714 - acc: 0.1304\nEpoch 165/1000\n0s - loss: 2.7685 - acc: 0.1739\nEpoch 166/1000\n0s - loss: 2.7660 - acc: 0.1304\nEpoch 167/1000\n0s - loss: 2.7627 - acc: 0.1304\nEpoch 168/1000\n0s - loss: 2.7603 - acc: 0.1304\nEpoch 169/1000\n0s - loss: 2.7572 - acc: 0.1304\nEpoch 170/1000\n0s - loss: 2.7547 - acc: 0.1304\nEpoch 171/1000\n0s - loss: 2.7518 - acc: 0.1304\nEpoch 172/1000\n0s - loss: 2.7489 - acc: 0.1304\nEpoch 173/1000\n0s - loss: 2.7467 - acc: 0.1304\nEpoch 174/1000\n0s - loss: 2.7436 - acc: 0.1304\nEpoch 175/1000\n0s - loss: 2.7410 - acc: 0.1304\nEpoch 176/1000\n0s - loss: 2.7383 - acc: 0.0870\nEpoch 177/1000\n0s - loss: 2.7362 - acc: 0.0870\nEpoch 178/1000\n0s - loss: 2.7329 - acc: 0.0870\nEpoch 179/1000\n0s - loss: 2.7304 - acc: 0.0870\nEpoch 180/1000\n0s - loss: 2.7282 - acc: 0.0870\nEpoch 181/1000\n0s - loss: 2.7259 - acc: 0.1304\nEpoch 182/1000\n0s - loss: 2.7230 - acc: 0.1304\nEpoch 183/1000\n0s - loss: 2.7206 - acc: 0.0870\nEpoch 184/1000\n0s - loss: 2.7175 - acc: 0.0870\nEpoch 185/1000\n0s - loss: 2.7152 - acc: 0.0870\nEpoch 186/1000\n0s - loss: 2.7124 - acc: 0.1304\nEpoch 187/1000\n0s - loss: 2.7097 - acc: 0.1304\nEpoch 188/1000\n0s - loss: 2.7073 - acc: 0.1304\nEpoch 189/1000\n0s - loss: 2.7052 - acc: 0.1739\nEpoch 190/1000\n0s - loss: 2.7024 - acc: 0.1304\nEpoch 191/1000\n0s - loss: 2.6999 - acc: 0.1739\nEpoch 192/1000\n0s - loss: 2.6977 - acc: 0.1304\nEpoch 193/1000\n0s - loss: 2.6950 - acc: 0.1304\nEpoch 194/1000\n0s - loss: 2.6928 - acc: 0.1304\nEpoch 195/1000\n0s - loss: 2.6896 - acc: 0.1304\nEpoch 196/1000\n0s - loss: 2.6871 - acc: 0.1304\nEpoch 197/1000\n0s - loss: 2.6847 - acc: 0.1304\nEpoch 198/1000\n0s - loss: 2.6822 - acc: 0.1304\nEpoch 199/1000\n0s - loss: 2.6796 - acc: 0.1304\nEpoch 200/1000\n0s - loss: 2.6775 - acc: 0.1304\nEpoch 201/1000\n0s - loss: 2.6752 - acc: 0.1304\nEpoch 202/1000\n0s - loss: 2.6724 - acc: 0.1304\nEpoch 203/1000\n0s - loss: 2.6698 - acc: 0.1304\nEpoch 204/1000\n0s - loss: 2.6674 - acc: 0.1304\nEpoch 205/1000\n0s - loss: 2.6647 - acc: 0.1304\nEpoch 206/1000\n0s - loss: 2.6627 - acc: 0.1304\nEpoch 207/1000\n0s - loss: 2.6602 - acc: 0.1304\nEpoch 208/1000\n0s - loss: 2.6579 - acc: 0.1304\nEpoch 209/1000\n0s - loss: 2.6554 - acc: 0.1304\nEpoch 210/1000\n0s - loss: 2.6532 - acc: 0.1304\nEpoch 211/1000\n0s - loss: 2.6505 - acc: 0.1304\nEpoch 212/1000\n0s - loss: 2.6480 - acc: 0.1304\nEpoch 213/1000\n0s - loss: 2.6456 - acc: 0.1304\nEpoch 214/1000\n0s - loss: 2.6432 - acc: 0.1304\nEpoch 215/1000\n0s - loss: 2.6408 - acc: 0.1304\nEpoch 216/1000\n0s - loss: 2.6386 - acc: 0.1739\nEpoch 217/1000\n0s - loss: 2.6359 - acc: 0.1739\nEpoch 218/1000\n0s - loss: 2.6337 - acc: 0.1739\nEpoch 219/1000\n0s - loss: 2.6314 - acc: 0.1739\nEpoch 220/1000\n0s - loss: 2.6293 - acc: 0.1739\nEpoch 221/1000\n0s - loss: 2.6269 - acc: 0.1739\nEpoch 222/1000\n0s - loss: 2.6246 - acc: 0.1739\nEpoch 223/1000\n0s - loss: 2.6223 - acc: 0.1739\nEpoch 224/1000\n0s - loss: 2.6198 - acc: 0.1304\nEpoch 225/1000\n0s - loss: 2.6177 - acc: 0.1739\nEpoch 226/1000\n0s - loss: 2.6155 - acc: 0.1739\nEpoch 227/1000\n0s - loss: 2.6136 - acc: 0.1739\nEpoch 228/1000\n0s - loss: 2.6108 - acc: 0.1739\nEpoch 229/1000\n0s - loss: 2.6092 - acc: 0.1739\nEpoch 230/1000\n0s - loss: 2.6070 - acc: 0.1739\nEpoch 231/1000\n0s - loss: 2.6045 - acc: 0.1739\nEpoch 232/1000\n0s - loss: 2.6021 - acc: 0.1739\nEpoch 233/1000\n0s - loss: 2.6003 - acc: 0.1739\nEpoch 234/1000\n0s - loss: 2.5978 - acc: 0.1739\nEpoch 235/1000\n0s - loss: 2.5960 - acc: 0.1739\nEpoch 236/1000\n0s - loss: 2.5937 - acc: 0.1739\nEpoch 237/1000\n0s - loss: 2.5920 - acc: 0.1739\nEpoch 238/1000\n0s - loss: 2.5894 - acc: 0.1739\nEpoch 239/1000\n0s - loss: 2.5871 - acc: 0.1739\nEpoch 240/1000\n0s - loss: 2.5854 - acc: 0.1739\nEpoch 241/1000\n0s - loss: 2.5832 - acc: 0.1739\nEpoch 242/1000\n0s - loss: 2.5810 - acc: 0.1739\nEpoch 243/1000\n0s - loss: 2.5787 - acc: 0.1739\nEpoch 244/1000\n0s - loss: 2.5770 - acc: 0.1739\nEpoch 245/1000\n0s - loss: 2.5747 - acc: 0.1739\nEpoch 246/1000\n0s - loss: 2.5721 - acc: 0.1739\nEpoch 247/1000\n0s - loss: 2.5708 - acc: 0.1739\nEpoch 248/1000\n0s - loss: 2.5681 - acc: 0.1739\nEpoch 249/1000\n0s - loss: 2.5668 - acc: 0.1739\nEpoch 250/1000\n0s - loss: 2.5642 - acc: 0.1739\nEpoch 251/1000\n0s - loss: 2.5622 - acc: 0.1739\nEpoch 252/1000\n0s - loss: 2.5600 - acc: 0.1739\nEpoch 253/1000\n0s - loss: 2.5581 - acc: 0.1739\nEpoch 254/1000\n0s - loss: 2.5564 - acc: 0.2174\nEpoch 255/1000\n0s - loss: 2.5544 - acc: 0.2174\nEpoch 256/1000\n0s - loss: 2.5523 - acc: 0.2174\nEpoch 257/1000\n0s - loss: 2.5508 - acc: 0.2174\nEpoch 258/1000\n0s - loss: 2.5485 - acc: 0.2174\nEpoch 259/1000\n0s - loss: 2.5466 - acc: 0.2174\nEpoch 260/1000\n0s - loss: 2.5444 - acc: 0.2174\nEpoch 261/1000\n0s - loss: 2.5428 - acc: 0.2174\nEpoch 262/1000\n0s - loss: 2.5406 - acc: 0.2174\nEpoch 263/1000\n0s - loss: 2.5387 - acc: 0.2174\nEpoch 264/1000\n0s - loss: 2.5365 - acc: 0.2174\nEpoch 265/1000\n0s - loss: 2.5347 - acc: 0.2174\nEpoch 266/1000\n0s - loss: 2.5330 - acc: 0.2174\nEpoch 267/1000\n0s - loss: 2.5310 - acc: 0.2174\nEpoch 268/1000\n0s - loss: 2.5297 - acc: 0.2174\nEpoch 269/1000\n0s - loss: 2.5271 - acc: 0.2174\nEpoch 270/1000\n0s - loss: 2.5254 - acc: 0.2174\nEpoch 271/1000\n0s - loss: 2.5237 - acc: 0.2174\nEpoch 272/1000\n0s - loss: 2.5223 - acc: 0.2174\nEpoch 273/1000\n0s - loss: 2.5204 - acc: 0.2174\nEpoch 274/1000\n0s - loss: 2.5179 - acc: 0.2174\nEpoch 275/1000\n0s - loss: 2.5167 - acc: 0.2174\nEpoch 276/1000\n0s - loss: 2.5141 - acc: 0.2174\nEpoch 277/1000\n0s - loss: 2.5126 - acc: 0.2174\nEpoch 278/1000\n0s - loss: 2.5111 - acc: 0.2174\nEpoch 279/1000\n0s - loss: 2.5091 - acc: 0.2174\nEpoch 280/1000\n0s - loss: 2.5070 - acc: 0.2174\nEpoch 281/1000\n0s - loss: 2.5056 - acc: 0.2174\nEpoch 282/1000\n0s - loss: 2.5036 - acc: 0.2174\nEpoch 283/1000\n0s - loss: 2.5014 - acc: 0.2174\nEpoch 284/1000\n0s - loss: 2.4996 - acc: 0.2174\nEpoch 285/1000\n0s - loss: 2.4982 - acc: 0.2174\nEpoch 286/1000\n0s - loss: 2.4966 - acc: 0.2174\nEpoch 287/1000\n0s - loss: 2.4946 - acc: 0.2174\nEpoch 288/1000\n0s - loss: 2.4923 - acc: 0.1739\nEpoch 289/1000\n0s - loss: 2.4907 - acc: 0.1739\nEpoch 290/1000\n0s - loss: 2.4894 - acc: 0.1739\nEpoch 291/1000\n0s - loss: 2.4879 - acc: 0.1739\nEpoch 292/1000\n0s - loss: 2.4856 - acc: 0.1739\nEpoch 293/1000\n0s - loss: 2.4839 - acc: 0.1739\nEpoch 294/1000\n0s - loss: 2.4820 - acc: 0.1739\nEpoch 295/1000\n0s - loss: 2.4807 - acc: 0.1739\nEpoch 296/1000\n0s - loss: 2.4788 - acc: 0.1739\nEpoch 297/1000\n0s - loss: 2.4772 - acc: 0.1739\nEpoch 298/1000\n0s - loss: 2.4754 - acc: 0.1739\nEpoch 299/1000\n0s - loss: 2.4737 - acc: 0.1739\nEpoch 300/1000\n0s - loss: 2.4719 - acc: 0.1739\nEpoch 301/1000\n0s - loss: 2.4706 - acc: 0.1739\nEpoch 302/1000\n0s - loss: 2.4682 - acc: 0.1739\nEpoch 303/1000\n0s - loss: 2.4666 - acc: 0.1739\nEpoch 304/1000\n0s - loss: 2.4652 - acc: 0.1739\nEpoch 305/1000\n0s - loss: 2.4635 - acc: 0.1739\nEpoch 306/1000\n0s - loss: 2.4616 - acc: 0.2174\nEpoch 307/1000\n0s - loss: 2.4603 - acc: 0.1739\nEpoch 308/1000\n0s - loss: 2.4585 - acc: 0.2174\nEpoch 309/1000\n0s - loss: 2.4568 - acc: 0.1739\nEpoch 310/1000\n0s - loss: 2.4551 - acc: 0.1739\nEpoch 311/1000\n0s - loss: 2.4528 - acc: 0.1739\nEpoch 312/1000\n0s - loss: 2.4524 - acc: 0.2174\nEpoch 313/1000\n0s - loss: 2.4498 - acc: 0.1739\nEpoch 314/1000\n0s - loss: 2.4485 - acc: 0.1739\nEpoch 315/1000\n0s - loss: 2.4466 - acc: 0.2174\nEpoch 316/1000\n0s - loss: 2.4454 - acc: 0.1739\nEpoch 317/1000\n0s - loss: 2.4444 - acc: 0.1739\nEpoch 318/1000\n0s - loss: 2.4424 - acc: 0.1739\nEpoch 319/1000\n0s - loss: 2.4408 - acc: 0.1739\nEpoch 320/1000\n0s - loss: 2.4390 - acc: 0.1739\nEpoch 321/1000\n0s - loss: 2.4376 - acc: 0.1739\nEpoch 322/1000\n0s - loss: 2.4364 - acc: 0.1739\nEpoch 323/1000\n0s - loss: 2.4343 - acc: 0.1739\nEpoch 324/1000\n0s - loss: 2.4327 - acc: 0.1739\nEpoch 325/1000\n0s - loss: 2.4312 - acc: 0.1739\nEpoch 326/1000\n0s - loss: 2.4298 - acc: 0.1739\nEpoch 327/1000\n0s - loss: 2.4283 - acc: 0.1739\nEpoch 328/1000\n0s - loss: 2.4266 - acc: 0.1739\nEpoch 329/1000\n0s - loss: 2.4253 - acc: 0.1739\nEpoch 330/1000\n0s - loss: 2.4232 - acc: 0.1739\nEpoch 331/1000\n0s - loss: 2.4220 - acc: 0.1739\nEpoch 332/1000\n0s - loss: 2.4200 - acc: 0.2174\nEpoch 333/1000\n0s - loss: 2.4190 - acc: 0.2174\nEpoch 334/1000\n0s - loss: 2.4172 - acc: 0.2174\nEpoch 335/1000\n0s - loss: 2.4154 - acc: 0.1739\nEpoch 336/1000\n0s - loss: 2.4139 - acc: 0.1739\nEpoch 337/1000\n0s - loss: 2.4118 - acc: 0.1739\nEpoch 338/1000\n0s - loss: 2.4110 - acc: 0.1739\nEpoch 339/1000\n0s - loss: 2.4099 - acc: 0.2174\nEpoch 340/1000\n0s - loss: 2.4083 - acc: 0.2174\nEpoch 341/1000\n0s - loss: 2.4074 - acc: 0.2174\nEpoch 342/1000\n0s - loss: 2.4052 - acc: 0.2174\nEpoch 343/1000\n0s - loss: 2.4037 - acc: 0.1739\nEpoch 344/1000\n0s - loss: 2.4022 - acc: 0.1739\nEpoch 345/1000\n0s - loss: 2.4004 - acc: 0.1739\nEpoch 346/1000\n0s - loss: 2.3993 - acc: 0.1739\nEpoch 347/1000\n0s - loss: 2.3976 - acc: 0.1739\nEpoch 348/1000\n0s - loss: 2.3963 - acc: 0.1739\nEpoch 349/1000\n0s - loss: 2.3946 - acc: 0.2174\nEpoch 350/1000\n0s - loss: 2.3935 - acc: 0.2174\nEpoch 351/1000\n0s - loss: 2.3914 - acc: 0.2174\nEpoch 352/1000\n0s - loss: 2.3906 - acc: 0.2174\nEpoch 353/1000\n0s - loss: 2.3887 - acc: 0.2174\nEpoch 354/1000\n0s - loss: 2.3873 - acc: 0.2174\nEpoch 355/1000\n0s - loss: 2.3860 - acc: 0.2174\nEpoch 356/1000\n0s - loss: 2.3842 - acc: 0.2174\nEpoch 357/1000\n0s - loss: 2.3826 - acc: 0.2609\nEpoch 358/1000\n0s - loss: 2.3818 - acc: 0.2609\nEpoch 359/1000\n0s - loss: 2.3798 - acc: 0.2609\nEpoch 360/1000\n0s - loss: 2.3784 - acc: 0.2609\nEpoch 361/1000\n0s - loss: 2.3770 - acc: 0.2609\nEpoch 362/1000\n0s - loss: 2.3759 - acc: 0.2609\nEpoch 363/1000\n0s - loss: 2.3744 - acc: 0.2174\nEpoch 364/1000\n0s - loss: 2.3731 - acc: 0.2174\nEpoch 365/1000\n0s - loss: 2.3716 - acc: 0.2609\nEpoch 366/1000\n0s - loss: 2.3702 - acc: 0.2609\nEpoch 367/1000\n0s - loss: 2.3686 - acc: 0.2609\nEpoch 368/1000\n0s - loss: 2.3670 - acc: 0.2609\nEpoch 369/1000\n0s - loss: 2.3654 - acc: 0.2174\nEpoch 370/1000\n0s - loss: 2.3644 - acc: 0.2174\nEpoch 371/1000\n0s - loss: 2.3634 - acc: 0.2174\nEpoch 372/1000\n0s - loss: 2.3614 - acc: 0.2174\nEpoch 373/1000\n0s - loss: 2.3602 - acc: 0.2174\nEpoch 374/1000\n0s - loss: 2.3582 - acc: 0.2174\nEpoch 375/1000\n0s - loss: 2.3569 - acc: 0.2174\nEpoch 376/1000\n0s - loss: 2.3562 - acc: 0.2174\nEpoch 377/1000\n0s - loss: 2.3547 - acc: 0.2609\nEpoch 378/1000\n0s - loss: 2.3533 - acc: 0.2609\nEpoch 379/1000\n0s - loss: 2.3515 - acc: 0.2609\nEpoch 380/1000\n0s - loss: 2.3502 - acc: 0.2609\nEpoch 381/1000\n0s - loss: 2.3493 - acc: 0.2609\nEpoch 382/1000\n0s - loss: 2.3479 - acc: 0.3043\nEpoch 383/1000\n0s - loss: 2.3465 - acc: 0.3043\nEpoch 384/1000\n0s - loss: 2.3452 - acc: 0.3043\nEpoch 385/1000\n0s - loss: 2.3437 - acc: 0.3043\nEpoch 386/1000\n0s - loss: 2.3424 - acc: 0.3043\nEpoch 387/1000\n0s - loss: 2.3405 - acc: 0.3043\nEpoch 388/1000\n0s - loss: 2.3390 - acc: 0.3043\nEpoch 389/1000\n0s - loss: 2.3383 - acc: 0.3043\nEpoch 390/1000\n0s - loss: 2.3369 - acc: 0.3043\nEpoch 391/1000\n0s - loss: 2.3357 - acc: 0.3043\nEpoch 392/1000\n0s - loss: 2.3344 - acc: 0.2609\nEpoch 393/1000\n0s - loss: 2.3326 - acc: 0.2609\nEpoch 394/1000\n0s - loss: 2.3316 - acc: 0.2609\nEpoch 395/1000\n0s - loss: 2.3301 - acc: 0.2609\nEpoch 396/1000\n0s - loss: 2.3288 - acc: 0.2609\nEpoch 397/1000\n0s - loss: 2.3276 - acc: 0.3043\nEpoch 398/1000\n0s - loss: 2.3263 - acc: 0.3043\nEpoch 399/1000\n0s - loss: 2.3249 - acc: 0.3043\nEpoch 400/1000\n0s - loss: 2.3234 - acc: 0.3043\nEpoch 401/1000\n0s - loss: 2.3221 - acc: 0.3043\nEpoch 402/1000\n0s - loss: 2.3213 - acc: 0.3043\nEpoch 403/1000\n0s - loss: 2.3196 - acc: 0.3043\nEpoch 404/1000\n0s - loss: 2.3182 - acc: 0.3043\nEpoch 405/1000\n0s - loss: 2.3174 - acc: 0.3043\nEpoch 406/1000\n0s - loss: 2.3158 - acc: 0.2609\nEpoch 407/1000\n0s - loss: 2.3151 - acc: 0.2609\nEpoch 408/1000\n0s - loss: 2.3132 - acc: 0.2609\nEpoch 409/1000\n0s - loss: 2.3123 - acc: 0.2609\nEpoch 410/1000\n0s - loss: 2.3108 - acc: 0.3043\nEpoch 411/1000\n0s - loss: 2.3092 - acc: 0.3043\nEpoch 412/1000\n0s - loss: 2.3085 - acc: 0.3043\nEpoch 413/1000\n0s - loss: 2.3072 - acc: 0.3043\nEpoch 414/1000\n0s - loss: 2.3061 - acc: 0.3043\nEpoch 415/1000\n0s - loss: 2.3045 - acc: 0.2609\nEpoch 416/1000\n0s - loss: 2.3028 - acc: 0.2609\nEpoch 417/1000\n0s - loss: 2.3017 - acc: 0.2609\nEpoch 418/1000\n0s - loss: 2.3003 - acc: 0.2609\nEpoch 419/1000\n0s - loss: 2.2998 - acc: 0.2174\nEpoch 420/1000\n0s - loss: 2.2984 - acc: 0.2174\nEpoch 421/1000\n0s - loss: 2.2968 - acc: 0.2609\nEpoch 422/1000\n0s - loss: 2.2960 - acc: 0.2609\nEpoch 423/1000\n0s - loss: 2.2946 - acc: 0.2174\nEpoch 424/1000\n0s - loss: 2.2931 - acc: 0.2174\nEpoch 425/1000\n0s - loss: 2.2921 - acc: 0.2174\nEpoch 426/1000\n0s - loss: 2.2905 - acc: 0.2609\nEpoch 427/1000\n0s - loss: 2.2896 - acc: 0.3043\nEpoch 428/1000\n0s - loss: 2.2880 - acc: 0.3043\nEpoch 429/1000\n0s - loss: 2.2873 - acc: 0.3043\nEpoch 430/1000\n0s - loss: 2.2859 - acc: 0.3043\nEpoch 431/1000\n0s - loss: 2.2847 - acc: 0.3043\nEpoch 432/1000\n0s - loss: 2.2835 - acc: 0.3043\nEpoch 433/1000\n0s - loss: 2.2822 - acc: 0.3043\nEpoch 434/1000\n0s - loss: 2.2810 - acc: 0.3043\nEpoch 435/1000\n0s - loss: 2.2802 - acc: 0.3043\nEpoch 436/1000\n0s - loss: 2.2786 - acc: 0.3043\nEpoch 437/1000\n0s - loss: 2.2775 - acc: 0.3043\nEpoch 438/1000\n0s - loss: 2.2765 - acc: 0.3043\nEpoch 439/1000\n0s - loss: 2.2753 - acc: 0.3043\nEpoch 440/1000\n0s - loss: 2.2744 - acc: 0.3043\nEpoch 441/1000\n0s - loss: 2.2725 - acc: 0.3043\nEpoch 442/1000\n0s - loss: 2.2711 - acc: 0.3043\nEpoch 443/1000\n0s - loss: 2.2703 - acc: 0.3043\nEpoch 444/1000\n0s - loss: 2.2684 - acc: 0.3043\nEpoch 445/1000\n0s - loss: 2.2682 - acc: 0.3043\nEpoch 446/1000\n0s - loss: 2.2669 - acc: 0.3043\nEpoch 447/1000\n0s - loss: 2.2654 - acc: 0.3043\nEpoch 448/1000\n0s - loss: 2.2640 - acc: 0.3043\nEpoch 449/1000\n0s - loss: 2.2633 - acc: 0.3043\nEpoch 450/1000\n0s - loss: 2.2618 - acc: 0.3043\nEpoch 451/1000\n0s - loss: 2.2609 - acc: 0.3043\nEpoch 452/1000\n0s - loss: 2.2600 - acc: 0.3043\nEpoch 453/1000\n0s - loss: 2.2585 - acc: 0.3043\nEpoch 454/1000\n0s - loss: 2.2567 - acc: 0.3043\nEpoch 455/1000\n0s - loss: 2.2559 - acc: 0.3043\nEpoch 456/1000\n0s - loss: 2.2548 - acc: 0.3043\nEpoch 457/1000\n0s - loss: 2.2535 - acc: 0.3043\nEpoch 458/1000\n0s - loss: 2.2531 - acc: 0.3478\nEpoch 459/1000\n0s - loss: 2.2513 - acc: 0.3043\nEpoch 460/1000\n0s - loss: 2.2503 - acc: 0.3043\nEpoch 461/1000\n0s - loss: 2.2488 - acc: 0.3043\nEpoch 462/1000\n0s - loss: 2.2475 - acc: 0.3478\nEpoch 463/1000\n0s - loss: 2.2470 - acc: 0.3478\nEpoch 464/1000\n0s - loss: 2.2461 - acc: 0.3478\nEpoch 465/1000\n0s - loss: 2.2447 - acc: 0.3478\nEpoch 466/1000\n0s - loss: 2.2439 - acc: 0.3478\nEpoch 467/1000\n0s - loss: 2.2427 - acc: 0.3478\nEpoch 468/1000\n0s - loss: 2.2410 - acc: 0.3478\nEpoch 469/1000\n0s - loss: 2.2402 - acc: 0.3478\nEpoch 470/1000\n0s - loss: 2.2393 - acc: 0.3478\nEpoch 471/1000\n0s - loss: 2.2380 - acc: 0.3478\nEpoch 472/1000\n0s - loss: 2.2371 - acc: 0.3478\nEpoch 473/1000\n0s - loss: 2.2356 - acc: 0.3478\nEpoch 474/1000\n0s - loss: 2.2343 - acc: 0.3478\nEpoch 475/1000\n0s - loss: 2.2337 - acc: 0.3478\nEpoch 476/1000\n0s - loss: 2.2322 - acc: 0.3913\nEpoch 477/1000\n0s - loss: 2.2308 - acc: 0.3913\nEpoch 478/1000\n0s - loss: 2.2293 - acc: 0.3913\nEpoch 479/1000\n0s - loss: 2.2289 - acc: 0.3913\nEpoch 480/1000\n0s - loss: 2.2280 - acc: 0.3913\nEpoch 481/1000\n0s - loss: 2.2265 - acc: 0.3913\nEpoch 482/1000\n0s - loss: 2.2259 - acc: 0.3913\nEpoch 483/1000\n0s - loss: 2.2240 - acc: 0.3913\nEpoch 484/1000\n0s - loss: 2.2233 - acc: 0.3913\nEpoch 485/1000\n0s - loss: 2.2217 - acc: 0.3913\nEpoch 486/1000\n0s - loss: 2.2209 - acc: 0.3913\nEpoch 487/1000\n0s - loss: 2.2196 - acc: 0.3913\nEpoch 488/1000\n0s - loss: 2.2183 - acc: 0.3913\nEpoch 489/1000\n0s - loss: 2.2173 - acc: 0.3913\nEpoch 490/1000\n0s - loss: 2.2157 - acc: 0.3913\nEpoch 491/1000\n0s - loss: 2.2158 - acc: 0.3913\nEpoch 492/1000\n0s - loss: 2.2143 - acc: 0.3478\nEpoch 493/1000\n0s - loss: 2.2131 - acc: 0.3478\nEpoch 494/1000\n0s - loss: 2.2120 - acc: 0.3478\nEpoch 495/1000\n0s - loss: 2.2116 - acc: 0.3478\nEpoch 496/1000\n0s - loss: 2.2096 - acc: 0.3478\nEpoch 497/1000\n0s - loss: 2.2084 - acc: 0.3478\nEpoch 498/1000\n0s - loss: 2.2078 - acc: 0.3478\nEpoch 499/1000\n0s - loss: 2.2063 - acc: 0.3478\nEpoch 500/1000\n0s - loss: 2.2053 - acc: 0.3478\nEpoch 501/1000\n0s - loss: 2.2040 - acc: 0.3478\nEpoch 502/1000\n0s - loss: 2.2032 - acc: 0.3478\nEpoch 503/1000\n0s - loss: 2.2020 - acc: 0.3478\nEpoch 504/1000\n0s - loss: 2.2013 - acc: 0.3478\nEpoch 505/1000\n0s - loss: 2.2002 - acc: 0.3478\nEpoch 506/1000\n0s - loss: 2.1993 - acc: 0.3478\nEpoch 507/1000\n0s - loss: 2.1981 - acc: 0.3913\nEpoch 508/1000\n0s - loss: 2.1968 - acc: 0.3478\nEpoch 509/1000\n0s - loss: 2.1957 - acc: 0.3913\nEpoch 510/1000\n0s - loss: 2.1943 - acc: 0.4348\nEpoch 511/1000\n0s - loss: 2.1935 - acc: 0.4348\nEpoch 512/1000\n0s - loss: 2.1920 - acc: 0.4348\nEpoch 513/1000\n0s - loss: 2.1916 - acc: 0.4348\nEpoch 514/1000\n0s - loss: 2.1898 - acc: 0.4348\nEpoch 515/1000\n0s - loss: 2.1891 - acc: 0.4348\nEpoch 516/1000\n0s - loss: 2.1882 - acc: 0.3913\nEpoch 517/1000\n0s - loss: 2.1875 - acc: 0.3913\nEpoch 518/1000\n0s - loss: 2.1863 - acc: 0.4348\nEpoch 519/1000\n0s - loss: 2.1849 - acc: 0.4348\nEpoch 520/1000\n0s - loss: 2.1846 - acc: 0.4348\nEpoch 521/1000\n0s - loss: 2.1831 - acc: 0.4348\nEpoch 522/1000\n0s - loss: 2.1823 - acc: 0.4348\nEpoch 523/1000\n0s - loss: 2.1811 - acc: 0.4348\nEpoch 524/1000\n0s - loss: 2.1795 - acc: 0.4783\nEpoch 525/1000\n0s - loss: 2.1798 - acc: 0.4348\nEpoch 526/1000\n0s - loss: 2.1776 - acc: 0.3913\nEpoch 527/1000\n0s - loss: 2.1773 - acc: 0.3913\nEpoch 528/1000\n0s - loss: 2.1752 - acc: 0.3913\nEpoch 529/1000\n0s - loss: 2.1744 - acc: 0.3913\nEpoch 530/1000\n0s - loss: 2.1736 - acc: 0.3913\nEpoch 531/1000\n0s - loss: 2.1726 - acc: 0.4348\nEpoch 532/1000\n0s - loss: 2.1721 - acc: 0.4348\nEpoch 533/1000\n0s - loss: 2.1710 - acc: 0.3913\nEpoch 534/1000\n0s - loss: 2.1694 - acc: 0.3913\nEpoch 535/1000\n0s - loss: 2.1684 - acc: 0.3913\nEpoch 536/1000\n0s - loss: 2.1668 - acc: 0.3913\nEpoch 537/1000\n0s - loss: 2.1667 - acc: 0.3913\nEpoch 538/1000\n0s - loss: 2.1658 - acc: 0.3913\nEpoch 539/1000\n0s - loss: 2.1647 - acc: 0.3913\nEpoch 540/1000\n0s - loss: 2.1634 - acc: 0.3913\nEpoch 541/1000\n0s - loss: 2.1622 - acc: 0.3913\nEpoch 542/1000\n0s - loss: 2.1617 - acc: 0.3913\nEpoch 543/1000\n0s - loss: 2.1598 - acc: 0.3478\nEpoch 544/1000\n0s - loss: 2.1594 - acc: 0.4348\nEpoch 545/1000\n0s - loss: 2.1588 - acc: 0.3913\nEpoch 546/1000\n0s - loss: 2.1567 - acc: 0.3913\nEpoch 547/1000\n0s - loss: 2.1563 - acc: 0.3913\nEpoch 548/1000\n0s - loss: 2.1553 - acc: 0.3913\nEpoch 549/1000\n0s - loss: 2.1549 - acc: 0.4348\nEpoch 550/1000\n0s - loss: 2.1531 - acc: 0.4348\nEpoch 551/1000\n0s - loss: 2.1529 - acc: 0.4348\nEpoch 552/1000\n0s - loss: 2.1518 - acc: 0.3913\nEpoch 553/1000\n0s - loss: 2.1507 - acc: 0.3913\nEpoch 554/1000\n0s - loss: 2.1498 - acc: 0.3913\nEpoch 555/1000\n0s - loss: 2.1485 - acc: 0.4783\nEpoch 556/1000\n0s - loss: 2.1474 - acc: 0.4783\nEpoch 557/1000\n0s - loss: 2.1464 - acc: 0.4348\nEpoch 558/1000\n0s - loss: 2.1453 - acc: 0.4348\nEpoch 559/1000\n0s - loss: 2.1446 - acc: 0.4348\nEpoch 560/1000\n0s - loss: 2.1431 - acc: 0.4348\nEpoch 561/1000\n0s - loss: 2.1427 - acc: 0.4348\nEpoch 562/1000\n0s - loss: 2.1415 - acc: 0.4348\nEpoch 563/1000\n0s - loss: 2.1407 - acc: 0.4348\nEpoch 564/1000\n0s - loss: 2.1396 - acc: 0.4783\nEpoch 565/1000\n0s - loss: 2.1387 - acc: 0.4783\nEpoch 566/1000\n0s - loss: 2.1374 - acc: 0.4783\nEpoch 567/1000\n0s - loss: 2.1365 - acc: 0.4783\nEpoch 568/1000\n0s - loss: 2.1359 - acc: 0.4783\nEpoch 569/1000\n0s - loss: 2.1349 - acc: 0.4783\nEpoch 570/1000\n0s - loss: 2.1335 - acc: 0.4783\nEpoch 571/1000\n0s - loss: 2.1324 - acc: 0.4783\nEpoch 572/1000\n0s - loss: 2.1314 - acc: 0.4348\nEpoch 573/1000\n0s - loss: 2.1308 - acc: 0.4348\nEpoch 574/1000\n0s - loss: 2.1302 - acc: 0.4348\nEpoch 575/1000\n0s - loss: 2.1291 - acc: 0.4348\nEpoch 576/1000\n0s - loss: 2.1280 - acc: 0.4348\nEpoch 577/1000\n0s - loss: 2.1267 - acc: 0.4348\nEpoch 578/1000\n0s - loss: 2.1256 - acc: 0.4348\nEpoch 579/1000\n0s - loss: 2.1252 - acc: 0.4348\nEpoch 580/1000\n0s - loss: 2.1246 - acc: 0.4348\nEpoch 581/1000\n0s - loss: 2.1234 - acc: 0.4348\nEpoch 582/1000\n0s - loss: 2.1219 - acc: 0.4348\nEpoch 583/1000\n0s - loss: 2.1214 - acc: 0.4348\nEpoch 584/1000\n0s - loss: 2.1206 - acc: 0.4348\nEpoch 585/1000\n0s - loss: 2.1192 - acc: 0.4348\nEpoch 586/1000\n0s - loss: 2.1180 - acc: 0.4348\nEpoch 587/1000\n0s - loss: 2.1178 - acc: 0.4348\nEpoch 588/1000\n0s - loss: 2.1163 - acc: 0.4348\nEpoch 589/1000\n0s - loss: 2.1160 - acc: 0.4348\nEpoch 590/1000\n0s - loss: 2.1152 - acc: 0.4348\nEpoch 591/1000\n0s - loss: 2.1139 - acc: 0.4348\nEpoch 592/1000\n0s - loss: 2.1132 - acc: 0.3913\nEpoch 593/1000\n0s - loss: 2.1123 - acc: 0.4348\nEpoch 594/1000\n0s - loss: 2.1109 - acc: 0.4348\nEpoch 595/1000\n0s - loss: 2.1105 - acc: 0.4348\nEpoch 596/1000\n0s - loss: 2.1091 - acc: 0.4348\nEpoch 597/1000\n0s - loss: 2.1089 - acc: 0.4348\nEpoch 598/1000\n0s - loss: 2.1081 - acc: 0.4783\nEpoch 599/1000\n0s - loss: 2.1068 - acc: 0.5217\nEpoch 600/1000\n0s - loss: 2.1060 - acc: 0.4783\nEpoch 601/1000\n0s - loss: 2.1048 - acc: 0.4348\nEpoch 602/1000\n0s - loss: 2.1040 - acc: 0.4348\nEpoch 603/1000\n0s - loss: 2.1033 - acc: 0.4783\nEpoch 604/1000\n0s - loss: 2.1025 - acc: 0.5217\nEpoch 605/1000\n0s - loss: 2.1014 - acc: 0.4783\nEpoch 606/1000\n0s - loss: 2.1002 - acc: 0.4783\nEpoch 607/1000\n0s - loss: 2.0992 - acc: 0.4783\nEpoch 608/1000\n0s - loss: 2.0991 - acc: 0.4783\nEpoch 609/1000\n0s - loss: 2.0977 - acc: 0.4348\nEpoch 610/1000\n0s - loss: 2.0966 - acc: 0.4783\nEpoch 611/1000\n0s - loss: 2.0965 - acc: 0.4783\nEpoch 612/1000\n0s - loss: 2.0952 - acc: 0.4783\nEpoch 613/1000\n0s - loss: 2.0937 - acc: 0.4783\nEpoch 614/1000\n0s - loss: 2.0930 - acc: 0.4783\nEpoch 615/1000\n0s - loss: 2.0929 - acc: 0.4783\nEpoch 616/1000\n0s - loss: 2.0913 - acc: 0.4348\nEpoch 617/1000\n0s - loss: 2.0897 - acc: 0.4783\nEpoch 618/1000\n0s - loss: 2.0890 - acc: 0.4783\nEpoch 619/1000\n0s - loss: 2.0885 - acc: 0.5217\nEpoch 620/1000\n0s - loss: 2.0874 - acc: 0.4783\nEpoch 621/1000\n0s - loss: 2.0862 - acc: 0.4783\nEpoch 622/1000\n0s - loss: 2.0862 - acc: 0.4783\nEpoch 623/1000\n0s - loss: 2.0854 - acc: 0.4783\nEpoch 624/1000\n0s - loss: 2.0840 - acc: 0.4783\nEpoch 625/1000\n0s - loss: 2.0832 - acc: 0.5217\nEpoch 626/1000\n0s - loss: 2.0823 - acc: 0.5217\nEpoch 627/1000\n0s - loss: 2.0810 - acc: 0.5652\nEpoch 628/1000\n0s - loss: 2.0804 - acc: 0.5652\nEpoch 629/1000\n0s - loss: 2.0794 - acc: 0.5652\nEpoch 630/1000\n0s - loss: 2.0790 - acc: 0.5217\nEpoch 631/1000\n0s - loss: 2.0775 - acc: 0.5217\nEpoch 632/1000\n0s - loss: 2.0765 - acc: 0.5217\nEpoch 633/1000\n0s - loss: 2.0758 - acc: 0.5652\nEpoch 634/1000\n0s - loss: 2.0748 - acc: 0.5652\nEpoch 635/1000\n0s - loss: 2.0747 - acc: 0.4783\nEpoch 636/1000\n0s - loss: 2.0735 - acc: 0.4348\nEpoch 637/1000\n0s - loss: 2.0728 - acc: 0.4348\nEpoch 638/1000\n0s - loss: 2.0722 - acc: 0.4348\nEpoch 639/1000\n0s - loss: 2.0708 - acc: 0.4348\nEpoch 640/1000\n0s - loss: 2.0703 - acc: 0.4783\nEpoch 641/1000\n0s - loss: 2.0684 - acc: 0.5652\nEpoch 642/1000\n0s - loss: 2.0680 - acc: 0.5652\nEpoch 643/1000\n0s - loss: 2.0671 - acc: 0.5217\nEpoch 644/1000\n0s - loss: 2.0665 - acc: 0.5217\nEpoch 645/1000\n0s - loss: 2.0655 - acc: 0.5217\nEpoch 646/1000\n0s - loss: 2.0654 - acc: 0.4783\nEpoch 647/1000\n0s - loss: 2.0645 - acc: 0.4348\nEpoch 648/1000\n0s - loss: 2.0635 - acc: 0.4348\nEpoch 649/1000\n0s - loss: 2.0619 - acc: 0.3913\nEpoch 650/1000\n0s - loss: 2.0611 - acc: 0.4348\nEpoch 651/1000\n0s - loss: 2.0603 - acc: 0.4783\nEpoch 652/1000\n0s - loss: 2.0591 - acc: 0.4783\nEpoch 653/1000\n0s - loss: 2.0601 - acc: 0.4348\nEpoch 654/1000\n0s - loss: 2.0581 - acc: 0.4783\nEpoch 655/1000\n0s - loss: 2.0576 - acc: 0.5217\nEpoch 656/1000\n0s - loss: 2.0568 - acc: 0.4783\nEpoch 657/1000\n0s - loss: 2.0560 - acc: 0.4783\nEpoch 658/1000\n0s - loss: 2.0550 - acc: 0.3913\nEpoch 659/1000\n0s - loss: 2.0543 - acc: 0.4348\nEpoch 660/1000\n0s - loss: 2.0530 - acc: 0.4348\nEpoch 661/1000\n0s - loss: 2.0529 - acc: 0.4783\nEpoch 662/1000\n0s - loss: 2.0517 - acc: 0.4348\nEpoch 663/1000\n0s - loss: 2.0502 - acc: 0.4348\nEpoch 664/1000\n0s - loss: 2.0495 - acc: 0.4348\nEpoch 665/1000\n0s - loss: 2.0489 - acc: 0.4348\nEpoch 666/1000\n0s - loss: 2.0481 - acc: 0.4348\nEpoch 667/1000\n0s - loss: 2.0472 - acc: 0.3913\nEpoch 668/1000\n0s - loss: 2.0464 - acc: 0.3913\nEpoch 669/1000\n0s - loss: 2.0455 - acc: 0.3913\nEpoch 670/1000\n0s - loss: 2.0450 - acc: 0.3913\nEpoch 671/1000\n0s - loss: 2.0433 - acc: 0.3913\nEpoch 672/1000\n0s - loss: 2.0429 - acc: 0.4348\nEpoch 673/1000\n0s - loss: 2.0417 - acc: 0.4348\nEpoch 674/1000\n0s - loss: 2.0412 - acc: 0.4348\nEpoch 675/1000\n0s - loss: 2.0404 - acc: 0.4783\nEpoch 676/1000\n0s - loss: 2.0398 - acc: 0.4783\nEpoch 677/1000\n0s - loss: 2.0386 - acc: 0.5652\nEpoch 678/1000\n0s - loss: 2.0383 - acc: 0.5652\nEpoch 679/1000\n0s - loss: 2.0377 - acc: 0.5652\nEpoch 680/1000\n0s - loss: 2.0364 - acc: 0.5652\nEpoch 681/1000\n0s - loss: 2.0352 - acc: 0.4348\nEpoch 682/1000\n0s - loss: 2.0350 - acc: 0.5217\nEpoch 683/1000\n0s - loss: 2.0342 - acc: 0.5652\nEpoch 684/1000\n0s - loss: 2.0336 - acc: 0.5217\nEpoch 685/1000\n0s - loss: 2.0334 - acc: 0.4783\nEpoch 686/1000\n0s - loss: 2.0315 - acc: 0.5217\nEpoch 687/1000\n0s - loss: 2.0312 - acc: 0.4783\nEpoch 688/1000\n0s - loss: 2.0305 - acc: 0.5217\nEpoch 689/1000\n0s - loss: 2.0293 - acc: 0.4783\nEpoch 690/1000\n0s - loss: 2.0296 - acc: 0.5652\nEpoch 691/1000\n0s - loss: 2.0274 - acc: 0.5652\nEpoch 692/1000\n0s - loss: 2.0268 - acc: 0.5652\nEpoch 693/1000\n0s - loss: 2.0262 - acc: 0.4783\nEpoch 694/1000\n0s - loss: 2.0250 - acc: 0.4348\nEpoch 695/1000\n0s - loss: 2.0245 - acc: 0.4348\nEpoch 696/1000\n0s - loss: 2.0234 - acc: 0.4783\nEpoch 697/1000\n0s - loss: 2.0224 - acc: 0.5217\nEpoch 698/1000\n0s - loss: 2.0219 - acc: 0.5217\nEpoch 699/1000\n0s - loss: 2.0214 - acc: 0.5217\nEpoch 700/1000\n0s - loss: 2.0198 - acc: 0.5217\nEpoch 701/1000\n0s - loss: 2.0194 - acc: 0.5217\nEpoch 702/1000\n0s - loss: 2.0185 - acc: 0.5217\nEpoch 703/1000\n0s - loss: 2.0185 - acc: 0.4783\nEpoch 704/1000\n0s - loss: 2.0178 - acc: 0.4783\nEpoch 705/1000\n0s - loss: 2.0164 - acc: 0.5652\nEpoch 706/1000\n0s - loss: 2.0151 - acc: 0.5652\nEpoch 707/1000\n0s - loss: 2.0148 - acc: 0.5652\nEpoch 708/1000\n0s - loss: 2.0140 - acc: 0.5217\nEpoch 709/1000\n0s - loss: 2.0124 - acc: 0.4783\nEpoch 710/1000\n0s - loss: 2.0126 - acc: 0.4783\nEpoch 711/1000\n0s - loss: 2.0115 - acc: 0.4348\nEpoch 712/1000\n0s - loss: 2.0117 - acc: 0.4348\nEpoch 713/1000\n0s - loss: 2.0101 - acc: 0.4783\nEpoch 714/1000\n0s - loss: 2.0096 - acc: 0.4783\nEpoch 715/1000\n0s - loss: 2.0093 - acc: 0.4783\nEpoch 716/1000\n0s - loss: 2.0078 - acc: 0.4783\nEpoch 717/1000\n0s - loss: 2.0066 - acc: 0.5652\nEpoch 718/1000\n0s - loss: 2.0059 - acc: 0.5652\nEpoch 719/1000\n0s - loss: 2.0058 - acc: 0.5217\nEpoch 720/1000\n0s - loss: 2.0050 - acc: 0.5217\nEpoch 721/1000\n0s - loss: 2.0046 - acc: 0.5217\nEpoch 722/1000\n0s - loss: 2.0036 - acc: 0.5217\nEpoch 723/1000\n0s - loss: 2.0024 - acc: 0.5217\nEpoch 724/1000\n0s - loss: 2.0016 - acc: 0.5217\nEpoch 725/1000\n0s - loss: 2.0008 - acc: 0.5652\nEpoch 726/1000\n0s - loss: 2.0006 - acc: 0.5217\nEpoch 727/1000\n0s - loss: 1.9986 - acc: 0.5652\nEpoch 728/1000\n0s - loss: 1.9988 - acc: 0.5652\nEpoch 729/1000\n0s - loss: 1.9981 - acc: 0.6087\nEpoch 730/1000\n0s - loss: 1.9969 - acc: 0.5652\nEpoch 731/1000\n0s - loss: 1.9962 - acc: 0.5652\nEpoch 732/1000\n0s - loss: 1.9954 - acc: 0.5652\nEpoch 733/1000\n0s - loss: 1.9946 - acc: 0.5217\nEpoch 734/1000\n0s - loss: 1.9936 - acc: 0.4783\nEpoch 735/1000\n0s - loss: 1.9916 - acc: 0.4783\nEpoch 736/1000\n0s - loss: 1.9926 - acc: 0.5217\nEpoch 737/1000\n0s - loss: 1.9922 - acc: 0.4783\nEpoch 738/1000\n0s - loss: 1.9910 - acc: 0.4783\nEpoch 739/1000\n0s - loss: 1.9900 - acc: 0.4783\nEpoch 740/1000\n0s - loss: 1.9897 - acc: 0.5217\nEpoch 741/1000\n0s - loss: 1.9889 - acc: 0.5652\nEpoch 742/1000\n0s - loss: 1.9883 - acc: 0.6087\nEpoch 743/1000\n0s - loss: 1.9876 - acc: 0.5652\nEpoch 744/1000\n0s - loss: 1.9870 - acc: 0.5652\nEpoch 745/1000\n0s - loss: 1.9856 - acc: 0.4783\nEpoch 746/1000\n0s - loss: 1.9852 - acc: 0.5217\nEpoch 747/1000\n0s - loss: 1.9841 - acc: 0.5217\nEpoch 748/1000\n0s - loss: 1.9834 - acc: 0.5652\nEpoch 749/1000\n0s - loss: 1.9829 - acc: 0.5217\nEpoch 750/1000\n0s - loss: 1.9827 - acc: 0.5217\nEpoch 751/1000\n0s - loss: 1.9807 - acc: 0.5217\nEpoch 752/1000\n0s - loss: 1.9805 - acc: 0.5217\nEpoch 753/1000\n0s - loss: 1.9795 - acc: 0.5217\nEpoch 754/1000\n0s - loss: 1.9793 - acc: 0.4783\nEpoch 755/1000\n0s - loss: 1.9781 - acc: 0.5652\nEpoch 756/1000\n0s - loss: 1.9770 - acc: 0.5652\nEpoch 757/1000\n0s - loss: 1.9768 - acc: 0.5652\nEpoch 758/1000\n0s - loss: 1.9750 - acc: 0.5217\nEpoch 759/1000\n0s - loss: 1.9751 - acc: 0.4783\nEpoch 760/1000\n0s - loss: 1.9741 - acc: 0.4348\nEpoch 761/1000\n0s - loss: 1.9732 - acc: 0.4348\nEpoch 762/1000\n0s - loss: 1.9728 - acc: 0.4348\nEpoch 763/1000\n0s - loss: 1.9720 - acc: 0.4783\nEpoch 764/1000\n0s - loss: 1.9716 - acc: 0.4783\nEpoch 765/1000\n0s - loss: 1.9704 - acc: 0.4783\nEpoch 766/1000\n0s - loss: 1.9701 - acc: 0.4783\nEpoch 767/1000\n0s - loss: 1.9699 - acc: 0.5217\nEpoch 768/1000\n0s - loss: 1.9683 - acc: 0.4783\nEpoch 769/1000\n0s - loss: 1.9676 - acc: 0.4783\nEpoch 770/1000\n0s - loss: 1.9668 - acc: 0.4783\nEpoch 771/1000\n0s - loss: 1.9664 - acc: 0.4348\nEpoch 772/1000\n0s - loss: 1.9664 - acc: 0.4348\nEpoch 773/1000\n0s - loss: 1.9653 - acc: 0.4348\nEpoch 774/1000\n0s - loss: 1.9646 - acc: 0.4348\nEpoch 775/1000\n0s - loss: 1.9647 - acc: 0.4783\nEpoch 776/1000\n0s - loss: 1.9623 - acc: 0.5217\nEpoch 777/1000\n0s - loss: 1.9619 - acc: 0.5217\nEpoch 778/1000\n0s - loss: 1.9613 - acc: 0.4783\nEpoch 779/1000\n0s - loss: 1.9604 - acc: 0.4783\nEpoch 780/1000\n0s - loss: 1.9598 - acc: 0.4348\nEpoch 781/1000\n0s - loss: 1.9595 - acc: 0.4348\nEpoch 782/1000\n0s - loss: 1.9592 - acc: 0.4348\nEpoch 783/1000\n0s - loss: 1.9578 - acc: 0.4348\nEpoch 784/1000\n0s - loss: 1.9570 - acc: 0.4348\nEpoch 785/1000\n0s - loss: 1.9558 - acc: 0.4348\nEpoch 786/1000\n0s - loss: 1.9558 - acc: 0.4348\nEpoch 787/1000\n0s - loss: 1.9555 - acc: 0.4348\nEpoch 788/1000\n0s - loss: 1.9548 - acc: 0.3913\nEpoch 789/1000\n0s - loss: 1.9536 - acc: 0.4348\nEpoch 790/1000\n0s - loss: 1.9534 - acc: 0.4783\nEpoch 791/1000\n0s - loss: 1.9529 - acc: 0.4783\nEpoch 792/1000\n0s - loss: 1.9519 - acc: 0.4783\nEpoch 793/1000\n0s - loss: 1.9518 - acc: 0.4348\nEpoch 794/1000\n0s - loss: 1.9507 - acc: 0.4348\nEpoch 795/1000\n0s - loss: 1.9494 - acc: 0.4348\nEpoch 796/1000\n0s - loss: 1.9492 - acc: 0.4348\nEpoch 797/1000\n0s - loss: 1.9486 - acc: 0.4348\nEpoch 798/1000\n0s - loss: 1.9472 - acc: 0.4348\nEpoch 799/1000\n0s - loss: 1.9464 - acc: 0.4348\nEpoch 800/1000\n0s - loss: 1.9454 - acc: 0.3913\nEpoch 801/1000\n0s - loss: 1.9450 - acc: 0.4348\nEpoch 802/1000\n0s - loss: 1.9449 - acc: 0.4348\nEpoch 803/1000\n0s - loss: 1.9444 - acc: 0.4348\nEpoch 804/1000\n0s - loss: 1.9428 - acc: 0.4348\nEpoch 805/1000\n0s - loss: 1.9427 - acc: 0.4348\nEpoch 806/1000\n0s - loss: 1.9421 - acc: 0.3913\nEpoch 807/1000\n0s - loss: 1.9406 - acc: 0.4348\nEpoch 808/1000\n0s - loss: 1.9401 - acc: 0.4348\nEpoch 809/1000\n0s - loss: 1.9398 - acc: 0.4783\nEpoch 810/1000\n0s - loss: 1.9382 - acc: 0.4783\nEpoch 811/1000\n0s - loss: 1.9384 - acc: 0.4348\nEpoch 812/1000\n0s - loss: 1.9370 - acc: 0.4783\nEpoch 813/1000\n0s - loss: 1.9364 - acc: 0.5217\nEpoch 814/1000\n0s - loss: 1.9361 - acc: 0.5217\nEpoch 815/1000\n0s - loss: 1.9364 - acc: 0.5652\nEpoch 816/1000\n0s - loss: 1.9348 - acc: 0.5652\nEpoch 817/1000\n0s - loss: 1.9343 - acc: 0.5217\nEpoch 818/1000\n0s - loss: 1.9327 - acc: 0.5652\nEpoch 819/1000\n0s - loss: 1.9328 - acc: 0.5217\nEpoch 820/1000\n0s - loss: 1.9328 - acc: 0.4783\nEpoch 821/1000\n0s - loss: 1.9313 - acc: 0.4783\nEpoch 822/1000\n0s - loss: 1.9309 - acc: 0.4783\nEpoch 823/1000\n0s - loss: 1.9298 - acc: 0.4783\nEpoch 824/1000\n0s - loss: 1.9282 - acc: 0.5217\nEpoch 825/1000\n0s - loss: 1.9286 - acc: 0.5217\nEpoch 826/1000\n0s - loss: 1.9269 - acc: 0.4783\nEpoch 827/1000\n0s - loss: 1.9274 - acc: 0.5217\nEpoch 828/1000\n0s - loss: 1.9270 - acc: 0.4783\nEpoch 829/1000\n0s - loss: 1.9262 - acc: 0.5217\nEpoch 830/1000\n0s - loss: 1.9252 - acc: 0.5217\nEpoch 831/1000\n0s - loss: 1.9251 - acc: 0.5652\nEpoch 832/1000\n0s - loss: 1.9239 - acc: 0.5217\nEpoch 833/1000\n0s - loss: 1.9237 - acc: 0.5652\nEpoch 834/1000\n0s - loss: 1.9224 - acc: 0.5652\nEpoch 835/1000\n0s - loss: 1.9213 - acc: 0.5217\nEpoch 836/1000\n0s - loss: 1.9203 - acc: 0.5217\nEpoch 837/1000\n0s - loss: 1.9210 - acc: 0.5217\nEpoch 838/1000\n0s - loss: 1.9193 - acc: 0.4783\nEpoch 839/1000\n0s - loss: 1.9194 - acc: 0.5217\nEpoch 840/1000\n0s - loss: 1.9185 - acc: 0.5217\nEpoch 841/1000\n0s - loss: 1.9170 - acc: 0.5217\nEpoch 842/1000\n0s - loss: 1.9170 - acc: 0.4783\nEpoch 843/1000\n0s - loss: 1.9160 - acc: 0.4783\nEpoch 844/1000\n0s - loss: 1.9149 - acc: 0.5652\nEpoch 845/1000\n0s - loss: 1.9151 - acc: 0.5217\nEpoch 846/1000\n0s - loss: 1.9147 - acc: 0.4783\nEpoch 847/1000\n0s - loss: 1.9143 - acc: 0.5652\nEpoch 848/1000\n0s - loss: 1.9129 - acc: 0.5652\nEpoch 849/1000\n0s - loss: 1.9134 - acc: 0.5652\nEpoch 850/1000\n0s - loss: 1.9115 - acc: 0.5652\nEpoch 851/1000\n0s - loss: 1.9111 - acc: 0.4783\nEpoch 852/1000\n0s - loss: 1.9109 - acc: 0.5217\nEpoch 853/1000\n0s - loss: 1.9103 - acc: 0.5652\nEpoch 854/1000\n0s - loss: 1.9091 - acc: 0.5652\nEpoch 855/1000\n0s - loss: 1.9085 - acc: 0.4783\nEpoch 856/1000\n0s - loss: 1.9076 - acc: 0.4783\nEpoch 857/1000\n0s - loss: 1.9074 - acc: 0.4783\nEpoch 858/1000\n0s - loss: 1.9072 - acc: 0.4783\nEpoch 859/1000\n0s - loss: 1.9061 - acc: 0.4783\nEpoch 860/1000\n0s - loss: 1.9057 - acc: 0.5217\nEpoch 861/1000\n0s - loss: 1.9047 - acc: 0.5217\nEpoch 862/1000\n0s - loss: 1.9046 - acc: 0.5217\nEpoch 863/1000\n0s - loss: 1.9034 - acc: 0.5217\nEpoch 864/1000\n0s - loss: 1.9028 - acc: 0.5652\nEpoch 865/1000\n0s - loss: 1.9017 - acc: 0.5652\nEpoch 866/1000\n0s - loss: 1.9012 - acc: 0.6087\nEpoch 867/1000\n0s - loss: 1.9005 - acc: 0.5652\nEpoch 868/1000\n0s - loss: 1.8999 - acc: 0.5652\nEpoch 869/1000\n0s - loss: 1.8991 - acc: 0.4783\nEpoch 870/1000\n0s - loss: 1.8983 - acc: 0.5217\nEpoch 871/1000\n0s - loss: 1.8980 - acc: 0.5217\nEpoch 872/1000\n0s - loss: 1.8978 - acc: 0.5217\nEpoch 873/1000\n0s - loss: 1.8968 - acc: 0.5217\nEpoch 874/1000\n0s - loss: 1.8961 - acc: 0.5217\nEpoch 875/1000\n0s - loss: 1.8958 - acc: 0.5217\nEpoch 876/1000\n0s - loss: 1.8949 - acc: 0.5217\nEpoch 877/1000\n0s - loss: 1.8942 - acc: 0.5217\nEpoch 878/1000\n0s - loss: 1.8930 - acc: 0.4783\nEpoch 879/1000\n0s - loss: 1.8919 - acc: 0.4783\nEpoch 880/1000\n0s - loss: 1.8919 - acc: 0.4783\nEpoch 881/1000\n0s - loss: 1.8909 - acc: 0.4783\nEpoch 882/1000\n0s - loss: 1.8906 - acc: 0.4783\nEpoch 883/1000\n0s - loss: 1.8910 - acc: 0.4783\nEpoch 884/1000\n0s - loss: 1.8900 - acc: 0.5217\nEpoch 885/1000\n0s - loss: 1.8890 - acc: 0.5217\nEpoch 886/1000\n0s - loss: 1.8880 - acc: 0.4783\nEpoch 887/1000\n0s - loss: 1.8880 - acc: 0.4783\nEpoch 888/1000\n0s - loss: 1.8875 - acc: 0.4783\nEpoch 889/1000\n0s - loss: 1.8864 - acc: 0.6522\nEpoch 890/1000\n0s - loss: 1.8855 - acc: 0.5652\nEpoch 891/1000\n0s - loss: 1.8848 - acc: 0.5652\nEpoch 892/1000\n0s - loss: 1.8835 - acc: 0.5652\nEpoch 893/1000\n0s - loss: 1.8841 - acc: 0.5217\nEpoch 894/1000\n0s - loss: 1.8841 - acc: 0.4783\nEpoch 895/1000\n0s - loss: 1.8834 - acc: 0.5217\nEpoch 896/1000\n0s - loss: 1.8821 - acc: 0.4783\nEpoch 897/1000\n0s - loss: 1.8825 - acc: 0.4783\nEpoch 898/1000\n0s - loss: 1.8807 - acc: 0.6087\nEpoch 899/1000\n0s - loss: 1.8809 - acc: 0.6087\nEpoch 900/1000\n0s - loss: 1.8799 - acc: 0.5217\nEpoch 901/1000\n0s - loss: 1.8788 - acc: 0.5217\nEpoch 902/1000\n0s - loss: 1.8780 - acc: 0.5217\nEpoch 903/1000\n0s - loss: 1.8774 - acc: 0.5652\nEpoch 904/1000\n0s - loss: 1.8761 - acc: 0.5652\nEpoch 905/1000\n0s - loss: 1.8756 - acc: 0.6087\nEpoch 906/1000\n0s - loss: 1.8759 - acc: 0.5652\nEpoch 907/1000\n0s - loss: 1.8751 - acc: 0.5217\nEpoch 908/1000\n0s - loss: 1.8746 - acc: 0.4783\nEpoch 909/1000\n0s - loss: 1.8730 - acc: 0.4783\nEpoch 910/1000\n0s - loss: 1.8723 - acc: 0.4783\nEpoch 911/1000\n0s - loss: 1.8730 - acc: 0.4783\nEpoch 912/1000\n0s - loss: 1.8721 - acc: 0.4783\nEpoch 913/1000\n0s - loss: 1.8715 - acc: 0.4783\nEpoch 914/1000\n0s - loss: 1.8713 - acc: 0.4783\nEpoch 915/1000\n0s - loss: 1.8704 - acc: 0.4783\nEpoch 916/1000\n0s - loss: 1.8695 - acc: 0.4783\nEpoch 917/1000\n0s - loss: 1.8686 - acc: 0.4783\nEpoch 918/1000\n0s - loss: 1.8684 - acc: 0.5217\nEpoch 919/1000\n0s - loss: 1.8676 - acc: 0.5217\nEpoch 920/1000\n0s - loss: 1.8666 - acc: 0.5217\nEpoch 921/1000\n0s - loss: 1.8660 - acc: 0.5217\nEpoch 922/1000\n0s - loss: 1.8658 - acc: 0.5217\nEpoch 923/1000\n0s - loss: 1.8659 - acc: 0.4783\nEpoch 924/1000\n0s - loss: 1.8643 - acc: 0.4783\nEpoch 925/1000\n0s - loss: 1.8637 - acc: 0.4783\nEpoch 926/1000\n0s - loss: 1.8633 - acc: 0.5217\nEpoch 927/1000\n0s - loss: 1.8625 - acc: 0.5217\nEpoch 928/1000\n0s - loss: 1.8614 - acc: 0.5217\nEpoch 929/1000\n0s - loss: 1.8616 - acc: 0.4783\nEpoch 930/1000\n0s - loss: 1.8609 - acc: 0.5217\nEpoch 931/1000\n0s - loss: 1.8599 - acc: 0.5217\nEpoch 932/1000\n0s - loss: 1.8588 - acc: 0.5217\nEpoch 933/1000\n0s - loss: 1.8591 - acc: 0.5217\nEpoch 934/1000\n0s - loss: 1.8589 - acc: 0.5217\nEpoch 935/1000\n0s - loss: 1.8578 - acc: 0.5217\nEpoch 936/1000\n0s - loss: 1.8573 - acc: 0.5217\nEpoch 937/1000\n0s - loss: 1.8565 - acc: 0.5217\nEpoch 938/1000\n0s - loss: 1.8567 - acc: 0.5217\nEpoch 939/1000\n0s - loss: 1.8554 - acc: 0.5652\nEpoch 940/1000\n0s - loss: 1.8552 - acc: 0.5217\nEpoch 941/1000\n0s - loss: 1.8546 - acc: 0.5217\nEpoch 942/1000\n0s - loss: 1.8536 - acc: 0.5652\nEpoch 943/1000\n0s - loss: 1.8533 - acc: 0.5652\nEpoch 944/1000\n0s - loss: 1.8535 - acc: 0.5217\nEpoch 945/1000\n0s - loss: 1.8517 - acc: 0.5217\nEpoch 946/1000\n0s - loss: 1.8512 - acc: 0.5217\nEpoch 947/1000\n0s - loss: 1.8505 - acc: 0.5217\nEpoch 948/1000\n0s - loss: 1.8501 - acc: 0.5217\nEpoch 949/1000\n0s - loss: 1.8492 - acc: 0.5217\nEpoch 950/1000\n0s - loss: 1.8482 - acc: 0.5217\nEpoch 951/1000\n0s - loss: 1.8484 - acc: 0.6087\nEpoch 952/1000\n0s - loss: 1.8476 - acc: 0.5652\nEpoch 953/1000\n0s - loss: 1.8462 - acc: 0.5652\nEpoch 954/1000\n0s - loss: 1.8466 - acc: 0.5652\nEpoch 955/1000\n0s - loss: 1.8460 - acc: 0.5217\nEpoch 956/1000\n0s - loss: 1.8453 - acc: 0.5217\nEpoch 957/1000\n0s - loss: 1.8447 - acc: 0.5217\nEpoch 958/1000\n0s - loss: 1.8437 - acc: 0.5217\nEpoch 959/1000\n0s - loss: 1.8432 - acc: 0.5217\nEpoch 960/1000\n0s - loss: 1.8424 - acc: 0.5652\nEpoch 961/1000\n0s - loss: 1.8412 - acc: 0.5652\nEpoch 962/1000\n0s - loss: 1.8424 - acc: 0.5652\nEpoch 963/1000\n0s - loss: 1.8401 - acc: 0.6087\nEpoch 964/1000\n0s - loss: 1.8412 - acc: 0.6522\nEpoch 965/1000\n0s - loss: 1.8402 - acc: 0.6522\nEpoch 966/1000\n0s - loss: 1.8395 - acc: 0.5652\nEpoch 967/1000\n0s - loss: 1.8385 - acc: 0.5652\nEpoch 968/1000\n0s - loss: 1.8383 - acc: 0.5652\nEpoch 969/1000\n0s - loss: 1.8374 - acc: 0.5652\nEpoch 970/1000\n0s - loss: 1.8361 - acc: 0.5652\nEpoch 971/1000\n0s - loss: 1.8361 - acc: 0.5217\nEpoch 972/1000\n0s - loss: 1.8366 - acc: 0.5217\nEpoch 973/1000\n0s - loss: 1.8361 - acc: 0.6087\nEpoch 974/1000\n0s - loss: 1.8341 - acc: 0.5652\nEpoch 975/1000\n0s - loss: 1.8339 - acc: 0.5217\nEpoch 976/1000\n0s - loss: 1.8333 - acc: 0.5217\nEpoch 977/1000\n0s - loss: 1.8334 - acc: 0.4783\nEpoch 978/1000\n0s - loss: 1.8322 - acc: 0.4783\nEpoch 979/1000\n0s - loss: 1.8327 - acc: 0.5217\nEpoch 980/1000\n0s - loss: 1.8312 - acc: 0.5652\nEpoch 981/1000\n0s - loss: 1.8315 - acc: 0.5217\nEpoch 982/1000\n0s - loss: 1.8304 - acc: 0.4783\nEpoch 983/1000\n0s - loss: 1.8300 - acc: 0.4783\nEpoch 984/1000\n0s - loss: 1.8291 - acc: 0.5217\nEpoch 985/1000\n0s - loss: 1.8284 - acc: 0.5217\nEpoch 986/1000\n0s - loss: 1.8267 - acc: 0.5217\nEpoch 987/1000\n0s - loss: 1.8273 - acc: 0.5217\nEpoch 988/1000\n0s - loss: 1.8266 - acc: 0.5217\nEpoch 989/1000\n0s - loss: 1.8263 - acc: 0.4783\nEpoch 990/1000\n0s - loss: 1.8254 - acc: 0.5217\nEpoch 991/1000\n0s - loss: 1.8250 - acc: 0.4783\nEpoch 992/1000\n0s - loss: 1.8241 - acc: 0.4783\nEpoch 993/1000\n0s - loss: 1.8235 - acc: 0.4783\nEpoch 994/1000\n0s - loss: 1.8223 - acc: 0.4783\nEpoch 995/1000\n0s - loss: 1.8224 - acc: 0.5217\nEpoch 996/1000\n0s - loss: 1.8223 - acc: 0.5217\nEpoch 997/1000\n0s - loss: 1.8211 - acc: 0.5652\nEpoch 998/1000\n0s - loss: 1.8199 - acc: 0.6087\nEpoch 999/1000\n0s - loss: 1.8204 - acc: 0.5652\nEpoch 1000/1000\n0s - loss: 1.8194 - acc: 0.5652\n\r23/23 [==============================] - 0s\nModel Accuracy: 0.61 \n([&apos;A&apos;, &apos;B&apos;, &apos;C&apos;], &apos;-&gt;&apos;, &apos;D&apos;)\n([&apos;B&apos;, &apos;C&apos;, &apos;D&apos;], &apos;-&gt;&apos;, &apos;E&apos;)\n([&apos;C&apos;, &apos;D&apos;, &apos;E&apos;], &apos;-&gt;&apos;, &apos;F&apos;)\n([&apos;D&apos;, &apos;E&apos;, &apos;F&apos;], &apos;-&gt;&apos;, &apos;G&apos;)\n([&apos;E&apos;, &apos;F&apos;, &apos;G&apos;], &apos;-&gt;&apos;, &apos;H&apos;)\n([&apos;F&apos;, &apos;G&apos;, &apos;H&apos;], &apos;-&gt;&apos;, &apos;I&apos;)\n([&apos;G&apos;, &apos;H&apos;, &apos;I&apos;], &apos;-&gt;&apos;, &apos;J&apos;)\n([&apos;H&apos;, &apos;I&apos;, &apos;J&apos;], &apos;-&gt;&apos;, &apos;K&apos;)\n([&apos;I&apos;, &apos;J&apos;, &apos;K&apos;], &apos;-&gt;&apos;, &apos;K&apos;)\n([&apos;J&apos;, &apos;K&apos;, &apos;L&apos;], &apos;-&gt;&apos;, &apos;M&apos;)\n([&apos;K&apos;, &apos;L&apos;, &apos;M&apos;], &apos;-&gt;&apos;, &apos;O&apos;)\n([&apos;L&apos;, &apos;M&apos;, &apos;N&apos;], &apos;-&gt;&apos;, &apos;O&apos;)\n([&apos;M&apos;, &apos;N&apos;, &apos;O&apos;], &apos;-&gt;&apos;, &apos;O&apos;)\n([&apos;N&apos;, &apos;O&apos;, &apos;P&apos;], &apos;-&gt;&apos;, &apos;Q&apos;)\n([&apos;O&apos;, &apos;P&apos;, &apos;Q&apos;], &apos;-&gt;&apos;, &apos;S&apos;)\n([&apos;P&apos;, &apos;Q&apos;, &apos;R&apos;], &apos;-&gt;&apos;, &apos;S&apos;)\n([&apos;Q&apos;, &apos;R&apos;, &apos;S&apos;], &apos;-&gt;&apos;, &apos;T&apos;)\n([&apos;R&apos;, &apos;S&apos;, &apos;T&apos;], &apos;-&gt;&apos;, &apos;V&apos;)\n([&apos;S&apos;, &apos;T&apos;, &apos;U&apos;], &apos;-&gt;&apos;, &apos;Y&apos;)\n([&apos;T&apos;, &apos;U&apos;, &apos;V&apos;], &apos;-&gt;&apos;, &apos;Y&apos;)\n([&apos;U&apos;, &apos;V&apos;, &apos;W&apos;], &apos;-&gt;&apos;, &apos;Y&apos;)\n([&apos;V&apos;, &apos;W&apos;, &apos;X&apos;], &apos;-&gt;&apos;, &apos;Z&apos;)\n([&apos;W&apos;, &apos;X&apos;, &apos;Y&apos;], &apos;-&gt;&apos;, &apos;Z&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1513244326344,"submitTime":1513244326327,"finishTime":1513244338601,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4016eaea-9d47-4b16-912d-9366493e4a7a"},{"version":"CommandV1","origId":216728,"guid":"99680f44-e893-46a0-8dfa-6d51c8455b26","subtype":"command","commandType":"auto","position":4.625,"command":"X.shape[1], y.shape[1] # get a sense of the shapes to understand the network architecture","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>(3, 26)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513233834365,"submitTime":1513233834353,"finishTime":1513233834397,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"430661f7-1e3c-4b7f-a341-73636adb5398"},{"version":"CommandV1","origId":216729,"guid":"9cd43fb0-ac9a-4bf8-a6d9-06b6eb0467f1","subtype":"command","commandType":"auto","position":4.75,"command":"%md \nThe network does learn, and could be trained to get a good accuracy. But what's really going on here?\n\nLet's leave aside for a moment the simplistic training data (one fun experiment would be to create corrupted sequences and augment the data with those, forcing the network to pay attention to the whole sequence).\n\nBecause the model is fundamentally symmetric and stateless (in terms of the sequence; naturally it has weights), this model would need to learn every sequential feature relative to every single sequence position. That seems difficult, inflexible, and inefficient.\n\nMaybe we could add layers, neurons, and extra connections to mitigate parts of the problem. We could also do things like a 1D convolution to pick up frequencies and some patterns.\n\nBut instead, it might make more sense to explicitly model the sequential nature of the data (a bit like how we explictly modeled the 2D nature of image data with CNNs).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"806be634-8d7e-4271-a1cb-403858fd207a"},{"version":"CommandV1","origId":216730,"guid":"034c100b-0d44-40cd-a043-cde2b52c2bf9","subtype":"command","commandType":"auto","position":5.0,"command":"%md \n## Recurrent Neural Network Concept\n\n__Let's take the neuron's output from one time (t) and feed it into that same neuron at a later time (t+1), in combination with other relevant inputs. Then we would have a neuron with memory.__\n\nWe can weight the \"return\" of that value and train the weight -- so the neuron learns how important the previous value is relative to the current one.\n\nDifferent neurons might learn to \"remember\" different amounts of prior history.\n\nThis concept is called a *Recurrent Neural Network*, originally developed around the 1980s.\n\nLet's recall some pointers from the crash intro to Deep learning.\n\n### Watch following videos now for 12 minutes for the fastest introduction to RNNs and LSTMs\n\n[Udacity: Deep Learning by Vincent Vanhoucke - Recurrent Neural network](https://youtu.be/LTbLxm6YIjE?list=PLAwxTw4SYaPn_OWPFT9ulXLuQrImzHfOV)\n\n#### Recurrent neural network\n![Recurrent neural network](http://colah.github.io/posts/2015-08-Understanding-LSTMs/img/RNN-unrolled.png)  \n[http://colah.github.io/posts/2015-08-Understanding-LSTMs/](http://colah.github.io/posts/2015-08-Understanding-LSTMs/)  \n\n\n[http://karpathy.github.io/2015/05/21/rnn-effectiveness/](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)  \n***\n\n***\n##### LSTM - Long short term memory\n![LSTM](http://colah.github.io/posts/2015-08-Understanding-LSTMs/img/LSTM3-chain.png)\n\n***\n##### GRU - Gated recurrent unit\n![Gated Recurrent unit](http://colah.github.io/posts/2015-08-Understanding-LSTMs/img/LSTM3-var-GRU.png)\n[http://arxiv.org/pdf/1406.1078v3.pdf](http://arxiv.org/pdf/1406.1078v3.pdf)  \n\n\n### Training a Recurrent Neural Network\n\n<img src=\"http://i.imgur.com/iPGNMvZ.jpg\">\n\nWe can train an RNN using backpropagation with a minor twist: since RNN neurons with different states over time can be \"unrolled\" (i.e., are analogous) to a sequence of neurons with the \"remember\" weight linking directly forward from (t) to (t+1), we can backpropagate through time as well as the physical layers of the network.\n\nThis is, in fact, called __Backpropagation Through Time__ (BPTT)\n\nThe idea is sound but -- since it creates patterns similar to very deep networks -- it suffers from the same challenges:\n* Vanishing gradient\n* Exploding gradient\n* Saturation\n* etc.\n\ni.e., many of the same problems with early deep feed-forward networks having lots of weights.\n\n10 steps back in time for a single layer is a not as bad as 10 layers (since there are fewer connections and, hence, weights) but it does get expensive.\n\n---\n\n> __ASIDE: Hierarchical and Recursive Networks, Bidirectional RNN__\n\n> Network topologies can be built to reflect the relative structure of the data we are modeling. E.g., for natural language, grammar constraints mean that both hierarchy and (limited) recursion may allow a physically smaller model to achieve more effective capacity.\n\n> A bi-directional RNN includes values from previous and subsequent time steps. This is less strange than it sounds at first: after all, in many problems, such as sentence translation (where BiRNNs are very popular) we usually have the entire source sequence at one time. In that case, a BiDiRNN is really just saying that both prior and subsequent words can influence the interpretation of each word, something we humans take for granted.\n\n> Recent versions of neural net libraries have support for bidirectional networks, although you may need to write (or locate) a little code yourself if you want to experiment with hierarchical networks.\n\n---\n\n## Long Short-Term Memory (LSTM)\n\n\"Pure\" RNNs were never very successful. Sepp Hochreiter and Jürgen Schmidhuber (1997) made a game-changing contribution with the publication of the Long Short-Term Memory unit. How game changing? It's effectively state of the art today.\n\n<sup>(Credit and much thanks to Chris Olah, http://colah.github.io/about.html, Research Scientist at Google Brain, for publishing the following excellent diagrams!)</sup>\n\n*In the following diagrams, pay close attention that the output value is \"split\" for graphical purposes -- so the two *h* arrows/signals coming out are the same signal.*\n\n__RNN Cell:__\n<img src=\"http://i.imgur.com/DfYyKaN.png\" width=600>\n\n__LSTM Cell:__\n\n<img src=\"http://i.imgur.com/pQiMLjG.png\" width=600>\n\n\nAn LSTM unit is a neuron with some bonus features:\n* Cell state propagated across time\n* Input, Output, Forget gates\n* Learns retention/discard of cell state\n* Admixture of new data\n* Output partly distinct from state\n* Use of __addition__ (not multiplication) to combine input and cell state allows state to propagate unimpeded across time (addition of gradient)\n\n---\n\n> __ASIDE: Variations on LSTM__\n\n> ... include \"peephole\" where gate functions have direct access to cell state; convolutional; and bidirectional, where we can \"cheat\" by letting neurons learn from future time steps and not just previous time steps.\n\n___\n\nSlow down ... exactly what's getting added to where? For a step-by-step walk through, read Chris Olah's full post http://colah.github.io/posts/2015-08-Understanding-LSTMs/ \n\n\n### Do LSTMs Work Reasonably Well?\n\n__Yes!__ These architectures are in production (2017) for deep-learning-enabled products at Baidu, Google, Microsoft, Apple, and elsewhere. They are used to solve problems in time series analysis, speech recognition and generation, connected handwriting, grammar, music, and robot control systems.\n\n### Let's Code an LSTM Variant of our Sequence Lab\n\n(this great demo example courtesy of Jason Brownlee: http://machinelearningmastery.com/understanding-stateful-lstm-recurrent-neural-networks-python-keras/)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"a562a2f5-77e4-4882-8045-d72cd7f087a7"},{"version":"CommandV1","origId":216731,"guid":"d20bd3ad-4e90-4793-8be0-1930ce4d1e95","subtype":"command","commandType":"auto","position":6.0,"command":"import numpy\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM\nfrom keras.utils import np_utils\n\nalphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nchar_to_int = dict((c, i) for i, c in enumerate(alphabet))\nint_to_char = dict((i, c) for i, c in enumerate(alphabet))\n\nseq_length = 3\ndataX = []\ndataY = []\nfor i in range(0, len(alphabet) - seq_length, 1):\n\tseq_in = alphabet[i:i + seq_length]\n\tseq_out = alphabet[i + seq_length]\n\tdataX.append([char_to_int[char] for char in seq_in])\n\tdataY.append(char_to_int[seq_out])\n\tprint (seq_in, '->', seq_out)\n\n# reshape X to be .......[samples, time steps, features]\nX = numpy.reshape(dataX, (len(dataX), seq_length, 1))\nX = X / float(len(alphabet))\ny = np_utils.to_categorical(dataY)\n\n# Let’s define an LSTM network with 32 units and an output layer with a softmax activation function for making predictions. \n# a naive implementation of LSTM\nmodel = Sequential()\nmodel.add(LSTM(32, input_shape=(X.shape[1], X.shape[2]))) # <- LSTM layer...\nmodel.add(Dense(y.shape[1], activation='softmax'))\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\nmodel.fit(X, y, epochs=400, batch_size=1, verbose=2)\n\nscores = model.evaluate(X, y)\nprint(\"Model Accuracy: %.2f%%\" % (scores[1]*100))\n\nfor pattern in dataX:\n\tx = numpy.reshape(pattern, (1, len(pattern), 1))\n\tx = x / float(len(alphabet))\n\tprediction = model.predict(x, verbose=0)\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tprint (seq_in, \"->\", result)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;ABC&apos;, &apos;-&gt;&apos;, &apos;D&apos;)\n(&apos;BCD&apos;, &apos;-&gt;&apos;, &apos;E&apos;)\n(&apos;CDE&apos;, &apos;-&gt;&apos;, &apos;F&apos;)\n(&apos;DEF&apos;, &apos;-&gt;&apos;, &apos;G&apos;)\n(&apos;EFG&apos;, &apos;-&gt;&apos;, &apos;H&apos;)\n(&apos;FGH&apos;, &apos;-&gt;&apos;, &apos;I&apos;)\n(&apos;GHI&apos;, &apos;-&gt;&apos;, &apos;J&apos;)\n(&apos;HIJ&apos;, &apos;-&gt;&apos;, &apos;K&apos;)\n(&apos;IJK&apos;, &apos;-&gt;&apos;, &apos;L&apos;)\n(&apos;JKL&apos;, &apos;-&gt;&apos;, &apos;M&apos;)\n(&apos;KLM&apos;, &apos;-&gt;&apos;, &apos;N&apos;)\n(&apos;LMN&apos;, &apos;-&gt;&apos;, &apos;O&apos;)\n(&apos;MNO&apos;, &apos;-&gt;&apos;, &apos;P&apos;)\n(&apos;NOP&apos;, &apos;-&gt;&apos;, &apos;Q&apos;)\n(&apos;OPQ&apos;, &apos;-&gt;&apos;, &apos;R&apos;)\n(&apos;PQR&apos;, &apos;-&gt;&apos;, &apos;S&apos;)\n(&apos;QRS&apos;, &apos;-&gt;&apos;, &apos;T&apos;)\n(&apos;RST&apos;, &apos;-&gt;&apos;, &apos;U&apos;)\n(&apos;STU&apos;, &apos;-&gt;&apos;, &apos;V&apos;)\n(&apos;TUV&apos;, &apos;-&gt;&apos;, &apos;W&apos;)\n(&apos;UVW&apos;, &apos;-&gt;&apos;, &apos;X&apos;)\n(&apos;VWX&apos;, &apos;-&gt;&apos;, &apos;Y&apos;)\n(&apos;WXY&apos;, &apos;-&gt;&apos;, &apos;Z&apos;)\nEpoch 1/400\n0s - loss: 3.2743 - acc: 0.0435\nEpoch 2/400\n0s - loss: 3.2586 - acc: 0.0000e+00\nEpoch 3/400\n0s - loss: 3.2516 - acc: 0.0435\nEpoch 4/400\n0s - loss: 3.2441 - acc: 0.0435\nEpoch 5/400\n0s - loss: 3.2361 - acc: 0.0435\nEpoch 6/400\n0s - loss: 3.2288 - acc: 0.0435\nEpoch 7/400\n0s - loss: 3.2203 - acc: 0.0435\nEpoch 8/400\n0s - loss: 3.2117 - acc: 0.0435\nEpoch 9/400\n0s - loss: 3.2021 - acc: 0.0435\nEpoch 10/400\n0s - loss: 3.1926 - acc: 0.0435\nEpoch 11/400\n0s - loss: 3.1793 - acc: 0.0000e+00\nEpoch 12/400\n0s - loss: 3.1653 - acc: 0.0000e+00\nEpoch 13/400\n0s - loss: 3.1483 - acc: 0.0435\nEpoch 14/400\n0s - loss: 3.1319 - acc: 0.0435\nEpoch 15/400\n0s - loss: 3.1135 - acc: 0.0435\nEpoch 16/400\n0s - loss: 3.0969 - acc: 0.0435\nEpoch 17/400\n0s - loss: 3.0802 - acc: 0.0435\nEpoch 18/400\n0s - loss: 3.0600 - acc: 0.0435\nEpoch 19/400\n0s - loss: 3.0419 - acc: 0.0435\nEpoch 20/400\n0s - loss: 3.0283 - acc: 0.0435\nEpoch 21/400\n0s - loss: 3.0073 - acc: 0.0435\nEpoch 22/400\n0s - loss: 2.9810 - acc: 0.0435\nEpoch 23/400\n0s - loss: 2.9582 - acc: 0.0870\nEpoch 24/400\n0s - loss: 2.9321 - acc: 0.0870\nEpoch 25/400\n0s - loss: 2.9076 - acc: 0.1304\nEpoch 26/400\n0s - loss: 2.8777 - acc: 0.1304\nEpoch 27/400\n0s - loss: 2.8500 - acc: 0.1304\nEpoch 28/400\n0s - loss: 2.8169 - acc: 0.0870\nEpoch 29/400\n0s - loss: 2.7848 - acc: 0.0870\nEpoch 30/400\n0s - loss: 2.7524 - acc: 0.0870\nEpoch 31/400\n0s - loss: 2.7157 - acc: 0.1304\nEpoch 32/400\n0s - loss: 2.6844 - acc: 0.0870\nEpoch 33/400\n0s - loss: 2.6552 - acc: 0.0435\nEpoch 34/400\n0s - loss: 2.6242 - acc: 0.0870\nEpoch 35/400\n0s - loss: 2.5939 - acc: 0.0870\nEpoch 36/400\n0s - loss: 2.5631 - acc: 0.1739\nEpoch 37/400\n0s - loss: 2.5370 - acc: 0.1304\nEpoch 38/400\n0s - loss: 2.5116 - acc: 0.0435\nEpoch 39/400\n0s - loss: 2.4850 - acc: 0.0870\nEpoch 40/400\n0s - loss: 2.4573 - acc: 0.0870\nEpoch 41/400\n0s - loss: 2.4295 - acc: 0.1304\nEpoch 42/400\n0s - loss: 2.4097 - acc: 0.0870\nEpoch 43/400\n0s - loss: 2.3830 - acc: 0.0870\nEpoch 44/400\n0s - loss: 2.3630 - acc: 0.1739\nEpoch 45/400\n0s - loss: 2.3409 - acc: 0.1739\nEpoch 46/400\n0s - loss: 2.3123 - acc: 0.1739\nEpoch 47/400\n0s - loss: 2.2926 - acc: 0.2174\nEpoch 48/400\n0s - loss: 2.2692 - acc: 0.2174\nEpoch 49/400\n0s - loss: 2.2514 - acc: 0.1739\nEpoch 50/400\n0s - loss: 2.2240 - acc: 0.2174\nEpoch 51/400\n0s - loss: 2.2059 - acc: 0.3043\nEpoch 52/400\n0s - loss: 2.1808 - acc: 0.1739\nEpoch 53/400\n0s - loss: 2.1677 - acc: 0.2609\nEpoch 54/400\n0s - loss: 2.1425 - acc: 0.2174\nEpoch 55/400\n0s - loss: 2.1271 - acc: 0.2609\nEpoch 56/400\n0s - loss: 2.1025 - acc: 0.2174\nEpoch 57/400\n0s - loss: 2.0917 - acc: 0.1739\nEpoch 58/400\n0s - loss: 2.0679 - acc: 0.3043\nEpoch 59/400\n0s - loss: 2.0529 - acc: 0.2609\nEpoch 60/400\n0s - loss: 2.0383 - acc: 0.3043\nEpoch 61/400\n0s - loss: 2.0245 - acc: 0.2609\nEpoch 62/400\n0s - loss: 1.9908 - acc: 0.2609\nEpoch 63/400\n0s - loss: 1.9841 - acc: 0.2174\nEpoch 64/400\n0s - loss: 1.9660 - acc: 0.2609\nEpoch 65/400\n0s - loss: 1.9557 - acc: 0.3043\nEpoch 66/400\n0s - loss: 1.9353 - acc: 0.3478\nEpoch 67/400\n0s - loss: 1.9223 - acc: 0.3043\nEpoch 68/400\n0s - loss: 1.9027 - acc: 0.3913\nEpoch 69/400\n0s - loss: 1.8819 - acc: 0.4783\nEpoch 70/400\n0s - loss: 1.8755 - acc: 0.4348\nEpoch 71/400\n0s - loss: 1.8581 - acc: 0.3913\nEpoch 72/400\n0s - loss: 1.8466 - acc: 0.3478\nEpoch 73/400\n0s - loss: 1.8299 - acc: 0.3478\nEpoch 74/400\n0s - loss: 1.8144 - acc: 0.4348\nEpoch 75/400\n0s - loss: 1.7991 - acc: 0.4783\nEpoch 76/400\n0s - loss: 1.7894 - acc: 0.4348\nEpoch 77/400\n0s - loss: 1.7762 - acc: 0.3913\nEpoch 78/400\n0s - loss: 1.7623 - acc: 0.3913\nEpoch 79/400\n0s - loss: 1.7544 - acc: 0.5217\nEpoch 80/400\n0s - loss: 1.7341 - acc: 0.6522\nEpoch 81/400\n0s - loss: 1.7215 - acc: 0.4783\nEpoch 82/400\n0s - loss: 1.7217 - acc: 0.4348\nEpoch 83/400\n0s - loss: 1.7050 - acc: 0.4348\nEpoch 84/400\n0s - loss: 1.6934 - acc: 0.3913\nEpoch 85/400\n0s - loss: 1.6764 - acc: 0.5217\nEpoch 86/400\n0s - loss: 1.6713 - acc: 0.4783\nEpoch 87/400\n0s - loss: 1.6584 - acc: 0.4348\nEpoch 88/400\n0s - loss: 1.6584 - acc: 0.4783\nEpoch 89/400\n0s - loss: 1.6426 - acc: 0.6522\nEpoch 90/400\n0s - loss: 1.6340 - acc: 0.5652\nEpoch 91/400\n0s - loss: 1.6225 - acc: 0.5652\nEpoch 92/400\n0s - loss: 1.6102 - acc: 0.6087\nEpoch 93/400\n0s - loss: 1.6009 - acc: 0.6522\nEpoch 94/400\n0s - loss: 1.6024 - acc: 0.4783\nEpoch 95/400\n0s - loss: 1.5845 - acc: 0.5652\nEpoch 96/400\n0s - loss: 1.5774 - acc: 0.6087\nEpoch 97/400\n0s - loss: 1.5728 - acc: 0.5217\nEpoch 98/400\n0s - loss: 1.5606 - acc: 0.6522\nEpoch 99/400\n0s - loss: 1.5581 - acc: 0.6087\nEpoch 100/400\n0s - loss: 1.5504 - acc: 0.5217\nEpoch 101/400\n0s - loss: 1.5345 - acc: 0.6522\nEpoch 102/400\n0s - loss: 1.5317 - acc: 0.6087\nEpoch 103/400\n0s - loss: 1.5255 - acc: 0.6522\nEpoch 104/400\n0s - loss: 1.5155 - acc: 0.6087\nEpoch 105/400\n0s - loss: 1.5071 - acc: 0.6087\nEpoch 106/400\n0s - loss: 1.4973 - acc: 0.6522\nEpoch 107/400\n0s - loss: 1.4914 - acc: 0.6087\nEpoch 108/400\n0s - loss: 1.4756 - acc: 0.6957\nEpoch 109/400\n0s - loss: 1.4717 - acc: 0.6522\nEpoch 110/400\n0s - loss: 1.4654 - acc: 0.6522\nEpoch 111/400\n0s - loss: 1.4631 - acc: 0.6522\nEpoch 112/400\n0s - loss: 1.4436 - acc: 0.6087\nEpoch 113/400\n0s - loss: 1.4416 - acc: 0.6087\nEpoch 114/400\n0s - loss: 1.4367 - acc: 0.6522\nEpoch 115/400\n0s - loss: 1.4240 - acc: 0.6522\nEpoch 116/400\n0s - loss: 1.4160 - acc: 0.6522\nEpoch 117/400\n0s - loss: 1.4207 - acc: 0.7391\nEpoch 118/400\n0s - loss: 1.4087 - acc: 0.6957\nEpoch 119/400\n0s - loss: 1.3908 - acc: 0.8261\nEpoch 120/400\n0s - loss: 1.4012 - acc: 0.6957\nEpoch 121/400\n0s - loss: 1.3864 - acc: 0.7391\nEpoch 122/400\n0s - loss: 1.3738 - acc: 0.7391\nEpoch 123/400\n0s - loss: 1.3751 - acc: 0.7391\nEpoch 124/400\n0s - loss: 1.3631 - acc: 0.7391\nEpoch 125/400\n0s - loss: 1.3601 - acc: 0.6957\nEpoch 126/400\n0s - loss: 1.3559 - acc: 0.7391\nEpoch 127/400\n0s - loss: 1.3523 - acc: 0.6522\nEpoch 128/400\n0s - loss: 1.3407 - acc: 0.8261\nEpoch 129/400\n0s - loss: 1.3344 - acc: 0.7826\nEpoch 130/400\n0s - loss: 1.3207 - acc: 0.7391\nEpoch 131/400\n0s - loss: 1.3185 - acc: 0.6522\nEpoch 132/400\n0s - loss: 1.3149 - acc: 0.7391\nEpoch 133/400\n0s - loss: 1.3060 - acc: 0.7826\nEpoch 134/400\n0s - loss: 1.2958 - acc: 0.8261\nEpoch 135/400\n0s - loss: 1.2924 - acc: 0.7826\nEpoch 136/400\n0s - loss: 1.2810 - acc: 0.7826\nEpoch 137/400\n0s - loss: 1.2812 - acc: 0.7826\nEpoch 138/400\n0s - loss: 1.2766 - acc: 0.7826\nEpoch 139/400\n0s - loss: 1.2774 - acc: 0.7391\nEpoch 140/400\n0s - loss: 1.2650 - acc: 0.7826\nEpoch 141/400\n0s - loss: 1.2537 - acc: 0.6957\nEpoch 142/400\n0s - loss: 1.2554 - acc: 0.7391\nEpoch 143/400\n0s - loss: 1.2400 - acc: 0.7826\nEpoch 144/400\n0s - loss: 1.2441 - acc: 0.7826\nEpoch 145/400\n0s - loss: 1.2429 - acc: 0.7391\nEpoch 146/400\n0s - loss: 1.2346 - acc: 0.7826\nEpoch 147/400\n0s - loss: 1.2283 - acc: 0.7391\nEpoch 148/400\n0s - loss: 1.2205 - acc: 0.7826\nEpoch 149/400\n0s - loss: 1.2170 - acc: 0.8261\nEpoch 150/400\n0s - loss: 1.2034 - acc: 0.8261\nEpoch 151/400\n0s - loss: 1.1980 - acc: 0.8696\nEpoch 152/400\n0s - loss: 1.1997 - acc: 0.7826\nEpoch 153/400\n0s - loss: 1.1896 - acc: 0.8261\nEpoch 154/400\n0s - loss: 1.1875 - acc: 0.7826\nEpoch 155/400\n0s - loss: 1.1804 - acc: 0.7826\nEpoch 156/400\n0s - loss: 1.1722 - acc: 0.7391\nEpoch 157/400\n0s - loss: 1.1683 - acc: 0.7826\nEpoch 158/400\n0s - loss: 1.1695 - acc: 0.7826\nEpoch 159/400\n0s - loss: 1.1658 - acc: 0.8696\nEpoch 160/400\n0s - loss: 1.1545 - acc: 0.8696\nEpoch 161/400\n0s - loss: 1.1484 - acc: 0.7826\nEpoch 162/400\n0s - loss: 1.1481 - acc: 0.8261\nEpoch 163/400\n0s - loss: 1.1380 - acc: 0.9130\nEpoch 164/400\n0s - loss: 1.1335 - acc: 0.9130\nEpoch 165/400\n0s - loss: 1.1334 - acc: 0.8696\nEpoch 166/400\n0s - loss: 1.1307 - acc: 0.8261\nEpoch 167/400\n0s - loss: 1.1232 - acc: 0.8261\nEpoch 168/400\n0s - loss: 1.1192 - acc: 0.8261\nEpoch 169/400\n0s - loss: 1.1100 - acc: 0.8696\nEpoch 170/400\n0s - loss: 1.1034 - acc: 0.9130\nEpoch 171/400\n0s - loss: 1.1050 - acc: 0.8261\nEpoch 172/400\n0s - loss: 1.0945 - acc: 0.9130\nEpoch 173/400\n0s - loss: 1.0874 - acc: 0.8696\nEpoch 174/400\n0s - loss: 1.0870 - acc: 0.9130\nEpoch 175/400\n0s - loss: 1.0844 - acc: 0.8696\nEpoch 176/400\n0s - loss: 1.0787 - acc: 0.7826\nEpoch 177/400\n0s - loss: 1.0700 - acc: 0.9130\nEpoch 178/400\n0s - loss: 1.0641 - acc: 0.7826\nEpoch 179/400\n0s - loss: 1.0618 - acc: 0.8696\nEpoch 180/400\n0s - loss: 1.0549 - acc: 0.9130\nEpoch 181/400\n0s - loss: 1.0520 - acc: 0.8696\nEpoch 182/400\n0s - loss: 1.0470 - acc: 0.9130\nEpoch 183/400\n0s - loss: 1.0408 - acc: 0.8261\nEpoch 184/400\n0s - loss: 1.0369 - acc: 0.8261\nEpoch 185/400\n0s - loss: 1.0347 - acc: 0.8261\nEpoch 186/400\n0s - loss: 1.0267 - acc: 0.9130\nEpoch 187/400\n0s - loss: 1.0250 - acc: 0.8696\nEpoch 188/400\n0s - loss: 1.0177 - acc: 0.9130\nEpoch 189/400\n0s - loss: 1.0121 - acc: 0.8696\nEpoch 190/400\n0s - loss: 1.0109 - acc: 0.9130\nEpoch 191/400\n0s - loss: 1.0108 - acc: 0.9130\nEpoch 192/400\n0s - loss: 0.9983 - acc: 0.8696\nEpoch 193/400\n0s - loss: 1.0024 - acc: 0.9130\nEpoch 194/400\n0s - loss: 0.9909 - acc: 0.9565\nEpoch 195/400\n0s - loss: 0.9919 - acc: 0.9130\nEpoch 196/400\n0s - loss: 0.9900 - acc: 0.8696\nEpoch 197/400\n0s - loss: 0.9831 - acc: 0.9130\nEpoch 198/400\n0s - loss: 0.9760 - acc: 0.9130\nEpoch 199/400\n0s - loss: 0.9719 - acc: 0.8261\nEpoch 200/400\n0s - loss: 0.9693 - acc: 0.8696\nEpoch 201/400\n0s - loss: 0.9626 - acc: 0.8696\nEpoch 202/400\n0s - loss: 0.9559 - acc: 0.9130\nEpoch 203/400\n0s - loss: 0.9547 - acc: 0.9130\nEpoch 204/400\n0s - loss: 0.9546 - acc: 0.8261\nEpoch 205/400\n0s - loss: 0.9417 - acc: 0.8696\nEpoch 206/400\n0s - loss: 0.9437 - acc: 0.8696\nEpoch 207/400\n0s - loss: 0.9479 - acc: 0.9130\nEpoch 208/400\n0s - loss: 0.9315 - acc: 0.9130\nEpoch 209/400\n0s - loss: 0.9294 - acc: 0.8696\nEpoch 210/400\n0s - loss: 0.9275 - acc: 0.9130\nEpoch 211/400\n0s - loss: 0.9209 - acc: 0.9130\nEpoch 212/400\n0s - loss: 0.9140 - acc: 0.8261\nEpoch 213/400\n0s - loss: 0.9152 - acc: 0.8261\nEpoch 214/400\n0s - loss: 0.9085 - acc: 0.9565\nEpoch 215/400\n0s - loss: 0.9109 - acc: 0.9130\nEpoch 216/400\n0s - loss: 0.8986 - acc: 0.9565\nEpoch 217/400\n0s - loss: 0.9070 - acc: 0.8696\nEpoch 218/400\n0s - loss: 0.8911 - acc: 0.8696\nEpoch 219/400\n0s - loss: 0.8951 - acc: 0.8261\nEpoch 220/400\n0s - loss: 0.8834 - acc: 0.9130\nEpoch 221/400\n0s - loss: 0.8808 - acc: 0.9130\nEpoch 222/400\n0s - loss: 0.8745 - acc: 0.8261\nEpoch 223/400\n0s - loss: 0.8695 - acc: 0.8696\nEpoch 224/400\n0s - loss: 0.8679 - acc: 0.8696\nEpoch 225/400\n0s - loss: 0.8731 - acc: 0.8696\nEpoch 226/400\n0s - loss: 0.8598 - acc: 0.8696\nEpoch 227/400\n0s - loss: 0.8542 - acc: 0.9565\nEpoch 228/400\n0s - loss: 0.8545 - acc: 0.9565\nEpoch 229/400\n0s - loss: 0.8501 - acc: 0.9130\nEpoch 230/400\n0s - loss: 0.8572 - acc: 0.9565\nEpoch 231/400\n0s - loss: 0.8541 - acc: 0.8696\nEpoch 232/400\n0s - loss: 0.8435 - acc: 0.9130\nEpoch 233/400\n0s - loss: 0.8386 - acc: 0.9130\nEpoch 234/400\n0s - loss: 0.8345 - acc: 0.8261\nEpoch 235/400\n0s - loss: 0.8275 - acc: 0.9130\nEpoch 236/400\n0s - loss: 0.8183 - acc: 0.9565\nEpoch 237/400\n0s - loss: 0.8159 - acc: 0.9130\nEpoch 238/400\n0s - loss: 0.8180 - acc: 0.9130\nEpoch 239/400\n0s - loss: 0.8133 - acc: 0.9565\nEpoch 240/400\n0s - loss: 0.8061 - acc: 0.9565\nEpoch 241/400\n0s - loss: 0.8066 - acc: 0.8696\nEpoch 242/400\n0s - loss: 0.8010 - acc: 0.9565\nEpoch 243/400\n0s - loss: 0.7944 - acc: 0.8696\nEpoch 244/400\n0s - loss: 0.7976 - acc: 0.8696\nEpoch 245/400\n0s - loss: 0.7874 - acc: 0.8696\nEpoch 246/400\n0s - loss: 0.7844 - acc: 0.9130\nEpoch 247/400\n0s - loss: 0.7784 - acc: 0.9130\nEpoch 248/400\n0s - loss: 0.7813 - acc: 0.8696\nEpoch 249/400\n0s - loss: 0.7746 - acc: 0.8696\nEpoch 250/400\n0s - loss: 0.7759 - acc: 0.8696\nEpoch 251/400\n0s - loss: 0.7639 - acc: 0.9130\nEpoch 252/400\n0s - loss: 0.7679 - acc: 0.9130\nEpoch 253/400\n0s - loss: 0.7583 - acc: 0.9565\nEpoch 254/400\n0s - loss: 0.7524 - acc: 0.9565\nEpoch 255/400\n0s - loss: 0.7491 - acc: 0.9130\nEpoch 256/400\n0s - loss: 0.7545 - acc: 0.9565\nEpoch 257/400\n0s - loss: 0.7560 - acc: 0.9565\nEpoch 258/400\n0s - loss: 0.7480 - acc: 0.8696\nEpoch 259/400\n0s - loss: 0.7346 - acc: 0.9130\nEpoch 260/400\n0s - loss: 0.7394 - acc: 0.9565\nEpoch 261/400\n0s - loss: 0.7319 - acc: 0.9565\nEpoch 262/400\n0s - loss: 0.7261 - acc: 0.9130\nEpoch 263/400\n0s - loss: 0.7262 - acc: 0.9565\nEpoch 264/400\n0s - loss: 0.7237 - acc: 0.9565\nEpoch 265/400\n0s - loss: 0.7194 - acc: 0.9565\nEpoch 266/400\n0s - loss: 0.7169 - acc: 0.9565\nEpoch 267/400\n0s - loss: 0.7194 - acc: 0.9130\nEpoch 268/400\n0s - loss: 0.7137 - acc: 0.9130\nEpoch 269/400\n0s - loss: 0.7024 - acc: 0.9130\nEpoch 270/400\n0s - loss: 0.6985 - acc: 1.0000\nEpoch 271/400\n0s - loss: 0.6999 - acc: 0.9130\nEpoch 272/400\n0s - loss: 0.6928 - acc: 0.9130\nEpoch 273/400\n0s - loss: 0.6908 - acc: 0.9130\nEpoch 274/400\n0s - loss: 0.6869 - acc: 0.9565\nEpoch 275/400\n0s - loss: 0.6850 - acc: 0.9565\nEpoch 276/400\n0s - loss: 0.6853 - acc: 0.9130\nEpoch 277/400\n0s - loss: 0.6771 - acc: 0.9565\nEpoch 278/400\n0s - loss: 0.6819 - acc: 0.9565\nEpoch 279/400\n0s - loss: 0.6730 - acc: 0.9130\nEpoch 280/400\n0s - loss: 0.6750 - acc: 0.9565\nEpoch 281/400\n0s - loss: 0.6668 - acc: 0.9565\nEpoch 282/400\n0s - loss: 0.6681 - acc: 0.9565\nEpoch 283/400\n0s - loss: 0.6619 - acc: 0.9130\nEpoch 284/400\n0s - loss: 0.6566 - acc: 0.9130\nEpoch 285/400\n0s - loss: 0.6577 - acc: 0.9565\nEpoch 286/400\n0s - loss: 0.6541 - acc: 0.9130\nEpoch 287/400\n0s - loss: 0.6557 - acc: 0.9130\nEpoch 288/400\n0s - loss: 0.6504 - acc: 0.9565\nEpoch 289/400\n0s - loss: 0.6478 - acc: 0.9565\nEpoch 290/400\n0s - loss: 0.6401 - acc: 0.9130\nEpoch 291/400\n0s - loss: 0.6375 - acc: 0.9130\nEpoch 292/400\n0s - loss: 0.6381 - acc: 0.9130\nEpoch 293/400\n0s - loss: 0.6302 - acc: 0.9130\nEpoch 294/400\n0s - loss: 0.6268 - acc: 0.9565\nEpoch 295/400\n0s - loss: 0.6243 - acc: 0.9565\nEpoch 296/400\n0s - loss: 0.6259 - acc: 1.0000\nEpoch 297/400\n0s - loss: 0.6258 - acc: 0.9130\nEpoch 298/400\n0s - loss: 0.6176 - acc: 0.9565\nEpoch 299/400\n0s - loss: 0.6166 - acc: 0.9565\nEpoch 300/400\n0s - loss: 0.6122 - acc: 0.9565\nEpoch 301/400\n0s - loss: 0.6079 - acc: 1.0000\nEpoch 302/400\n0s - loss: 0.6090 - acc: 0.9130\nEpoch 303/400\n0s - loss: 0.6068 - acc: 1.0000\nEpoch 304/400\n0s - loss: 0.6046 - acc: 0.9130\nEpoch 305/400\n0s - loss: 0.5953 - acc: 0.9130\nEpoch 306/400\n0s - loss: 0.5975 - acc: 0.9565\nEpoch 307/400\n0s - loss: 0.5980 - acc: 0.9130\nEpoch 308/400\n0s - loss: 0.5904 - acc: 0.9130\nEpoch 309/400\n0s - loss: 0.5873 - acc: 0.9565\nEpoch 310/400\n0s - loss: 0.5882 - acc: 0.9130\nEpoch 311/400\n0s - loss: 0.5809 - acc: 0.9565\nEpoch 312/400\n0s - loss: 0.5785 - acc: 1.0000\nEpoch 313/400\n0s - loss: 0.5739 - acc: 1.0000\nEpoch 314/400\n0s - loss: 0.5763 - acc: 0.9130\nEpoch 315/400\n0s - loss: 0.5720 - acc: 0.9130\nEpoch 316/400\n0s - loss: 0.5694 - acc: 1.0000\nEpoch 317/400\n0s - loss: 0.5692 - acc: 0.9565\nEpoch 318/400\n0s - loss: 0.5673 - acc: 0.9565\nEpoch 319/400\n0s - loss: 0.5622 - acc: 0.9565\nEpoch 320/400\n0s - loss: 0.5620 - acc: 0.9565\nEpoch 321/400\n0s - loss: 0.5639 - acc: 0.9565\nEpoch 322/400\n0s - loss: 0.5637 - acc: 1.0000\nEpoch 323/400\n0s - loss: 0.5539 - acc: 0.9130\nEpoch 324/400\n0s - loss: 0.5500 - acc: 0.9130\nEpoch 325/400\n0s - loss: 0.5503 - acc: 0.9565\nEpoch 326/400\n0s - loss: 0.5500 - acc: 1.0000\nEpoch 327/400\n0s - loss: 0.5457 - acc: 0.9130\nEpoch 328/400\n0s - loss: 0.5495 - acc: 0.9130\nEpoch 329/400\n0s - loss: 0.5386 - acc: 0.9565\nEpoch 330/400\n0s - loss: 0.5372 - acc: 0.9565\nEpoch 331/400\n0s - loss: 0.5326 - acc: 1.0000\nEpoch 332/400\n0s - loss: 0.5325 - acc: 0.9565\nEpoch 333/400\n0s - loss: 0.5314 - acc: 1.0000\nEpoch 334/400\n0s - loss: 0.5308 - acc: 1.0000\nEpoch 335/400\n0s - loss: 0.5222 - acc: 1.0000\nEpoch 336/400\n0s - loss: 0.5188 - acc: 1.0000\nEpoch 337/400\n0s - loss: 0.5223 - acc: 0.9565\nEpoch 338/400\n0s - loss: 0.5160 - acc: 0.9130\nEpoch 339/400\n0s - loss: 0.5225 - acc: 0.9130\nEpoch 340/400\n0s - loss: 0.5185 - acc: 0.9565\nEpoch 341/400\n0s - loss: 0.5132 - acc: 0.9565\nEpoch 342/400\n0s - loss: 0.5172 - acc: 1.0000\nEpoch 343/400\n0s - loss: 0.5129 - acc: 1.0000\nEpoch 344/400\n0s - loss: 0.5087 - acc: 0.9565\nEpoch 345/400\n0s - loss: 0.5109 - acc: 0.9130\nEpoch 346/400\n0s - loss: 0.5060 - acc: 0.9565\nEpoch 347/400\n0s - loss: 0.5037 - acc: 0.9565\nEpoch 348/400\n0s - loss: 0.5007 - acc: 0.9565\nEpoch 349/400\n0s - loss: 0.4991 - acc: 0.9565\nEpoch 350/400\n0s - loss: 0.4937 - acc: 0.9565\nEpoch 351/400\n0s - loss: 0.4909 - acc: 0.9565\nEpoch 352/400\n0s - loss: 0.4932 - acc: 1.0000\nEpoch 353/400\n0s - loss: 0.4860 - acc: 0.9565\nEpoch 354/400\n0s - loss: 0.4910 - acc: 0.9565\nEpoch 355/400\n0s - loss: 0.4851 - acc: 1.0000\nEpoch 356/400\n0s - loss: 0.4872 - acc: 0.9130\nEpoch 357/400\n0s - loss: 0.4806 - acc: 1.0000\nEpoch 358/400\n0s - loss: 0.4778 - acc: 0.9565\nEpoch 359/400\n0s - loss: 0.4817 - acc: 1.0000\nEpoch 360/400\n0s - loss: 0.4736 - acc: 0.9565\nEpoch 361/400\n0s - loss: 0.4748 - acc: 1.0000\nEpoch 362/400\n0s - loss: 0.4734 - acc: 1.0000\nEpoch 363/400\n0s - loss: 0.4729 - acc: 1.0000\nEpoch 364/400\n0s - loss: 0.4739 - acc: 0.9565\nEpoch 365/400\n0s - loss: 0.4714 - acc: 0.9565\nEpoch 366/400\n0s - loss: 0.4665 - acc: 0.9130\nEpoch 367/400\n0s - loss: 0.4648 - acc: 1.0000\nEpoch 368/400\n0s - loss: 0.4696 - acc: 0.9565\nEpoch 369/400\n0s - loss: 0.4650 - acc: 0.9130\nEpoch 370/400\n0s - loss: 0.4579 - acc: 0.9565\nEpoch 371/400\n0s - loss: 0.4562 - acc: 1.0000\nEpoch 372/400\n0s - loss: 0.4562 - acc: 1.0000\nEpoch 373/400\n0s - loss: 0.4575 - acc: 0.9565\nEpoch 374/400\n0s - loss: 0.4541 - acc: 0.9130\nEpoch 375/400\n0s - loss: 0.4528 - acc: 1.0000\nEpoch 376/400\n0s - loss: 0.4483 - acc: 1.0000\nEpoch 377/400\n0s - loss: 0.4477 - acc: 1.0000\nEpoch 378/400\n0s - loss: 0.4482 - acc: 0.9565\nEpoch 379/400\n0s - loss: 0.4422 - acc: 0.9565\nEpoch 380/400\n0s - loss: 0.4400 - acc: 0.9565\nEpoch 381/400\n0s - loss: 0.4416 - acc: 1.0000\nEpoch 382/400\n0s - loss: 0.4365 - acc: 1.0000\nEpoch 383/400\n0s - loss: 0.4410 - acc: 1.0000\nEpoch 384/400\n0s - loss: 0.4383 - acc: 1.0000\nEpoch 385/400\n0s - loss: 0.4348 - acc: 0.9565\nEpoch 386/400\n0s - loss: 0.4353 - acc: 1.0000\nEpoch 387/400\n0s - loss: 0.4314 - acc: 0.9130\nEpoch 388/400\n0s - loss: 0.4381 - acc: 0.9565\nEpoch 389/400\n0s - loss: 0.4314 - acc: 1.0000\nEpoch 390/400\n0s - loss: 0.4319 - acc: 0.9130\nEpoch 391/400\n0s - loss: 0.4292 - acc: 0.9565\nEpoch 392/400\n0s - loss: 0.4490 - acc: 0.9565\nEpoch 393/400\n0s - loss: 0.4347 - acc: 0.9565\nEpoch 394/400\n0s - loss: 0.4517 - acc: 0.9565\nEpoch 395/400\n0s - loss: 0.4294 - acc: 0.9130\nEpoch 396/400\n0s - loss: 0.4178 - acc: 0.9565\nEpoch 397/400\n0s - loss: 0.4142 - acc: 0.9565\nEpoch 398/400\n0s - loss: 0.4175 - acc: 1.0000\nEpoch 399/400\n0s - loss: 0.4123 - acc: 1.0000\nEpoch 400/400\n0s - loss: 0.4123 - acc: 0.9565\n\r23/23 [==============================] - 0s\nModel Accuracy: 100.00%\n([&apos;A&apos;, &apos;B&apos;, &apos;C&apos;], &apos;-&gt;&apos;, &apos;D&apos;)\n([&apos;B&apos;, &apos;C&apos;, &apos;D&apos;], &apos;-&gt;&apos;, &apos;E&apos;)\n([&apos;C&apos;, &apos;D&apos;, &apos;E&apos;], &apos;-&gt;&apos;, &apos;F&apos;)\n([&apos;D&apos;, &apos;E&apos;, &apos;F&apos;], &apos;-&gt;&apos;, &apos;G&apos;)\n([&apos;E&apos;, &apos;F&apos;, &apos;G&apos;], &apos;-&gt;&apos;, &apos;H&apos;)\n([&apos;F&apos;, &apos;G&apos;, &apos;H&apos;], &apos;-&gt;&apos;, &apos;I&apos;)\n([&apos;G&apos;, &apos;H&apos;, &apos;I&apos;], &apos;-&gt;&apos;, &apos;J&apos;)\n([&apos;H&apos;, &apos;I&apos;, &apos;J&apos;], &apos;-&gt;&apos;, &apos;K&apos;)\n([&apos;I&apos;, &apos;J&apos;, &apos;K&apos;], &apos;-&gt;&apos;, &apos;L&apos;)\n([&apos;J&apos;, &apos;K&apos;, &apos;L&apos;], &apos;-&gt;&apos;, &apos;M&apos;)\n([&apos;K&apos;, &apos;L&apos;, &apos;M&apos;], &apos;-&gt;&apos;, &apos;N&apos;)\n([&apos;L&apos;, &apos;M&apos;, &apos;N&apos;], &apos;-&gt;&apos;, &apos;O&apos;)\n([&apos;M&apos;, &apos;N&apos;, &apos;O&apos;], &apos;-&gt;&apos;, &apos;P&apos;)\n([&apos;N&apos;, &apos;O&apos;, &apos;P&apos;], &apos;-&gt;&apos;, &apos;Q&apos;)\n([&apos;O&apos;, &apos;P&apos;, &apos;Q&apos;], &apos;-&gt;&apos;, &apos;R&apos;)\n([&apos;P&apos;, &apos;Q&apos;, &apos;R&apos;], &apos;-&gt;&apos;, &apos;S&apos;)\n([&apos;Q&apos;, &apos;R&apos;, &apos;S&apos;], &apos;-&gt;&apos;, &apos;T&apos;)\n([&apos;R&apos;, &apos;S&apos;, &apos;T&apos;], &apos;-&gt;&apos;, &apos;U&apos;)\n([&apos;S&apos;, &apos;T&apos;, &apos;U&apos;], &apos;-&gt;&apos;, &apos;V&apos;)\n([&apos;T&apos;, &apos;U&apos;, &apos;V&apos;], &apos;-&gt;&apos;, &apos;W&apos;)\n([&apos;U&apos;, &apos;V&apos;, &apos;W&apos;], &apos;-&gt;&apos;, &apos;X&apos;)\n([&apos;V&apos;, &apos;W&apos;, &apos;X&apos;], &apos;-&gt;&apos;, &apos;Y&apos;)\n([&apos;W&apos;, &apos;X&apos;, &apos;Y&apos;], &apos;-&gt;&apos;, &apos;Z&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513238374651,"submitTime":1513238374640,"finishTime":1513238420073,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"deletable":true,"editable":true},"streamStates":{},"nuid":"8fb05a91-a7ab-4bfe-9e61-c21c8142fa58"},{"version":"CommandV1","origId":216732,"guid":"5bc6a950-df33-4bc9-9c77-eb4753857ad8","subtype":"command","commandType":"auto","position":6.5,"command":"(X.shape[1], X.shape[2]) # the input shape to LSTM layer with 32 neurons is given by dimensions of time-steps and features","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>(3, 1)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513238443717,"submitTime":1513238443711,"finishTime":1513238443742,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f78b9e78-b706-47e6-a4f7-b321e29ec4b3"},{"version":"CommandV1","origId":216733,"guid":"750c6b17-ca38-412d-a8da-f9e4b13f9df2","subtype":"command","commandType":"auto","position":6.75,"command":"X.shape[0], y.shape[1] # number of examples and number of categorical outputs","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>(23, 26)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513238604653,"submitTime":1513238604653,"finishTime":1513238604694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab709b93-ccbb-4561-8c51-689fb4dd6af5"},{"version":"CommandV1","origId":216734,"guid":"5cce9b63-a1a1-44e9-9dec-40e7a3c17aff","subtype":"command","commandType":"auto","position":7.0,"command":"%md \n__Memory and context__\n\nIf this network is learning the way we would like, it should be robust to noise and also understand the relative context (in this case, where a prior letter occurs in the sequence).\n\nI.e., we should be able to give it corrupted sequences, and it should produce reasonably correct predictions.\n\nMake the following change to the code to test this out:\n\n## You Try!\n* We'll use \"W\" for our erroneous/corrupted data element\n* Add code at the end to predict on the following sequences:\n    * 'WBC', 'WKL', 'WTU', 'DWF', 'MWO', 'VWW', 'GHW', 'JKW', 'PQW'\n* Notice any pattern? Hard to tell from a small sample, but if you play with it (trying sequences from different places in the alphabet, or different \"corruption\" letters, you'll notice patterns that give a hint at what the network is learning\n\nThe solution is in `060_DLByABr_05a-LSTM-Solution` if you are lazy right now or get stuck.\n\n__Pretty cool... BUT__\n\nThis alphabet example does seem a bit like \"tennis without the net\" since the original goal was to develop networks that could extract patterns from complex, ambiguous content like natural language or music, and we've been playing with a sequence (Roman alphabet) that is 100% deterministic and tiny in size.\n\nFirst, go ahead and start `061_DLByABr_05b-LSTM-Language` since it will take several minutes to produce its first output.\n\nThis latter script is taken 100% exactly as-is from the Keras library examples folder (https://github.com/fchollet/keras/blob/master/examples/lstm_text_generation.py) and uses precisely the logic we just learned, in order to learn and synthesize English language text from a single-author corpuse. The amazing thing is that the text is learned and generated one letter at a time, just like we did with the alphabet.\n\nCompared to our earlier examples...\n* there is a minor difference in the way the inputs are encoded, using 1-hot vectors\n* and there is a *significant* difference in the way the outputs (predictions) are generated: instead of taking just the most likely output class (character) via argmax as we did before, this time we are treating the output as a distribution and sampling from the distribution.\n\nLet's take a look at the code ... but even so, this will probably be something to come back to after fika or a long break, as the training takes about 5 minutes per epoch (late 2013 MBP CPU) and we need around 20 epochs (80 minutes!) to get good output.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"78d949cf-1659-4828-8def-f53608446e67"},{"version":"CommandV1","origId":216735,"guid":"e010c83e-67cf-469f-8395-2ec2b550ac8d","subtype":"command","commandType":"auto","position":8.0,"command":"import sys\nsys.exit(0) #just to keep from accidentally running this code (that is already in 061_DLByABr_05b-LSTM-Language) HERE\n\n'''Example script to generate text from Nietzsche's writings.\n\nAt least 20 epochs are required before the generated text\nstarts sounding coherent.\n\nIt is recommended to run this script on GPU, as recurrent\nnetworks are quite computationally intensive.\n\nIf you try this script on new data, make sure your corpus\nhas at least ~100k characters. ~1M is better.\n'''\n\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Activation\nfrom keras.layers import LSTM\nfrom keras.optimizers import RMSprop\nfrom keras.utils.data_utils import get_file\nimport numpy as np\nimport random\nimport sys\n\npath = \"../data/nietzsche.txt\"\ntext = open(path).read().lower()\nprint('corpus length:', len(text))\n\nchars = sorted(list(set(text)))\nprint('total chars:', len(chars))\nchar_indices = dict((c, i) for i, c in enumerate(chars))\nindices_char = dict((i, c) for i, c in enumerate(chars))\n\n# cut the text in semi-redundant sequences of maxlen characters\nmaxlen = 40\nstep = 3\nsentences = []\nnext_chars = []\nfor i in range(0, len(text) - maxlen, step):\n    sentences.append(text[i: i + maxlen])\n    next_chars.append(text[i + maxlen])\nprint('nb sequences:', len(sentences))\n\nprint('Vectorization...')\nX = np.zeros((len(sentences), maxlen, len(chars)), dtype=np.bool)\ny = np.zeros((len(sentences), len(chars)), dtype=np.bool)\nfor i, sentence in enumerate(sentences):\n    for t, char in enumerate(sentence):\n        X[i, t, char_indices[char]] = 1\n    y[i, char_indices[next_chars[i]]] = 1\n\n\n# build the model: a single LSTM\nprint('Build model...')\nmodel = Sequential()\nmodel.add(LSTM(128, input_shape=(maxlen, len(chars))))\nmodel.add(Dense(len(chars)))\nmodel.add(Activation('softmax'))\n\noptimizer = RMSprop(lr=0.01)\nmodel.compile(loss='categorical_crossentropy', optimizer=optimizer)\n\n\ndef sample(preds, temperature=1.0):\n    # helper function to sample an index from a probability array\n    preds = np.asarray(preds).astype('float64')\n    preds = np.log(preds) / temperature\n    exp_preds = np.exp(preds)\n    preds = exp_preds / np.sum(exp_preds)\n    probas = np.random.multinomial(1, preds, 1)\n    return np.argmax(probas)\n\n# train the model, output generated text after each iteration\nfor iteration in range(1, 60):\n    print()\n    print('-' * 50)\n    print('Iteration', iteration)\n    model.fit(X, y, batch_size=128, epochs=1)\n\n    start_index = random.randint(0, len(text) - maxlen - 1)\n\n    for diversity in [0.2, 0.5, 1.0, 1.2]:\n        print()\n        print('----- diversity:', diversity)\n\n        generated = ''\n        sentence = text[start_index: start_index + maxlen]\n        generated += sentence\n        print('----- Generating with seed: \"' + sentence + '\"')\n        sys.stdout.write(generated)\n\n        for i in range(400):\n            x = np.zeros((1, maxlen, len(chars)))\n            for t, char in enumerate(sentence):\n                x[0, t, char_indices[char]] = 1.\n\n            preds = model.predict(x, verbose=0)[0]\n            next_index = sample(preds, diversity)\n            next_char = indices_char[next_index]\n\n            generated += next_char\n            sentence = sentence[1:] + next_char\n\n            sys.stdout.write(next_char)\n            sys.stdout.flush()\n        print()","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"deletable":true,"editable":true},"streamStates":{},"nuid":"7ea70969-68ee-4a1d-af1c-728971e9deae"},{"version":"CommandV1","origId":216736,"guid":"2068913e-a732-444e-99f0-504ccf0f6746","subtype":"command","commandType":"auto","position":9.0,"command":"%md \n## Gated Recurrent Unit (GRU)\n\nIn 2014, a new, promising design for RNN units called Gated Recurrent Unit was published (https://arxiv.org/abs/1412.3555)\n\nGRUs have performed similarly to LSTMs, but are slightly simpler in design:\n\n* GRU has just two gates: \"update\" and \"reset\" (instead of the input, output, and forget in LSTM)\n* __update__ controls how to modify (weight and keep) cell state\n* __reset__ controls how new input is mixed (weighted) with/against memorized state\n* there is no output gate, so the cell state is propagated out -- i.e., there is __no \"hidden\" state__ that is separate from the generated output state\n\n<img src=\"http://i.imgur.com/nnATBmC.png\" width=700>\n\nWhich one should you use for which applications? The jury is still out -- this is an area for experimentation!\n\n### Using GRUs in Keras\n\n... is as simple as using the built-in GRU class (https://keras.io/layers/recurrent/)\n\nIf you are working with RNNs, spend some time with docs to go deeper, as we have just barely scratched the surface here, and there are many \"knobs\" to turn that will help things go right (or wrong).","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"0304cfc5-13eb-4311-941c-e97b982cac1b"},{"version":"CommandV1","origId":216737,"guid":"c1774cb6-5da8-423d-af8e-074924193fd5","subtype":"command","commandType":"auto","position":9.5,"command":"'''Example script to generate text from Nietzsche's writings.\n\nAt least 20 epochs are required before the generated text\nstarts sounding coherent.\n\nIt is recommended to run this script on GPU, as recurrent\nnetworks are quite computationally intensive.\n\nIf you try this script on new data, make sure your corpus\nhas at least ~100k characters. ~1M is better.\n'''\n\nfrom __future__ import print_function\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Activation\nfrom keras.layers import LSTM\nfrom keras.optimizers import RMSprop\nfrom keras.utils.data_utils import get_file\nimport numpy as np\nimport random\nimport sys\n\npath = get_file('nietzsche.txt', origin='https://s3.amazonaws.com/text-datasets/nietzsche.txt')\ntext = open(path).read().lower()\nprint('corpus length:', len(text))\n\nchars = sorted(list(set(text)))\nprint('total chars:', len(chars))\nchar_indices = dict((c, i) for i, c in enumerate(chars))\nindices_char = dict((i, c) for i, c in enumerate(chars))\n\n# cut the text in semi-redundant sequences of maxlen characters\nmaxlen = 40\nstep = 3\nsentences = []\nnext_chars = []\nfor i in range(0, len(text) - maxlen, step):\n    sentences.append(text[i: i + maxlen])\n    next_chars.append(text[i + maxlen])\nprint('nb sequences:', len(sentences))\n\nprint('Vectorization...')\nX = np.zeros((len(sentences), maxlen, len(chars)), dtype=np.bool)\ny = np.zeros((len(sentences), len(chars)), dtype=np.bool)\nfor i, sentence in enumerate(sentences):\n    for t, char in enumerate(sentence):\n        X[i, t, char_indices[char]] = 1\n    y[i, char_indices[next_chars[i]]] = 1","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">corpus length: 600901\ntotal chars: 59\nnb sequences: 200287\nVectorization...\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513247573394,"submitTime":1513247573382,"finishTime":1513247623664,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"574f76e6-d6ac-4156-b365-d3e2ba40bd19"},{"version":"CommandV1","origId":216738,"guid":"44b864a6-a769-46d0-8d40-b61cb8bbce4b","subtype":"command","commandType":"auto","position":9.625,"command":"len(sentences), maxlen, len(chars)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">11</span><span class=\"ansired\">]: </span>(200287, 40, 59)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513247679056,"submitTime":1513247679038,"finishTime":1513247679107,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bc3f6e1d-b3ed-4ee1-b135-4681ce3601d8"},{"version":"CommandV1","origId":216739,"guid":"599fb2b5-38ed-498b-9541-ed858526298f","subtype":"command","commandType":"auto","position":9.75,"command":"X","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>\narray([[[False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        ..., \n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]],\n\n       [[False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        ..., \n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]],\n\n       [[False, False, False, ..., False, False, False],\n        [ True, False, False, ..., False, False, False],\n        [ True, False, False, ..., False, False, False],\n        ..., \n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]],\n\n       ..., \n       [[False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        ..., \n        [False,  True, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]],\n\n       [[False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        ..., \n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]],\n\n       [[False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        ..., \n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False],\n        [False, False, False, ..., False, False, False]]], dtype=bool)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513247641221,"submitTime":1513247641205,"finishTime":1513247641264,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e2254cc-e45a-4d59-888e-aa7845993a7f"},{"version":"CommandV1","origId":216740,"guid":"9be99a39-9b0a-4292-be2a-482417384eef","subtype":"command","commandType":"auto","position":10.0,"command":"%md \n### What Does Our Nietzsche Generator Produce?\n\nHere are snapshots from middle and late in a training run.\n\n#### Iteration 19\n\n```\nIteration 19\nEpoch 1/1\n200287/200287 [==============================] - 262s - loss: 1.3908     \n\n----- diversity: 0.2\n----- Generating with seed: \" apart from the value of such assertions\"\n apart from the value of such assertions of the present of the supersially and the soul. the spirituality of the same of the soul. the protect and in the states to the supersially and the soul, in the supersially the supersially and the concerning and in the most conscience of the soul. the soul. the concerning and the substances, and the philosophers in the sing\"--that is the most supersiall and the philosophers of the supersially of t\n\n----- diversity: 0.5\n----- Generating with seed: \" apart from the value of such assertions\"\n apart from the value of such assertions are more there is the scientific modern to the head in the concerning in the same old will of the excited of science. many all the possible concerning such laugher according to when the philosophers sense of men of univerself, the most lacked same depresse in the point, which is desires of a \"good (who has senses on that one experiencess which use the concerning and in the respect of the same ori\n\n----- diversity: 1.0\n----- Generating with seed: \" apart from the value of such assertions\"\n apart from the value of such assertions expressions--are interest person from indeed to ordinapoon as or one of\nthe uphamy, state is rivel stimromannes are lot man of soul\"--modile what he woulds hope in a riligiation, is conscience, and you amy, surposit to advanced torturily\nand whorlon and perressing for accurcted with a lot us in view, of its own vanity of their natest\"--learns, and dis predeceared from and leade, for oted those wi\n\n----- diversity: 1.2\n----- Generating with seed: \" apart from the value of such assertions\"\n apart from the value of such assertions of\nrutould chinates\nrested exceteds to more saarkgs testure carevan, accordy owing before fatherly rifiny,\nthrurgins of novelts \"frous inventive earth as dire!ition he\nshate out of itst sacrifice, in this\nmectalical\ninworle, you\nadome enqueres to its ighter. he often. once even with ded threaten\"! an eebirelesifist.\n\nlran innoting\nwith we canone acquire at them crarulents who had prote will out t\n```","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"7673794c-1856-47a5-a9cf-41a7b311afbf"},{"version":"CommandV1","origId":216741,"guid":"eb15f1dc-3bda-4e51-b197-a66789a10989","subtype":"command","commandType":"auto","position":11.0,"command":"%md \n#### Iteration 32\n\n```\nIteration 32\nEpoch 1/1\n200287/200287 [==============================] - 255s - loss: 1.3830     \n\n----- diversity: 0.2\n----- Generating with seed: \" body, as a part of this external\nworld,\"\n body, as a part of this external\nworld, and in the great present of the sort of the strangern that is and in the sologies and the experiences and the present of the present and science of the probably a subject of the subject of the morality and morality of the soul the experiences the morality of the experiences of the conscience in the soul and more the experiences the strangere and present the rest the strangere and individual of th\n\n----- diversity: 0.5\n----- Generating with seed: \" body, as a part of this external\nworld,\"\n body, as a part of this external\nworld, and in the morality of which we knows upon the english and insigning things be exception of\nconsequences of the man and explained its more in the senses for the same ordinary and the sortarians and subjects and simily in a some longing the destiny ordinary. man easily that has been the some subject and say, and and and and does not to power as all the reasonable and distinction of this one betray\n\n----- diversity: 1.0\n----- Generating with seed: \" body, as a part of this external\nworld,\"\n body, as a part of this external\nworld, surrespossifilice view and life fundamental worthing more sirer. holestly\nand whan to be\ndream. in whom hand that one downgk edplenius will almost eyes brocky that we wills stupid dor\noborbbill to be dimorable\ngreat excet of ifysabless. the good take the historical yet right by guntend, and which fuens the irrelias in literals in finally to the same flild, conditioned when where prom. it has behi\n\n----- diversity: 1.2\n----- Generating with seed: \" body, as a part of this external\nworld,\"\n body, as a part of this external\nworld, easily achosed time mantur makeches on this\nvanity, obcame-scompleises. but inquire-calr ever powerfully smorais: too-wantse; when thoue\nconducting\nunconstularly without least gainstyfyerfulled to wo\nhas upos\namong uaxqunct what is mell \"loves and\nlamacity what mattery of upon the a. and which oasis seour schol\nto power: the passion sparabrated will. in his europers raris! what seems to these her\n\n```","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"350f0ecc-6424-4436-b5ba-60d5e09fe40a"},{"version":"CommandV1","origId":216742,"guid":"bb5effce-4ca1-4efe-ad10-c03c0f5b13ba","subtype":"command","commandType":"auto","position":12.0,"command":"%md \n### Take alook at the anomalous behavior that started late in the training on one run ... What might have happened?","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"9a7f7a07-bdb0-4d5e-bc36-d7254406d354"},{"version":"CommandV1","origId":216743,"guid":"a26ec105-0ce2-4532-9ff9-cad79925e7c3","subtype":"command","commandType":"auto","position":13.0,"command":"%md \n#### Iteration 38\n\n```\nIteration 38\nEpoch 1/1\n200287/200287 [==============================] - 256s - loss: 7.6662     \n\n----- diversity: 0.2\n----- Generating with seed: \"erable? for there is no\nlonger any ought\"\nerable? for there is no\nlonger any oughteesen a a  a= at ae i is es4 iei aatee he a a ac  oyte  in ioie  aan a atoe aie ion a atias a ooe o e tin exanat moe ao is aon e a ntiere t i in ate an on a  e as the a ion aisn ost  aed i  i ioiesn les?ane i ee to i o ate   o igice thi io an a xen an ae an teane one ee e alouieis asno oie on i a a ae s as n io a an e a ofe e  oe ehe it aiol  s a aeio st ior ooe an io e  ot io  o i  aa9em aan ev a\n\n----- diversity: 0.5\n----- Generating with seed: \"erable? for there is no\nlonger any ought\"\nerable? for there is no\nlonger any oughteese a on eionea] aooooi ate uo e9l hoe atae s in eaae an  on io]e nd ast aais  ta e  od iia ng ac ee er ber  in ==st a se is ao  o e as aeian iesee tee otiane o oeean a ieatqe o  asnone anc \n oo a t\ntee sefiois to an at in ol asnse an o e e oo  ie oae asne at a ait iati oese se a e p ie peen iei ien   o oot inees engied evone t oen oou atipeem a sthen ion assise ti a a s itos io ae an  eees as oi\n\n----- diversity: 1.0\n----- Generating with seed: \"erable? for there is no\nlonger any ought\"\nerable? for there is no\nlonger any oughteena te e ore te beosespeehsha ieno atit e ewge ou ino oo oee coatian aon ie ac aalle e a o  die eionae oa att uec a acae ao a  an eess as\n o  i a io  a   oe a  e is as oo in ene xof o  oooreeg ta m eon al iii n p daesaoe n ite o ane tio oe anoo t ane\ns i e tioo ise s a asi e ana ooe ote soueeon io on atieaneyc ei it he se it is ao e an ime  ane on eronaa ee itouman io e ato an ale  a mae taoa ien\n\n----- diversity: 1.2\n----- Generating with seed: \"erable? for there is no\nlonger any ought\"\nerable? for there is no\nlonger any oughti o aa e2senoees yi i e datssateal toeieie e a o zanato aal arn aseatli oeene aoni le eoeod t aes a isoee tap  e o . is  oi astee an ea titoe e a exeeee thui itoan ain eas a e bu inen ao ofa ie e e7n anae ait ie a ve  er inen  ite\nas oe of  heangi eestioe orasb e fie o o o  a  eean o ot odeerean io io oae ooe ne \" e  istee esoonae e terasfioees asa ehainoet at e ea ai esoon   ano a p eesas e aitie\n```","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"373433cb-2c73-4f58-8825-e9d90cdf7abe"},{"version":"CommandV1","origId":216744,"guid":"03ed6f3f-9354-4a27-ab3f-ce2b49dbbfee","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n\n(raaz)\n## 'Mind the Hype' around AI \n\nPay attention to biases in various media.\n\n- **Guardian**: *'He began to eat Hermione's family': bot tries to write Harry Potter book – and fails in magic ways\nAfter being fed all seven Potter tales, a predictive keyboard has produced a tale that veers from almost genuine to gloriously bonkers*\n  * [https://www.theguardian.com/books/booksblog/2017/dec/13/harry-potter-botnik-jk-rowling](https://www.theguardian.com/books/booksblog/2017/dec/13/harry-potter-botnik-jk-rowling)\n- **Business Insider**: *There is a new chapter in Harry Potter's story — and it was written by artificial intelligence ... The writing is mostly weird and borderline comical, but the machine managed to partly reproduce original writer J.K. Rowling's writing style.*\n  * [http://nordic.businessinsider.com/there-is-a-new-chapter-in-harry-potters-story-and-it-was-written-by-artificial-intelligence-2017-12](http://nordic.businessinsider.com/there-is-a-new-chapter-in-harry-potters-story-and-it-was-written-by-artificial-intelligence-2017-12)\n  \nWhen your managers get \"psyched\" about how AI will solve all the problems and your sales teams are dreaming hard - keep it cool and manage their expectations as a practical data scientist who is humbled by the hard reality of additions, multiplications and conditionals under the hood.\n\n## 'Mind the Ethics'\n\nDon't forget to ask how your data science pipelines could adversely affect peoples:\n * A great X-mas gift to yourself: [https://weaponsofmathdestructionbook.com/](https://weaponsofmathdestructionbook.com/)\n * Another one to make you braver and calmer: [https://www.schneier.com/books/data_and_goliath/](https://www.schneier.com/books/data_and_goliath/)\n \n Don't forget that Data Scientists can be put behind bars for \"following orders\" from your boss to \"make magic happen\".\n * [https://www.datasciencecentral.com/profiles/blogs/doing-illegal-data-science-without-knowing-it](https://www.datasciencecentral.com/profiles/blogs/doing-illegal-data-science-without-knowing-it)\n * [https://timesofindia.indiatimes.com/india/forecast-of-poll-results-illegal-election-commission/articleshow/57927839.cms](https://timesofindia.indiatimes.com/india/forecast-of-poll-results-illegal-election-commission/articleshow/57927839.cms)\n * [https://spectrum.ieee.org/cars-that-think/at-work/education/vw-scandal-shocking-but-not-surprising-ethicists-say](https://spectrum.ieee.org/cars-that-think/at-work/education/vw-scandal-shocking-but-not-surprising-ethicists-say)\n* ...","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ef2c3d3c-ef91-4bc7-b698-8109f8fb2710"}],"dashboards":[],"guid":"f49fc4eb-88c8-455f-a431-bfde4ad0e7b6","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.4.5","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
