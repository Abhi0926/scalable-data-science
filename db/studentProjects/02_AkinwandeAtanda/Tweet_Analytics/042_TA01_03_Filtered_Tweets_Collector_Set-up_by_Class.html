<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>042_TA01_03_Filtered_Tweets_Collector_Set-up_by_Class - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":3.0,"node_type_id":"class-node","description":"Class Node","container_memory_mb":6000,"memory_mb":6144,"num_cores":0.88}],"default_node_type_id":"class-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enablePublishNotebooks":false,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-U29e64bf9af-S9c254ab12a-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-U29e64bf9af-S9ca52d000d-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-U29e64bf9af-Sa2ee4664b2-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (apache/branch-2.0 preview)","packageLabel":"spark-image-1e373018dd5d67adc815234c23e8d1e9eca5394f90f8f2a00df56e2c182e0ad7","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-U29e64bf9af-Sf90f83597b-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.22.1","accountsLimit":-1,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":false,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":true,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-U29e64bf9af-S2368283920-2016-06-23-00:19:57.707639","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"enableClusterAclsByTier":true,"disallowAddingAdmins":false,"enableSparkConfUI":true,"featureTier":"UNKNOWN_TIER","enableOrgSwitcherUI":false,"clustersLimit":-1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"29e64bf9afe1117763a990704253c3678448e6c5","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":false,"showDevTierBetaVersion":false,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"","notebookLoadingBackground":"#fff","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":false,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":111747,"name":"042_TA01_03_Filtered_Tweets_Collector_Set-up_by_Class","language":"scala","commands":[{"version":"CommandV1","origId":111749,"guid":"1d2bec83-0699-4821-9bbe-426b2e7a0c47","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n\n### Course Project by [Akinwande Atanda](https://nz.linkedin.com/in/akinwande-atanda)\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"aa953397-a25e-452b-8301-164e8b57517d"},{"version":"CommandV1","origId":111750,"guid":"3d0ab282-744e-494e-880c-62d0307a66bb","subtype":"command","commandType":"auto","position":1.125,"command":"%md\nThe [html source url](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/db/studentProjects/02_AkinwandeAtanda/Tweet_Analytics/042_TA01_03_Filtered_Tweets_Collector_Set-up_by_Class.html) of this databricks notebook and its recorded Uji ![Image of Uji, Dogen's Time-Being](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/UjiTimeBeingDogen.png \"uji\"):\n\n[![sds/uji/studentProjects/02_AkinwandeAtanda/Tweet_Analytics/042_TA01_03_Filtered_Tweets_Collector_Set-up_by_Class](http://img.youtube.com/vi/zJirlHAV6YU/0.jpg)](https://www.youtube.com/v/zJirlHAV6YU?rel=0&autoplay=1&modestbranding=1&start=0&end=1611)\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"890c85a7-9742-4ee4-a7eb-356f90b74c8c"},{"version":"CommandV1","origId":111751,"guid":"f736da3a-f7df-4288-8035-72af65223466","subtype":"command","commandType":"auto","position":1.25,"command":"%md\n#Tweet Analytics\n\n[Presentation contents](https://github.com/aaa121/Spark-Tweet-Streaming-Presentation-May-2016).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"98354fe8-0b20-4b0a-8948-7146b751040e"},{"version":"CommandV1","origId":111752,"guid":"67dc22e6-73f6-4769-9bc8-b58b6d9324f5","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n\n## Filtered Generic Twitter Collector by Selected Retrieved Keys\n\n\nRemeber that the use of twitter itself comes with various strings attached. \n- **Read:** [Twitter Rules](https://twitter.com/rules)\n\n\nCrucially, the use of the content from twitter by you (as done in this worksheet) comes with some strings.\n- **Read:** [Developer Agreement & Policy Twitter Developer Agreement](https://dev.twitter.com/overview/terms/agreement-and-policy)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"74f5abf9-3c34-4ed9-8504-61ce7a94b947"},{"version":"CommandV1","origId":111753,"guid":"e0d02e8c-cf11-4a26-a60c-98df0fe2edf5","subtype":"command","commandType":"auto","position":1.75,"command":"import org.apache.spark._\nimport org.apache.spark.storage._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter.TwitterUtils\n\nimport scala.math.Ordering\n\nimport twitter4j.auth.OAuthAuthorization\nimport twitter4j.conf.ConfigurationBuilder","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark._\nimport org.apache.spark.storage._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter.TwitterUtils\nimport scala.math.Ordering\nimport twitter4j.auth.OAuthAuthorization\nimport twitter4j.conf.ConfigurationBuilder\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467866746122E12,"submitTime":1.467866775509E12,"finishTime":1.467866747377E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f4106e91-5022-4870-a25f-b9a2aacb3b71"},{"version":"CommandV1","origId":111754,"guid":"096519cc-8ed7-4462-b046-8d2ff4676f55","subtype":"command","commandType":"auto","position":1.875,"command":"%md\n\n### Step 1: Enter your Twitter API Credentials.\n* Go to https://apps.twitter.com and look up your Twitter API Credentials, or create an app to create them.\n* Run this cell for the input cells to appear.\n* Enter your credentials.\n* Run the cell again to pick up your defaults.\n\nThe cell-below is hidden to not expose the Twitter API Credentials: `consumerKey`, `consumerSecret`, `accessToken` and `accessTokenSecret`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8bf47714-2fc1-489a-bd80-020531430905"},{"version":"CommandV1","origId":111755,"guid":"88315f15-0a62-46a6-ad02-8671d0f36f44","subtype":"command","commandType":"auto","position":1.9375,"command":"System.setProperty(\"twitter4j.oauth.consumerKey\", getArgument(\"1. Consumer Key (API Key)\", \"\"))\nSystem.setProperty(\"twitter4j.oauth.consumerSecret\", getArgument(\"2. Consumer Secret (API Secret)\", \"\"))\nSystem.setProperty(\"twitter4j.oauth.accessToken\", getArgument(\"3. Access Token\", \"\"))\nSystem.setProperty(\"twitter4j.oauth.accessTokenSecret\", getArgument(\"4. Access Token Secret\", \"\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;console&gt;:43: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n              System.setProperty(&quot;twitter4j.oauth.consumerKey&quot;, getArgument(&quot;1. Consumer Key (API Key)&quot;, &quot;&quot;))\n                                                                ^\n&lt;console&gt;:44: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n              System.setProperty(&quot;twitter4j.oauth.consumerSecret&quot;, getArgument(&quot;2. Consumer Secret (API Secret)&quot;, &quot;&quot;))\n                                                                   ^\n&lt;console&gt;:45: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n              System.setProperty(&quot;twitter4j.oauth.accessToken&quot;, getArgument(&quot;3. Access Token&quot;, &quot;&quot;))\n                                                                ^\n&lt;console&gt;:48: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n              System.setProperty(&quot;twitter4j.oauth.accessTokenSecret&quot;, getArgument(&quot;4. Access Token Secret&quot;, &quot;&quot;))\n                                                                      ^\nres0: String = &quot;&quot;\n</div>","arguments":{"3. Access Token":"","2. Consumer Secret (API Secret)":"","1. Consumer Key (API Key)":"","4. Access Token Secret":""},"addedWidgets":{"3. Access Token":{"widgetType":"text","name":"3. Access Token","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}},"2. Consumer Secret (API Secret)":{"widgetType":"text","name":"2. Consumer Secret (API Secret)","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}},"1. Consumer Key (API Key)":{"widgetType":"text","name":"1. Consumer Key (API Key)","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}},"4. Access Token Secret":{"widgetType":"text","name":"4. Access Token Secret","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.46786675316E12,"submitTime":1.467866782542E12,"finishTime":1.467866753331E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"beb85b85-1449-4abc-8c4b-e19fb913b669"},{"version":"CommandV1","origId":111756,"guid":"7cd36c03-56e8-4e31-8879-e5479be21b92","subtype":"command","commandType":"auto","position":1.96875,"command":"%md\nIf you see warnings then ignore for now:\n[https://forums.databricks.com/questions/6941/change-in-getargument-for-notebook-input.html](https://forums.databricks.com/questions/6941/change-in-getargument-for-notebook-input.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e8a02822-0b7d-40a1-897f-b3d91b9aec1d"},{"version":"CommandV1","origId":111757,"guid":"2c29cb87-3974-4bba-90d3-e8b886c557b9","subtype":"command","commandType":"auto","position":1.97265625,"command":"%md\n\n### Step 2: Configure where to output each unfiltered Batches of Tweet Stream and how often to compute them.\n* Run this cell for the input cells to appear.\n* Enter your credentials.\n* Run the cell again to pick up your defaults.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5735705c-1ec9-4961-aa37-6f859eb778c1"},{"version":"CommandV1","origId":111758,"guid":"93b653bf-c983-476c-81dc-3ec95c3166b3","subtype":"command","commandType":"auto","position":1.974609375,"command":"60*60*24*7*1 // (a * b* c* d * e); where a = 60 mini-seconds; b = 60 secods; c = number of hours within a day (range(1,24)); d = numnber of days (range(1,7)); e = number of weeks (range(1,@));","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res8: Int = 604800\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463453097694E12,"submitTime":1.463453038176E12,"finishTime":1.463453097808E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7c6452c2-320a-4e00-8ebd-918ce1005eaf"},{"version":"CommandV1","origId":111759,"guid":"2595f85a-7c56-41d5-bec9-fdc61ac528c3","subtype":"command","commandType":"auto","position":1.9765625,"command":"val outputDirectory = getArgument(\"1. Output Directory\", \"/twitterNew2\")\nval slideInterval = new Duration(getArgument(\"2. Recompute the top hashtags every N seconds\", \"1\").toInt * 1000)\nval windowLength = new Duration(getArgument(\"3. Compute the top hashtags for the last N seconds\", \"5\").toInt * 1000) // not used now\nval timeoutJobLength = getArgument(\"4. Wait this many seconds before stopping the streaming job\", \"100\").toInt * 1000","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;console&gt;:43: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val outputDirectory = getArgument(&quot;1. Output Directory&quot;, &quot;/twitterNew2&quot;)\n                             ^\n&lt;console&gt;:44: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val slideInterval = new Duration(getArgument(&quot;2. Recompute the top hashtags every N seconds&quot;, &quot;1&quot;).toInt * 1000)\n                                        ^\n&lt;console&gt;:45: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val windowLength = new Duration(getArgument(&quot;3. Compute the top hashtags for the last N seconds&quot;, &quot;5&quot;).toInt * 1000) // not used now\n                                       ^\n&lt;console&gt;:46: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val timeoutJobLength = getArgument(&quot;4. Wait this many seconds before stopping the streaming job&quot;, &quot;100&quot;).toInt * 1000\n                              ^\noutputDirectory: String = /twitterNew2\nslideInterval: org.apache.spark.streaming.Duration = 300000 ms\nwindowLength: org.apache.spark.streaming.Duration = 5000 ms\ntimeoutJobLength: Int = 604800000\n</div>","arguments":{"2. Recompute the top hashtags every N seconds":"300","4. Wait this many seconds before stopping the streaming job":"604800","1. Output Directory":"/twitterNew2","3. Compute the top hashtags for the last N seconds":"5"},"addedWidgets":{"2. Recompute the top hashtags every N seconds":{"widgetType":"text","name":"2. Recompute the top hashtags every N seconds","defaultValue":"1","label":"","options":{"widgetType":"text","validationRegex":null}},"4. Wait this many seconds before stopping the streaming job":{"widgetType":"text","name":"4. Wait this many seconds before stopping the streaming job","defaultValue":"100","label":"","options":{"widgetType":"text","validationRegex":null}},"1. Output Directory":{"widgetType":"text","name":"1. Output Directory","defaultValue":"/twitterNew2","label":"","options":{"widgetType":"text","validationRegex":null}},"3. Compute the top hashtags for the last N seconds":{"widgetType":"text","name":"3. Compute the top hashtags for the last N seconds","defaultValue":"5","label":"","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:31: error: not found: type Duration\n       val slideInterval = new Duration(getArgument(&quot;2. Recompute the top hashtags every N seconds&quot;, &quot;1&quot;).toInt * 1000)\n                               ^\n&lt;console&gt;:32: error: not found: type Duration\n       val windowLength = new Duration(getArgument(&quot;3. Compute the top hashtags for the last N seconds&quot;, &quot;5&quot;).toInt * 1000) // not used now\n                              ^\n</div>","error":null,"workflows":[],"startTime":1.467866761018E12,"submitTime":1.467866790396E12,"finishTime":1.467866761197E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"35961df9-c42e-41b9-9c57-461c15901f64"},{"version":"CommandV1","origId":111760,"guid":"2091e28f-ea32-4fac-9aaa-cc8d2f1aa943","subtype":"command","commandType":"auto","position":1.98046875,"command":"// Replace with your AWS S3 credentials\n//\n// NOTE: Set the access to this notebook appropriately to protect the security of your keys.\n// Or you can delete this cell after you run the mount command below once successfully.\n\nval AccessKey = getArgument(\"1. ACCESS_KEY\", \"REPLACE_WITH_YOUR_ACCESS_KEY\")\nval SecretKey = getArgument(\"2. SECRET_KEY\", \"REPLACE_WITH_YOUR_SECRET_KEY\")\nval EncodedSecretKey = SecretKey.replace(\"/\", \"%2F\")\nval AwsBucketName = getArgument(\"3. S3_BUCKET\", \"REPLACE_WITH_YOUR_S3_BUCKET\")\nval MountName = getArgument(\"4. MNT_NAME\", \"REPLACE_WITH_YOUR_MOUNT_NAME\")\nval s3Filename = \"tweetDump\"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;console&gt;:48: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val AccessKey = getArgument(&quot;1. ACCESS_KEY&quot;, &quot;REPLACE_WITH_YOUR_ACCESS_KEY&quot;)\n                       ^\n&lt;console&gt;:49: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val SecretKey = getArgument(&quot;2. SECRET_KEY&quot;, &quot;REPLACE_WITH_YOUR_SECRET_KEY&quot;)\n                       ^\n&lt;console&gt;:51: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val AwsBucketName = getArgument(&quot;3. S3_BUCKET&quot;, &quot;REPLACE_WITH_YOUR_S3_BUCKET&quot;)\n                           ^\n&lt;console&gt;:52: warning: method getArgument in trait WidgetsUtils is deprecated: Use dbutils.widgets.text() or dbutils.widgets.dropdown() to create a widget and dbutils.widgets.get() to get its bound value.\n       val MountName = getArgument(&quot;4. MNT_NAME&quot;, &quot;REPLACE_WITH_YOUR_MOUNT_NAME&quot;)\n                       ^\nAccessKey: String = &quot;&quot;\nSecretKey: String = &quot;&quot;\nEncodedSecretKey: String = &quot;&quot;\nAwsBucketName: String = sds-twitter\nMountName: String = s3Data\ns3Filename: String = tweetDump\n</div>","arguments":{"2. SECRET_KEY":"","4. MNT_NAME":"s3Data","3. S3_BUCKET":"sds-twitter","1. ACCESS_KEY":""},"addedWidgets":{"2. SECRET_KEY":{"widgetType":"text","name":"2. SECRET_KEY","defaultValue":"REPLACE_WITH_YOUR_SECRET_KEY","label":"","options":{"widgetType":"text","validationRegex":null}},"4. MNT_NAME":{"widgetType":"text","name":"4. MNT_NAME","defaultValue":"REPLACE_WITH_YOUR_MOUNT_NAME","label":"","options":{"widgetType":"text","validationRegex":null}},"3. S3_BUCKET":{"widgetType":"text","name":"3. S3_BUCKET","defaultValue":"REPLACE_WITH_YOUR_S3_BUCKET","label":"","options":{"widgetType":"text","validationRegex":null}},"1. ACCESS_KEY":{"widgetType":"text","name":"1. ACCESS_KEY","defaultValue":"REPLACE_WITH_YOUR_ACCESS_KEY","label":"","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467866765911E12,"submitTime":1.467866795288E12,"finishTime":1.467866766E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dfc09f1f-5be5-4fed-9e29-211a66dd3b58"},{"version":"CommandV1","origId":111761,"guid":"8340c547-69c3-40a3-b141-9cb50454946d","subtype":"command","commandType":"auto","position":1.982421875,"command":"dbutils.fs.unmount(s\"/mnt/$MountName\") // finally unmount when done","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/mnt/s3Data has been unmounted.\nres1: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.rmi.RemoteException: java.lang.IllegalArgumentException: Directory not mounted: /mnt/s3Data; nested exception is: ","error":"<div class=\"ansiout\">\tjava.lang.IllegalArgumentException: Directory not mounted: /mnt/s3Data\n\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:73)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:42)\n\tat com.databricks.backend.daemon.dbutils.DBUtilsCore.unmount(DBUtilsCore.scala:341)\n\tat com.databricks.dbutils_v1.impl.DbfsUtilsImpl.unmount(DbfsUtilsImpl.scala:86)\nCaused by: java.lang.IllegalArgumentException: Directory not mounted: /mnt/s3Data\n\tat com.databricks.backend.daemon.data.server.DefaultMetadataManager.deleteMount(MetadataManager.scala:148)\n\tat com.databricks.backend.daemon.data.server.handler.MountHandler.receive(MountHandler.scala:56)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:58)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:57)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext.queryHandlers(SessionContext.scala:57)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:207)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:188)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:42)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:37)\n\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:33)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:57)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:57)\n\tat scala.PartialFunction$OrElse.apply(PartialFunction.scala:162)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$10.apply(JettyServer.scala:263)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleRPC(JettyServer.scala:263)\n\tat com.databricks.rpc.JettyServer$RequestManager.com$databricks$rpc$JettyServer$RequestManager$$handleRequestAndRespond(JettyServer.scala:199)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply$mcV$sp(JettyServer.scala:144)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:135)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:135)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:120)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:115)\n\tat com.databricks.rpc.JettyServer$.withAttributionContext(JettyServer.scala:74)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:153)\n\tat com.databricks.rpc.JettyServer$.withAttributionTags(JettyServer.scala:74)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleHttp(JettyServer.scala:134)\n\tat com.databricks.rpc.JettyServer$RequestManager.doGet(JettyServer.scala:89)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:816)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:583)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:513)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:517)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:306)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:245)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1.463453234994E12,"submitTime":1.46345317546E12,"finishTime":1.463453236245E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b5e55f75-9710-41d5-8c16-c932ace3b81b"},{"version":"CommandV1","origId":111762,"guid":"b028b28d-3245-4e30-b5c7-a4abacf12c2e","subtype":"command","commandType":"auto","position":1.9833984375,"command":"dbutils.fs.mount(s\"s3a://$AccessKey:$EncodedSecretKey@$AwsBucketName\", s\"/mnt/$MountName\") // mount for the first time or after unmounting","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.rmi.RemoteException: java.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/s3Data; nested exception is: ","error":"<div class=\"ansiout\">\tjava.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/s3Data\n\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:73)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:42)\n\tat com.databricks.backend.daemon.dbutils.DBUtilsCore.mount(DBUtilsCore.scala:299)\n\tat com.databricks.dbutils_v1.impl.DbfsUtilsImpl.mount(DbfsUtilsImpl.scala:77)\nCaused by: java.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/s3Data\n\tat scala.Predef$.require(Predef.scala:233)\n\tat com.databricks.backend.daemon.data.server.DefaultMetadataManager.insertMount(MetadataManager.scala:121)\n\tat com.databricks.backend.daemon.data.server.handler.MountHandler.receive(MountHandler.scala:38)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:58)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:57)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext.queryHandlers(SessionContext.scala:57)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:207)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:188)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:42)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:37)\n\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:33)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:57)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:57)\n\tat scala.PartialFunction$OrElse.apply(PartialFunction.scala:162)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$10.apply(JettyServer.scala:263)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleRPC(JettyServer.scala:263)\n\tat com.databricks.rpc.JettyServer$RequestManager.com$databricks$rpc$JettyServer$RequestManager$$handleRequestAndRespond(JettyServer.scala:199)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply$mcV$sp(JettyServer.scala:144)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:135)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:135)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:121)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:116)\n\tat com.databricks.rpc.JettyServer$.withAttributionContext(JettyServer.scala:74)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:154)\n\tat com.databricks.rpc.JettyServer$.withAttributionTags(JettyServer.scala:74)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleHttp(JettyServer.scala:134)\n\tat com.databricks.rpc.JettyServer$RequestManager.doGet(JettyServer.scala:89)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:816)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:583)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:513)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:517)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:306)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:245)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1.466822763733E12,"submitTime":1.466822545921E12,"finishTime":1.466822763807E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8f6618af-2bb0-4f66-8243-5d05c182ad1a"},{"version":"CommandV1","origId":111763,"guid":"2f2c8156-4fd1-4400-942f-6e567b738c90","subtype":"command","commandType":"auto","position":1.9835205078125,"command":"%md **A directory can be created to save the Tweet Stream**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b0ba9430-c4ef-4352-960f-2b6ce9cebb31"},{"version":"CommandV1","origId":111764,"guid":"06b868c9-b4fc-4c72-823d-efdf75216996","subtype":"command","commandType":"auto","position":1.98358154296875,"command":"//dbutils.fs.mkdirs(s\"/mnt/$MountName/twitterNew2/\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res33: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.46370360307E12,"submitTime":1.463703598185E12,"finishTime":1.463703603272E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e87506b9-a573-433a-b3e3-507a910bc9a6"},{"version":"CommandV1","origId":111765,"guid":"7fbc44ea-1bad-410d-858a-93e15e6e4c7f","subtype":"command","commandType":"auto","position":1.983642578125,"command":"//dbutils.fs.rm(\"/mnt/$MountName/NAME_OF_DIRECTORY/\",recurse=true) //Remove the directory if previously created and no longer required for further use. ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res32: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.461919988404E12,"submitTime":1.461919839457E12,"finishTime":1.461919989219E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a121d6dc-9547-48d9-ba47-6963af0f00dd"},{"version":"CommandV1","origId":111766,"guid":"beb4f84b-63b8-4cd7-8355-642afb122a09","subtype":"command","commandType":"auto","position":1.98388671875,"command":"display(dbutils.fs.ls(s\"/mnt/s3Data/twitterNew2\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"java.io.FileNotFoundException: /mnt/s3Data/twitterNew2","error":"<div class=\"ansiout\">\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:65)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:42)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.listStatus(DatabricksFileSystem.scala:189)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.ls(DBUtilsCore.scala:61)\n\tat com.databricks.dbutils_v1.impl.DbfsUtilsImpl.ls(DbfsUtilsImpl.scala:29)</div>","workflows":[],"startTime":1.46370401091E12,"submitTime":1.463704007486E12,"finishTime":1.463704014875E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"715e5e8d-49a7-4ce4-8b0e-5a110aa8c7ff"},{"version":"CommandV1","origId":111767,"guid":"77f97974-8e85-4a33-a99e-7b83f624cd2d","subtype":"command","commandType":"auto","position":1.984375,"command":"%md\n\n### Step 3: Run the Twitter Streaming job.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8738e247-993f-4d64-ac01-98d6990c8325"},{"version":"CommandV1","origId":111768,"guid":"348c2ae4-f9c5-4063-9a42-6dac2455b970","subtype":"command","commandType":"auto","position":1.99609375,"command":"%md \nCreate the function to set-up the Streaming Context and the streaming job.\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d761c81b-3904-445e-ab0b-64509e0c5c2b"},{"version":"CommandV1","origId":111769,"guid":"3ef75629-eecf-49f6-9b05-14aef59d260e","subtype":"command","commandType":"auto","position":1.99658203125,"command":"%md\n###Filter Set-up\n* Create a class of keys to retrieve from each streamed tweet (in JSON) format\n* Define a function to convert the entire streamed tweets (from twitter4j.Status) to the filtered tweet (\"covertToFilter\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5b104106-d273-4dbe-ae2e-95de5c63c0c7"},{"version":"CommandV1","origId":111770,"guid":"79b1bee9-29ba-4734-ba64-08d3457473fe","subtype":"command","commandType":"auto","position":1.9970703125,"command":"import com.google.gson.Gson // the Library has already been attached to this cluster (show live how to do this from scratch?)\n\nvar newContextCreated = false\nvar num = 0\nvar numTweetsCollected = 0L // track number of tweets collected\n\n// This is a helper class used for \nobject SecondValueOrdering extends Ordering[(String, Int)] {\n  def compare(a: (String, Int), b: (String, Int)) = {\n    a._2 compare b._2\n  }\n}\n\n// This is the function that creates the SteamingContext and sets up the Spark Streaming job.\ndef creatingFunc(): StreamingContext = {\n  // Create a Spark Streaming Context.\n  val ssc = new StreamingContext(sc, slideInterval)\n  // Create a Twitter Stream for the input source. \n  val auth = Some(new OAuthAuthorization(new ConfigurationBuilder().build()))\n  val twitterStream = TwitterUtils.createStream(ssc, auth)\n  \n  val twitterStreamJson = twitterStream.map(x => { val gson = new Gson();\n                                                 val xJson = gson.toJson(x)\n                                                 xJson\n                                               }) \n  def convertToFilter(status: twitter4j.Status): FilterStatus = {val hashTags: Array[String] =  if(status.getHashtagEntities !=null) status.getHashtagEntities().map(eachHT => eachHT.getText()) else Array[String]()\n  val user = status.getUser()\n  FilterStatus(id = status.getId.toString,tweets = status.getText,favoriteCount = status.getFavoriteCount,retweetCount = status.getRetweetCount, hashTags = hashTags, screenName = user.getScreenName, userName = user.getName, \n    followersCount = user.getFollowersCount)\n  }\n  \nval partitionsEachInterval = 1 // This tells the number of partitions in each RDD of tweets in the DStream.\n\ntwitterStream.map(convertToFilter).foreachRDD((rdd, time) => { // for each filtered RDD in the DStream\n      val count = rdd.count()\n      if (count > 0) {\n        val outputRDD = rdd.repartition(partitionsEachInterval) // repartition as desired\n        //outputRDD.saveAsTextFile(s\"${outputDirectory}/tweets_\" + time.milliseconds.toString) // save as textfile\n        outputRDD.saveAsTextFile(s\"/mnt/$MountName/${outputDirectory}\" + \"/tweets_\" + time.milliseconds.toString+\".txt\") // save as textfile in s3\n        numTweetsCollected += count // update with the latest count\n      }\n  })\n  \n  newContextCreated = true\n  ssc\n}\n\ncase class FilterStatus(screenName:String,userName:String,followersCount:Long,id:String,tweets:String,favoriteCount:Long,retweetCount:Long,hashTags:Array[String]=Array[String]())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import com.google.gson.Gson\nnewContextCreated: Boolean = false\nnum: Int = 0\nnumTweetsCollected: Long = 0\ndefined module SecondValueOrdering\ncreatingFunc: ()org.apache.spark.streaming.StreamingContext\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:46: error: not found: type StreamingContext\n       def creatingFunc(): StreamingContext = {\n                           ^\n&lt;console&gt;:48: error: not found: type StreamingContext\n         val ssc = new StreamingContext(sc, slideInterval)\n                       ^\n&lt;console&gt;:50: error: not found: type OAuthAuthorization\n         val auth = Some(new OAuthAuthorization(new ConfigurationBuilder().build()))\n                             ^\n&lt;console&gt;:51: error: not found: value TwitterUtils\n         val twitterStream = TwitterUtils.createStream(ssc, auth)\n                             ^\n</div>","error":null,"workflows":[],"startTime":1.463704020677E12,"submitTime":1.463704017249E12,"finishTime":1.463704021616E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"831500bf-35b2-4212-9144-e54b36bbce95"},{"version":"CommandV1","origId":111771,"guid":"4450cdd1-f3ec-4559-8293-3f1d79e6e786","subtype":"command","commandType":"auto","position":1.998046875,"command":"%md \nCreate the StreamingContext using getActiveOrCreate, as required when starting a streaming job in Databricks.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"45811743-91c4-44e4-9039-674098c9e028"},{"version":"CommandV1","origId":111772,"guid":"43c2e853-44af-41db-999d-11ea41a1d9ae","subtype":"command","commandType":"auto","position":1.99853515625,"command":"val ssc = StreamingContext.getActiveOrCreate(creatingFunc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@495d1c0a\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463704026861E12,"submitTime":1.463704023423E12,"finishTime":1.463704027128E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"018e1db9-e3f6-46d1-884a-b286877c973b"},{"version":"CommandV1","origId":111773,"guid":"d94d9723-f565-4b1b-981a-dd96ea1e6679","subtype":"command","commandType":"auto","position":1.998779296875,"command":"%md\n\nStart the Spark Streaming Context and return when the Streaming job exits or return with the specified timeout.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"db8eb2be-67f7-4fac-a65e-882b37b08e6c"},{"version":"CommandV1","origId":111774,"guid":"cf88dc40-204f-45c8-939d-02e0eed2f9e5","subtype":"command","commandType":"auto","position":1.9989013671875,"command":"ssc.start()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.46370403125E12,"submitTime":1.463704027762E12,"finishTime":1.463704031933E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fd88fb9d-1788-41b0-9951-6f0e7494de53"},{"version":"CommandV1","origId":111775,"guid":"9bf0265f-0f72-46b3-8d5e-599f426b822e","subtype":"command","commandType":"auto","position":1.99896240234375,"command":"%md\n\nStop Streaming and/or Terminate the Spark Streaming Context (=true) and return when the Streaming job exits or return with the specified timeout.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3bf18a7e-2351-4e33-8459-f088d908bc1f"},{"version":"CommandV1","origId":111776,"guid":"c06bd2e3-9c32-4db8-8cae-5568c2ad6382","subtype":"command","commandType":"auto","position":1.9990234375,"command":"//ssc.start()\n//ssc.awaitTerminationOrTimeout(timeoutJobLength)\nssc.stop(stopSparkContext = false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463706276428E12,"submitTime":1.463706272901E12,"finishTime":1.463706276832E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"aa658479-3d39-454c-a1fa-76aad7047885"},{"version":"CommandV1","origId":111777,"guid":"a28d0e0d-0435-4871-a098-71145a55a449","subtype":"command","commandType":"auto","position":1.999267578125,"command":"%md\nCheck out the Clusters 'Streaming` UI as the job is running.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"240e877e-f149-4b5d-902c-b0a8ce5f0d60"},{"version":"CommandV1","origId":111778,"guid":"812feecf-2d81-42d9-925e-c3751c944672","subtype":"command","commandType":"auto","position":1.99951171875,"command":"%md\n\nStop any active Streaming Contexts, but don't stop the spark contexts they are attached to.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"982fc11c-a250-4dcb-96b3-07f7244c8156"},{"version":"CommandV1","origId":111779,"guid":"0d42e9e5-af86-40f9-9cd3-3ff8a9d8811c","subtype":"command","commandType":"auto","position":1.9996337890625,"command":"StreamingContext.getActive.foreach { _.stop(stopSparkContext = false) }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.461906254574E12,"submitTime":1.461906106203E12,"finishTime":1.461906254711E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"36425eff-1e35-41af-857b-0a654e4bc8fa"},{"version":"CommandV1","origId":111780,"guid":"9a5a10fd-435b-4dd3-a1ba-4c9e9d7aeb19","subtype":"command","commandType":"auto","position":1.999755859375,"command":"%md\n\n### Step 4: View the Results.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ba655694-91d4-48eb-be92-59980cca20a3"},{"version":"CommandV1","origId":111781,"guid":"57da9bf8-4a23-4f7b-b9e5-9d1e8bebf37f","subtype":"command","commandType":"auto","position":1.99981689453125,"command":"display(dbutils.fs.ls(\"/mnt/s3Data/twitterNew2/\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704200000.txt/","tweets_1463704200000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704500000.txt/","tweets_1463704500000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704800000.txt/","tweets_1463704800000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705100000.txt/","tweets_1463705100000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705400000.txt/","tweets_1463705400000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705700000.txt/","tweets_1463705700000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463706000000.txt/","tweets_1463706000000.txt/",0.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463706305243E12,"submitTime":1.463706301728E12,"finishTime":1.463706305613E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4f90a141-5dd4-4de2-8b6b-2d768a145fcb"},{"version":"CommandV1","origId":111782,"guid":"a4e0eb2d-3ced-4431-a42f-5eca862140d1","subtype":"command","commandType":"auto","position":1.9998321533203125,"command":"%md\nRead each RDD in the DStream as Text File ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"56600921-2984-4161-8d3b-1956b4eae1d5"},{"version":"CommandV1","origId":111783,"guid":"d451e2cf-a9cc-419d-8e55-ff050b28e211","subtype":"command","commandType":"auto","position":1.999847412109375,"command":"val rdd1 = sc.textFile(s\"/mnt/s3Data/twitterNew2/tweets_1463704200000.txt/\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rdd1: org.apache.spark.rdd.RDD[String] = /mnt/s3Data/twitterNew2/tweets_1463704200000.txt/ MapPartitionsRDD[23] at textFile at &lt;console&gt;:46\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463704344403E12,"submitTime":1.463704340969E12,"finishTime":1.463704344522E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e3dd2c87-2266-4246-92c1-82c33d6a7a71"},{"version":"CommandV1","origId":111784,"guid":"d0e34200-e6c2-49c1-ba88-685506985883","subtype":"command","commandType":"auto","position":1.9998626708984375,"command":"rdd1.count","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res7: Long = 6161\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: /mnt/s3Data/twitterNew/tweets_146192040000","error":"<div class=\"ansiout\">\tat org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:197)\n\tat org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:208)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:199)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1934)\n\tat org.apache.spark.rdd.RDD.count(RDD.scala:1157)</div>","workflows":[],"startTime":1.463704347278E12,"submitTime":1.463704343834E12,"finishTime":1.463704349444E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b270a085-cb89-427c-99e4-7df25f7a5b9b"},{"version":"CommandV1","origId":111785,"guid":"d91bade1-9ad4-41e9-a701-43cc6713e014","subtype":"command","commandType":"auto","position":1.9998703002929688,"command":"rdd1.take(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res8: Array[String] = Array({&quot;createdAt&quot;:&quot;May 20, 2016 12:27:12 AM&quot;,&quot;id&quot;:733453989484732416,&quot;text&quot;:&quot;????????????(/ _ ; )\\n??????????&quot;,&quot;source&quot;:&quot;\\u003ca href\\u003d\\&quot;http://twitter.com/download/iphone\\&quot; rel\\u003d\\&quot;nofollow\\&quot;\\u003eTwitter for iPhone\\u003c/a\\u003e&quot;,&quot;isTruncated&quot;:false,&quot;inReplyToStatusId&quot;:-1,&quot;inReplyToUserId&quot;:-1,&quot;isFavorited&quot;:false,&quot;isRetweeted&quot;:false,&quot;favoriteCount&quot;:0,&quot;retweetCount&quot;:0,&quot;isPossiblySensitive&quot;:false,&quot;lang&quot;:&quot;ja&quot;,&quot;contributorsIDs&quot;:[],&quot;userMentionEntities&quot;:[],&quot;urlEntities&quot;:[],&quot;hashtagEntities&quot;:[],&quot;mediaEntities&quot;:[],&quot;extendedMediaEntities&quot;:[],&quot;symbolEntities&quot;:[],&quot;currentUserRetweetId&quot;:-1,&quot;user&quot;:{&quot;id&quot;:282430900,&quot;name&quot;:&quot;??&quot;,&quot;screenName&quot;:&quot;chika22c7&quot;,&quot;location&quot;:&quot;???(Ag_chika22c7)??????3?Z?&quot;,&quot;description&quot;:&quot;??????Kis-My-Ft2(?????)?B?z??????????????????????????????????? ?????????????2??????????? ??????? ???? ???????????J? ??????? ????????????????? ???ID:378792&quot;,&quot;descriptionURLEntities&quot;:[],&quot;isContributorsEnabled&quot;:false,&quot;profileImageUrl&quot;:&quot;http://pbs.twimg.com/profile_images/595666941462843392/-dKjjuMu_normal.jpg&quot;,&quot;profileImageUrlHttps&quot;:&quot;https://pbs.twimg.com/profile_images/595666941462843392/-dKjjuMu_normal.jpg&quot;,&quot;isDefaultProfileImage&quot;:false,&quot;isProtected&quot;:false,&quot;followersCount&quot;:377,&quot;profileBackgroundColor&quot;:&quot;C0DEED&quot;,&quot;profileTextColor&quot;:&quot;333333&quot;,&quot;profileLinkColor&quot;:&quot;0084B4&quot;,&quot;profileSidebarFillColor&quot;:&quot;DDEEF6&quot;,&quot;profileSidebarBorderColor&quot;:&quot;C0DEED&quot;,&quot;profileUseBackgroundImage&quot;:true,&quot;isDefaultProfile&quot;:true,&quot;showAllInlineMedia&quot;:false,&quot;friendsCount&quot;:735,&quot;createdAt&quot;:&quot;Apr 15, 2011 5:59:44 AM&quot;,&quot;favouritesCount&quot;:19482,&quot;utcOffset&quot;:32400,&quot;timeZone&quot;:&quot;Tokyo&quot;,&quot;profileBackgroundImageUrl&quot;:&quot;http://abs.twimg.com/images/themes/theme1/bg.png&quot;,&quot;profileBackgroundImageUrlHttps&quot;:&quot;https://abs.twimg.com/images/themes/theme1/bg.png&quot;,&quot;profileBannerImageUrl&quot;:&quot;https://pbs.twimg.com/profile_banners/282430900/1427615662&quot;,&quot;profileBackgroundTiled&quot;:false,&quot;lang&quot;:&quot;ja&quot;,&quot;statusesCount&quot;:68522,&quot;isGeoEnabled&quot;:true,&quot;isVerified&quot;:false,&quot;translator&quot;:false,&quot;listedCount&quot;:11,&quot;isFollowRequestSent&quot;:false},&quot;quotedStatusId&quot;:-1})\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:58: error: missing arguments for method top in class RDD;\nfollow this method with `_' if you want to treat it as a partially applied function\n              rdd1.top\n                   ^\n</div>","error":null,"workflows":[],"startTime":1.463704353048E12,"submitTime":1.463704349599E12,"finishTime":1.463704353452E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1a56e3a9-0402-447b-8b29-f64e08519f08"},{"version":"CommandV1","origId":111786,"guid":"850b7319-4750-4be9-bce7-746acf15d64a","subtype":"command","commandType":"auto","position":1.9998779296875,"command":"display(dbutils.fs.ls(s\"/mnt/$MountName/${outputDirectory}\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704200000.txt/","tweets_1463704200000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704500000.txt/","tweets_1463704500000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463704800000.txt/","tweets_1463704800000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705100000.txt/","tweets_1463705100000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705400000.txt/","tweets_1463705400000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463705700000.txt/","tweets_1463705700000.txt/",0.0],["dbfs:/mnt/s3Data/twitterNew2/tweets_1463706000000.txt/","tweets_1463706000000.txt/",0.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"java.io.FileNotFoundException: /mnt/$MountName/${outputDirectory}","error":"<div class=\"ansiout\">\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:65)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:42)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.listStatus(DatabricksFileSystem.scala:189)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.ls(DBUtilsCore.scala:61)\n\tat com.databricks.dbutils_v1.impl.DbfsUtilsImpl.ls(DbfsUtilsImpl.scala:29)</div>","workflows":[],"startTime":1.463706319285E12,"submitTime":1.463706315772E12,"finishTime":1.463706319534E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3ffd9561-f5dc-4748-a31e-d35bf7576334"},{"version":"CommandV1","origId":111787,"guid":"b29ee48b-0a63-40ee-affd-052c72330dd7","subtype":"command","commandType":"auto","position":1.99993896484375,"command":"%md\n### 5. Read all the RDD as a Whole Text File","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.461918743494E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6ed7cd64-0367-43fc-82a9-80c5fb856451"},{"version":"CommandV1","origId":111788,"guid":"4a3ec08f-b654-4c83-aff2-de07dbefc405","subtype":"command","commandType":"auto","position":1.9999542236328125,"command":"//val dStream = sc.wholeTextFiles(s\"/mnt/$MountName/${outputDirectory}\")\nval dStream = sc.textFile(s\"/mnt/s3Data/twitterNew2/*.txt/\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dStream: org.apache.spark.rdd.RDD[String] = /mnt/s3Data/twitterNew2/*.txt/ MapPartitionsRDD[98] at textFile at &lt;console&gt;:47\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463706332432E12,"submitTime":1.463706328908E12,"finishTime":1.463706332503E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4c1262fd-9a9d-4ccd-b0c4-3b4d764c9330"},{"version":"CommandV1","origId":111789,"guid":"470707cb-dd46-49f3-a0b3-e4259e52b6d1","subtype":"command","commandType":"auto","position":1.999969482421875,"command":"dStream.take(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res14: Array[String] = Array({&quot;createdAt&quot;:&quot;May 20, 2016 12:27:12 AM&quot;,&quot;id&quot;:733453989484732416,&quot;text&quot;:&quot;????????????(/ _ ; )\\n??????????&quot;,&quot;source&quot;:&quot;\\u003ca href\\u003d\\&quot;http://twitter.com/download/iphone\\&quot; rel\\u003d\\&quot;nofollow\\&quot;\\u003eTwitter for iPhone\\u003c/a\\u003e&quot;,&quot;isTruncated&quot;:false,&quot;inReplyToStatusId&quot;:-1,&quot;inReplyToUserId&quot;:-1,&quot;isFavorited&quot;:false,&quot;isRetweeted&quot;:false,&quot;favoriteCount&quot;:0,&quot;retweetCount&quot;:0,&quot;isPossiblySensitive&quot;:false,&quot;lang&quot;:&quot;ja&quot;,&quot;contributorsIDs&quot;:[],&quot;userMentionEntities&quot;:[],&quot;urlEntities&quot;:[],&quot;hashtagEntities&quot;:[],&quot;mediaEntities&quot;:[],&quot;extendedMediaEntities&quot;:[],&quot;symbolEntities&quot;:[],&quot;currentUserRetweetId&quot;:-1,&quot;user&quot;:{&quot;id&quot;:282430900,&quot;name&quot;:&quot;??&quot;,&quot;screenName&quot;:&quot;chika22c7&quot;,&quot;location&quot;:&quot;???(Ag_chika22c7)??????3?Z?&quot;,&quot;description&quot;:&quot;??????Kis-My-Ft2(?????)?B?z??????????????????????????????????? ?????????????2??????????? ??????? ???? ???????????J? ??????? ????????????????? ???ID:378792&quot;,&quot;descriptionURLEntities&quot;:[],&quot;isContributorsEnabled&quot;:false,&quot;profileImageUrl&quot;:&quot;http://pbs.twimg.com/profile_images/595666941462843392/-dKjjuMu_normal.jpg&quot;,&quot;profileImageUrlHttps&quot;:&quot;https://pbs.twimg.com/profile_images/595666941462843392/-dKjjuMu_normal.jpg&quot;,&quot;isDefaultProfileImage&quot;:false,&quot;isProtected&quot;:false,&quot;followersCount&quot;:377,&quot;profileBackgroundColor&quot;:&quot;C0DEED&quot;,&quot;profileTextColor&quot;:&quot;333333&quot;,&quot;profileLinkColor&quot;:&quot;0084B4&quot;,&quot;profileSidebarFillColor&quot;:&quot;DDEEF6&quot;,&quot;profileSidebarBorderColor&quot;:&quot;C0DEED&quot;,&quot;profileUseBackgroundImage&quot;:true,&quot;isDefaultProfile&quot;:true,&quot;showAllInlineMedia&quot;:false,&quot;friendsCount&quot;:735,&quot;createdAt&quot;:&quot;Apr 15, 2011 5:59:44 AM&quot;,&quot;favouritesCount&quot;:19482,&quot;utcOffset&quot;:32400,&quot;timeZone&quot;:&quot;Tokyo&quot;,&quot;profileBackgroundImageUrl&quot;:&quot;http://abs.twimg.com/images/themes/theme1/bg.png&quot;,&quot;profileBackgroundImageUrlHttps&quot;:&quot;https://abs.twimg.com/images/themes/theme1/bg.png&quot;,&quot;profileBannerImageUrl&quot;:&quot;https://pbs.twimg.com/profile_banners/282430900/1427615662&quot;,&quot;profileBackgroundTiled&quot;:false,&quot;lang&quot;:&quot;ja&quot;,&quot;statusesCount&quot;:68522,&quot;isGeoEnabled&quot;:true,&quot;isVerified&quot;:false,&quot;translator&quot;:false,&quot;listedCount&quot;:11,&quot;isFollowRequestSent&quot;:false},&quot;quotedStatusId&quot;:-1})\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.io.IOException: Not a file: dbfs:/mnt/s3Data/twitterNew2/tweets_1463704200000.txt","error":"<div class=\"ansiout\">\tat org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:215)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:199)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.RDD$$anonfun$take$1.apply(RDD.scala:1307)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:150)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:111)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:316)\n\tat org.apache.spark.rdd.RDD.take(RDD.scala:1302)</div>","workflows":[],"startTime":1.463704526383E12,"submitTime":1.463704522915E12,"finishTime":1.463704527E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4ed8b787-331f-48ae-bf02-745c1cc3ed00"},{"version":"CommandV1","origId":111790,"guid":"f56ad5b8-999d-426c-9890-4c83b457e8a4","subtype":"command","commandType":"auto","position":1.9999771118164062,"command":"dStream.count //This returns the number of events or tweets in all the RDD stream","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res31: Long = 75410\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.ArrayIndexOutOfBoundsException: 0","error":"<div class=\"ansiout\">\tat org.apache.hadoop.mapreduce.lib.input.CombineFileInputFormat$OneFileInfo.&lt;init&gt;(CombineFileInputFormat.java:506)\n\tat org.apache.hadoop.mapreduce.lib.input.CombineFileInputFormat.getMoreSplits(CombineFileInputFormat.java:285)\n\tat org.apache.hadoop.mapreduce.lib.input.CombineFileInputFormat.getSplits(CombineFileInputFormat.java:245)\n\tat org.apache.spark.rdd.WholeTextFileRDD.getPartitions(WholeTextFileRDD.scala:49)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1934)\n\tat org.apache.spark.rdd.RDD.count(RDD.scala:1157)</div>","workflows":[],"startTime":1.463706335214E12,"submitTime":1.463706331694E12,"finishTime":1.463706338029E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9649e556-6d60-4dc0-8d99-066aa39b8e4e"},{"version":"CommandV1","origId":111791,"guid":"195fc2d8-af3e-4455-a5fc-5ffcfd4ceaa0","subtype":"command","commandType":"auto","position":1.9999799728393555,"command":"%md\nA better way of Merging the Files.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2cdcdf80-afd2-4d3b-9771-b843389b01f2"},{"version":"CommandV1","origId":111792,"guid":"bf0c8b1e-18e3-487d-b6e0-9219e1208d67","subtype":"command","commandType":"auto","position":1.9999828338623047,"command":"val dStreamw = sc.wholeTextFiles(s\"/mnt/s3Data/twitterNew2/*.txt/\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dStreamw: org.apache.spark.rdd.RDD[(String, String)] = /mnt/s3Data/twitterNew2/*.txt/ MapPartitionsRDD[46] at wholeTextFiles at &lt;console&gt;:46\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463704725781E12,"submitTime":1.463704722322E12,"finishTime":1.463704725877E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2c927fb9-28df-468d-bdd1-06111170972c"},{"version":"CommandV1","origId":111793,"guid":"54198fec-826c-4e19-a4b9-f3db73048f9a","subtype":"command","commandType":"auto","position":1.9999885559082031,"command":"val dStreamTitle = dStreamw.map(rdd => rdd._1).collect","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dStreamTitle: Array[String] = Array(dbfs:/mnt/s3Data/twitterNew2/tweets_1463704200000.txt/part-00000, dbfs:/mnt/s3Data/twitterNew2/tweets_1463704500000.txt/part-00000)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:48: error: value _1 is not a member of String\n       val dStreamTitle = dStream.map(rdd =&gt; rdd._1).collect\n                                                 ^\n</div>","error":null,"workflows":[],"startTime":1.463704836807E12,"submitTime":1.46370483334E12,"finishTime":1.463704838254E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"43078cdd-1b1a-4f00-9401-76df387412b1"},{"version":"CommandV1","origId":111794,"guid":"d1be31ba-1386-4284-b242-5f0e11b63f71","subtype":"command","commandType":"auto","position":1.9999942779541016,"command":"val dStreamContent = dStreamw.map(rdd => rdd._2)\ndStreamContent.cache","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dStreamContent: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[90] at map at &lt;console&gt;:50\nres26: dStreamContent.type = MapPartitionsRDD[90] at map at &lt;console&gt;:50\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463706249956E12,"submitTime":1.463706246417E12,"finishTime":1.46370625003E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a5ed8ea5-5da7-4cec-9fd4-7ee3bbb2aa3f"},{"version":"CommandV1","origId":111795,"guid":"c4f830d8-2aa8-4ae8-ae3f-e6e6674dd9ef","subtype":"command","commandType":"auto","position":1.9999971389770508,"command":"dStreamContent.take(1)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b4738c12-c8a6-461d-9791-f9d2c3d51f7b"},{"version":"CommandV1","origId":111796,"guid":"d94f6020-cb3b-4b95-88b3-aa1036807382","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n\n### Course Project by [Akinwande Atanda](https://nz.linkedin.com/in/akinwande-atanda)\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"504d59a3-a8af-463f-8f12-3a03dedf7012"}],"dashboards":[],"guid":"b56ab366-e907-4ccd-99ac-4f13214681ab","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"2. Recompute the top hashtags every N seconds":{"nuid":"8d42296a-aac0-4a29-93a3-f689053077ef","currentValue":"300","widgetInfo":{"widgetType":"text","name":"2. Recompute the top hashtags every N seconds","defaultValue":"1","label":"","options":{"widgetType":"text","validationRegex":null}}},"4. MNT_NAME":{"nuid":"418ba380-05b8-4d08-a57a-d4233777b087","currentValue":"s3Data","widgetInfo":{"widgetType":"text","name":"4. MNT_NAME","defaultValue":"REPLACE_WITH_YOUR_MOUNT_NAME","label":"","options":{"widgetType":"text","validationRegex":null}}},"2. SECRET_KEY":{"nuid":"7b97b1ef-a2f6-4139-aedc-4a5cc624c545","currentValue":"","widgetInfo":{"widgetType":"text","name":"2. SECRET_KEY","defaultValue":"REPLACE_WITH_YOUR_SECRET_KEY","label":"","options":{"widgetType":"text","validationRegex":null}}},"3. Compute the top hashtags for the last N seconds":{"nuid":"a5710cf4-70ac-4289-8789-3708ce681f58","currentValue":"5","widgetInfo":{"widgetType":"text","name":"3. Compute the top hashtags for the last N seconds","defaultValue":"5","label":"","options":{"widgetType":"text","validationRegex":null}}},"3. S3_BUCKET":{"nuid":"abaf84f9-6175-4645-85ad-0ca6234cfa9e","currentValue":"sds-twitter","widgetInfo":{"widgetType":"text","name":"3. S3_BUCKET","defaultValue":"REPLACE_WITH_YOUR_S3_BUCKET","label":"","options":{"widgetType":"text","validationRegex":null}}},"1. Output Directory":{"nuid":"10841baf-c975-45a3-82f1-f0ffb7958911","currentValue":"/twitterNew2","widgetInfo":{"widgetType":"text","name":"1. Output Directory","defaultValue":"/twitterNew2","label":"","options":{"widgetType":"text","validationRegex":null}}},"1. ACCESS_KEY":{"nuid":"ec4a6092-245e-4fd5-9f35-76fee21a056c","currentValue":"","widgetInfo":{"widgetType":"text","name":"1. ACCESS_KEY","defaultValue":"REPLACE_WITH_YOUR_ACCESS_KEY","label":"","options":{"widgetType":"text","validationRegex":null}}},"1. Consumer Key (API Key)":{"nuid":"5ce483c4-1cbf-4a9f-af63-784698728459","currentValue":"","widgetInfo":{"widgetType":"text","name":"1. Consumer Key (API Key)","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}}},"2. Consumer Secret (API Secret)":{"nuid":"f14b6067-6212-4682-b4ea-e8f7f0d0e54c","currentValue":"","widgetInfo":{"widgetType":"text","name":"2. Consumer Secret (API Secret)","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}}},"4. Wait this many seconds before stopping the streaming job":{"nuid":"3ab48e6d-21e9-4a2b-b7b4-89957199bb29","currentValue":"604800","widgetInfo":{"widgetType":"text","name":"4. Wait this many seconds before stopping the streaming job","defaultValue":"100","label":"","options":{"widgetType":"text","validationRegex":null}}},"4. Access Token Secret":{"nuid":"3e222b90-7e4b-4053-9ac2-2c329da0835a","currentValue":"","widgetInfo":{"widgetType":"text","name":"4. Access Token Secret","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}}},"3. Access Token":{"nuid":"1d7ed522-4f04-4125-ab3b-378d48520033","currentValue":"","widgetInfo":{"widgetType":"text","name":"3. Access Token","defaultValue":"","label":"","options":{"widgetType":"text","validationRegex":null}}}}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201606222113370000-29e64bf9afe1117763a990704253c3678448e6c5/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
