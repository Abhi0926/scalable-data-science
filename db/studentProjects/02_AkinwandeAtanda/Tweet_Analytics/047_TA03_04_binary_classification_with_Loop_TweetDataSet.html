<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>047_TA03_04_binary_classification_with_Loop_TweetDataSet - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-sydney.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":false,"nameAndEmail":"Raazesh Sainudiin (r.sainudiin@math.canterbury.ac.nz)","enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-30-9-162-U0c2673ac85-Sa2ee4664b2-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-30-9-162-U0c2673ac85-S33a1e4b9c6-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-9-162-U0c2673ac85-S5917a1044d-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.0","packageLabel":"spark-1.6-jenkins-ip-10-30-9-162-U0c2673ac85-Scabba801f3-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.12.3","accountsLimit":-1,"enableNotebookGitBranching":true,"local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableUserInviteWorkflow":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-9-162-U0c2673ac85-S5917a1044d-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":false,"enableSparkConfUI":true,"enableOrgSwitcherUI":false,"clustersLimit":-1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"12bce259-f517-4e48-9d6f-2aff50eb3568","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"someName":"Raazesh Sainudiin","enableWorkspaceAcls":true,"gitHash":"0c2673ac858e227cad536fdb45d140aeded238db","userFullname":"Raazesh Sainudiin","enableClusterCreatePage":false,"enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100005,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Workspace 0","orgId":0}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","enableHybridClusters":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"r.sainudiin@math.canterbury.ac.nz","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"enableNewInputWidgetUI":false,"accounts":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":128213,"name":"047_TA03_04_binary_classification_with_Loop_TweetDataSet","language":"python","commands":[{"version":"CommandV1","origId":128409,"guid":"67b263c6-4015-49bc-ac9e-d7e5db092bb3","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n\n### Course Project by [Akinwande Atanda](https://nz.linkedin.com/in/akinwande-atanda)\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"30efe614-76ad-4b1d-8c2d-095ca7671718"},{"version":"CommandV1","origId":139301,"guid":"39874afe-ecf6-424f-8022-b0e57dd1e517","subtype":"command","commandType":"auto","position":0.625,"command":"%md\nThe [html source url](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/db/studentProjects/02_AkinwandeAtanda/Tweet_Analytics/047_TA03_04_binary_classification_with_Loop_TweetDataSet.html) of this databricks notebook and its recorded Uji ![Image of Uji, Dogen's Time-Being](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/UjiTimeBeingDogen.png \"uji\"):\n\n[![sds/uji/studentProjects/02_AkinwandeAtanda/Tweet_Analytics/047_TA03_04_binary_classification_with_Loop_TweetDataSet](http://img.youtube.com/vi/zJirlHAV6YU/0.jpg)](https://www.youtube.com/v/zJirlHAV6YU?rel=0&autoplay=1&modestbranding=1&start=0&end=1611)\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c1cda3ed-534f-4957-8674-474627a097de"},{"version":"CommandV1","origId":137828,"guid":"8fdc934a-ce7a-4ad7-95a1-9b9cb508c258","subtype":"command","commandType":"auto","position":0.75,"command":"%md\n#Tweet Analytics\n\n[Presentation contents](https://github.com/aaa121/Spark-Tweet-Streaming-Presentation-May-2016).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fa92a769-edbe-4f10-b08d-bdc467c031c2"},{"version":"CommandV1","origId":128215,"guid":"a25882c2-5d54-46f4-8496-3d6c515cd6dc","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Creating Pipeline with Loop and Productionizing with Historical Tweets","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464997291453E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"62a62372-79de-4b11-972e-8bc3a9a0cb7e"},{"version":"CommandV1","origId":128216,"guid":"02e5d76c-2403-4e48-b68f-58969133ec62","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.ml import *\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import *\nfrom pyspark.ml.classification import *\nfrom pyspark.ml.tuning import *\nfrom pyspark.ml.evaluation import *\nfrom pyspark.ml.regression import *\nfrom pyspark.sql.types import *","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464997335714E12,"submitTime":1.464997291516E12,"finishTime":1.464997335753E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"898dae34-6581-4757-b502-04acdfb5eb54"},{"version":"CommandV1","origId":128217,"guid":"e9fad7dc-6141-49ac-b4a5-333bc2a5497a","subtype":"command","commandType":"auto","position":2.5,"command":"df = table(\"pos_neg_category\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464997335756E12,"submitTime":1.464997291558E12,"finishTime":1.464997335828E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"553299ef-62f2-4fb2-b1b1-8f30c691e978"},{"version":"CommandV1","origId":128218,"guid":"b1261843-7948-4ddc-af8b-2ba45ca8913e","subtype":"command","commandType":"auto","position":2.75,"command":"df.dtypes","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>[(&apos;review&apos;, &apos;string&apos;), (&apos;category&apos;, &apos;double&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.46499733583E12,"submitTime":1.464997291605E12,"finishTime":1.464997335868E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b97825cf-4799-4f9a-bd3c-fb1f429835ec"},{"version":"CommandV1","origId":128219,"guid":"f509e69e-8d08-44e2-81a1-09d41069701c","subtype":"command","commandType":"auto","position":3.0,"command":"lrARValidate =[]\nlrARTest =[]\nparam = [0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]\nfor p in param:\n  bin = Binarizer(inputCol = \"category\", outputCol = \"label\", threshold = 0.5) # Positive reviews > 0.5 threshold\n  tok = Tokenizer(inputCol = \"review\", outputCol = \"word\") #Note: The column \"words\" in the original table can also contain sentences that will be tokenized\n  hashTF = HashingTF(inputCol = tok.getOutputCol(), numFeatures = 5000, outputCol = \"features\")\n  lr = LogisticRegression(maxIter = 10, regParam = 0.01, elasticNetParam = p)\n  pipeline = Pipeline(stages = [bin, tok, hashTF, lr])\n  (trainingData, validateData, testData) = df.randomSplit([0.6, 0.3, 0.1])\n  model = pipeline.fit(trainingData)\n  validateModel=model.transform(validateData)\n  evaluator = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\", metricName=\"precision\")\n  accuracyValidateSet = evaluator.evaluate(validateModel)\n  testModel=model.transform(testData)\n  accuracyTestSet = evaluator.evaluate(testModel)\n#   print(\"Logistic Regression Classifier Accuracy Rate for Validation Dataset = %g \" % (accuracyValidateSet))\n#   print(\"Logistic Regression Classifier Accuracy Rate for Test Dataset = %g \" % (accuracyTestSet))\n#   print(\"Test Error = %g \" % (1.0 - accuracy))\n  lrARValidate +=[(p,accuracyValidateSet)]\n  lrARTest +=[(p,accuracyTestSet)]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/spark/python/pyspark/ml/classification.py:207: UserWarning: weights is deprecated. Use coefficients instead.\n  warnings.warn(&quot;weights is deprecated. Use coefficients instead.&quot;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Double","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-4-4c4e8b52b1e8&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     10</span>   pipeline <span class=\"ansiyellow\">=</span> Pipeline<span class=\"ansiyellow\">(</span>stages <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>bin<span class=\"ansiyellow\">,</span> tok<span class=\"ansiyellow\">,</span> hashTF<span class=\"ansiyellow\">,</span> lr<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     11</span>   <span class=\"ansiyellow\">(</span>trainingData<span class=\"ansiyellow\">,</span> validateData<span class=\"ansiyellow\">,</span> testData<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>randomSplit<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0.6</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0.3</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0.1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 12</span><span class=\"ansiyellow\">   </span>model <span class=\"ansiyellow\">=</span> pipeline<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>trainingData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span>   validateModel<span class=\"ansiyellow\">=</span>model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>validateData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span>   evaluator <span class=\"ansiyellow\">=</span> MulticlassClassificationEvaluator<span class=\"ansiyellow\">(</span>labelCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;label&quot;</span><span class=\"ansiyellow\">,</span> predictionCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;prediction&quot;</span><span class=\"ansiyellow\">,</span> metricName<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;precision&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    209</span>                 <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>stage<span class=\"ansiyellow\">,</span> Transformer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    210</span>                     transformers<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>stage<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 211</span><span class=\"ansiyellow\">                     </span>dataset <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    212</span>                 <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span>  <span class=\"ansired\"># must be an Estimator</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    213</span>                     model <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">transform</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">    112</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    113</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 114</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    115</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    116</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be either a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_transform</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    146</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    147</span>     <span class=\"ansigreen\">def</span> _transform<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 148</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    149</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_transfer_params_to_java</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">     80</span>         <span class=\"ansigreen\">for</span> param <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>params<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     81</span>             <span class=\"ansigreen\">if</span> param <span class=\"ansigreen\">in</span> paramMap<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 82</span><span class=\"ansiyellow\">                 </span>pair <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_make_java_param_pair<span class=\"ansiyellow\">(</span>param<span class=\"ansiyellow\">,</span> paramMap<span class=\"ansiyellow\">[</span>param<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     83</span>                 self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>set<span class=\"ansiyellow\">(</span>pair<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     84</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_make_java_param_pair</span><span class=\"ansiblue\">(self, param, value)</span>\n<span class=\"ansigreen\">     71</span>         java_param <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>getParam<span class=\"ansiyellow\">(</span>param<span class=\"ansiyellow\">.</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     72</span>         java_value <span class=\"ansiyellow\">=</span> _py2java<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">,</span> value<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 73</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> java_param<span class=\"ansiyellow\">.</span>w<span class=\"ansiyellow\">(</span>java_value<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     74</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     75</span>     <span class=\"ansigreen\">def</span> _transfer_params_to_java<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o107.w.\n: java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Double\n\tat scala.runtime.BoxesRunTime.unboxToDouble(BoxesRunTime.java:119)\n\tat org.apache.spark.ml.param.DoubleParam.w(params.scala:223)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","startTime":1.46499733587E12,"submitTime":1.464997291676E12,"finishTime":1.464997351834E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4da170d9-15b2-44c1-aa59-dc8d8015e431"},{"version":"CommandV1","origId":128220,"guid":"0f88e564-7479-484e-ac6f-58910443a880","subtype":"command","commandType":"auto","position":4.5,"command":"#display(pipeline)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997351838E12,"submitTime":1.46499729174E12,"finishTime":1.464997351909E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6f8705de-d2f4-4736-b231-0f8c92041d60"},{"version":"CommandV1","origId":128221,"guid":"237f969c-28a7-4172-90cb-911e732527a7","subtype":"command","commandType":"auto","position":4.75,"command":"lrARValidate","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>[(0.1, 0.6378783778559555), (1.0, 0.5782838862017747)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997351911E12,"submitTime":1.464997291783E12,"finishTime":1.464997351921E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0b0e1722-656e-407c-8223-5ab67e7d49aa"},{"version":"CommandV1","origId":128222,"guid":"1365af53-2b5e-44a3-a5f5-ef5558c66e15","subtype":"command","commandType":"auto","position":4.875,"command":"lrARTest","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>[(0.1, 0.6456737912904332), (1.0, 0.5779302458547741)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997351923E12,"submitTime":1.464997291838E12,"finishTime":1.464997351945E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b02b38e3-5f7c-4058-bf29-b5a191558b01"},{"version":"CommandV1","origId":128223,"guid":"bb5d82ed-9298-4f61-a708-630bdb30839e","subtype":"command","commandType":"auto","position":5.0,"command":"print(\"Logistic Regression Classifier Accuracy Rate for Validation Dataset= \", lrARValidate)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;Logistic Regression Classifier Accuracy Rate for Validation Dataset= &apos;, [(0.1, 0.6378783778559555), (1.0, 0.5782838862017747)])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997351947E12,"submitTime":1.464997291882E12,"finishTime":1.464997351986E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"61e8e373-a80c-4e38-b097-77665ca9c7d7"},{"version":"CommandV1","origId":128224,"guid":"ad2bbcb4-e9a3-4491-9211-75830d691c2a","subtype":"command","commandType":"auto","position":5.875,"command":"print(\"Logistic Regression Classifier Accuracy Rate for Test Dataset= \", lrARTest)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;Logistic Regression Classifier Accuracy Rate for Test Dataset= &apos;, [(0.1, 0.6456737912904332), (1.0, 0.5779302458547741)])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997351988E12,"submitTime":1.464997291938E12,"finishTime":1.46499735201E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f29df32e-de64-4f99-a1ff-fd3a0ed752a8"},{"version":"CommandV1","origId":128225,"guid":"c87d265e-48f5-4a68-b23b-4317c976cd85","subtype":"command","commandType":"auto","position":10.0,"command":"%md \n## Productionizing with Historical Tweets","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464997292121E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ba9e6b95-7a00-4e35-9d8a-e190f92bf4e9"},{"version":"CommandV1","origId":128389,"guid":"dee0f51b-4ab4-4419-b30a-aeff15297340","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n**Load/Read the saved Tweets in Parquet format**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a75f1ea3-2cba-418e-8ed4-103971501b6f"},{"version":"CommandV1","origId":128226,"guid":"7df664f6-bc9a-4374-b11f-bb15929fe153","subtype":"command","commandType":"auto","position":12.0,"command":"trumpTweet = sqlContext.read.parquet(\"dbfs:/mnt/s3Data/TrumpSentiment.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997352117E12,"submitTime":1.464997292216E12,"finishTime":1.464997353091E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3c91a9c4-8785-4b87-99b2-1a4557e5edc7"},{"version":"CommandV1","origId":128390,"guid":"395f0309-8195-4fd4-bbbe-e06b66ef6329","subtype":"command","commandType":"auto","position":12.5,"command":"%md\n**Convert to Table**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d5e014b2-4589-4966-b4e0-4a95aa71001f"},{"version":"CommandV1","origId":128227,"guid":"a81245ca-8445-4413-af86-d9de7633c3ec","subtype":"command","commandType":"auto","position":13.0,"command":"trumpTweet.registerTempTable('TrumpTweetTable')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997353094E12,"submitTime":1.464997292272E12,"finishTime":1.464997353117E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"590500e4-4b62-4b4a-ac38-6ed38bcee2aa"},{"version":"CommandV1","origId":128228,"guid":"babdf43c-1678-494c-b72e-293ce725d655","subtype":"command","commandType":"auto","position":14.25,"command":"tT=sqlContext.read.table('TrumpTweetTable')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464997353143E12,"submitTime":1.464997292366E12,"finishTime":1.464997353153E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"022684e4-09b3-4694-bbc0-7217e1e7c37a"},{"version":"CommandV1","origId":128391,"guid":"6552615a-988d-47b8-9e59-5ff408265335","subtype":"command","commandType":"auto","position":14.375,"command":"%md\n**Read the data type of each column in the table**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fe4b5aec-3953-4dcf-b62c-9c6ef1061f06"},{"version":"CommandV1","origId":128230,"guid":"ae61857f-1ae3-433e-8b3d-56e1c4972c8b","subtype":"command","commandType":"auto","position":14.5,"command":"trumpTweet.dtypes","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>[(&apos;date&apos;, &apos;string&apos;), (&apos;review&apos;, &apos;string&apos;), (&apos;category&apos;, &apos;double&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997370311E12,"submitTime":1.464997327594E12,"finishTime":1.46499737035E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d8d9756e-6338-47a6-bf9e-797953ea9bbe"},{"version":"CommandV1","origId":128231,"guid":"c8bcab09-df47-4623-b6c7-9657c5f2cab9","subtype":"command","commandType":"auto","position":15.5,"command":"# sqlContext.sql(\"SELECT COUNT(*) FROM TrumpTweetTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">32</span><span class=\"ansired\">]: </span>DataFrame[_c0: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997373679E12,"submitTime":1.46499733097E12,"finishTime":1.46499737375E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"39c1ce7c-af04-4806-8e36-844ee60c2d37"},{"version":"CommandV1","origId":128392,"guid":"973f5a53-d3aa-454e-ba96-cda8afec6e17","subtype":"command","commandType":"auto","position":15.6875,"command":"%md\n**Change the favourite count from double to float**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5397d32c-87c3-4cf3-a248-888349c53bd1"},{"version":"CommandV1","origId":128232,"guid":"aa91f824-2c61-479b-a938-8a15dbd737f8","subtype":"command","commandType":"auto","position":15.875,"command":"sqlContext.sql(\"SELECT date, review, CAST(category as FLOAT) as category FROM TrumpTweetTable order by date asc\").cache","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">33</span><span class=\"ansired\">]: </span>&lt;bound method DataFrame.cache of DataFrame[date: string, review: string, category: float]&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997376293E12,"submitTime":1.464997333574E12,"finishTime":1.464997376365E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7264016b-8546-421d-8dd3-9a073336475e"},{"version":"CommandV1","origId":128393,"guid":"5a981926-c78f-4e1b-b92a-a3ac4c958feb","subtype":"command","commandType":"auto","position":16.1875,"command":"%md\n**Randomly split Dataframe into two or three sets**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4b5c6408-c4bb-4d20-be93-fae19056255f"},{"version":"CommandV1","origId":128233,"guid":"d9d43dba-8634-43e6-90b6-f26f6b6c41bd","subtype":"command","commandType":"auto","position":16.5,"command":"(trump1, trump2, trump3) = trumpTweet.randomSplit([0.1, 0.5, 0.4])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997378812E12,"submitTime":1.464997336112E12,"finishTime":1.464997378883E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1564560e-a911-4095-a592-907a6268f07c"},{"version":"CommandV1","origId":128395,"guid":"9d396808-20a9-46b6-8658-9cec43e30b0f","subtype":"command","commandType":"auto","position":16.75,"command":"%md\n**Transform the fitted algorithm to predict the category of the tweet being either positive or negative**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4a50e0c8-81fd-4bc8-8a5c-f546de6a4330"},{"version":"CommandV1","origId":128234,"guid":"164b016e-73f2-477f-be52-ad4292c21070","subtype":"command","commandType":"auto","position":17.0,"command":"#  tweetModel=model.transform(trump1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997380463E12,"submitTime":1.464997337747E12,"finishTime":1.464997380534E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"28f6d132-b880-41a0-99c7-00f50a69d33d"},{"version":"CommandV1","origId":128394,"guid":"7babfd73-a74f-498a-8674-2d15c22e864d","subtype":"command","commandType":"auto","position":17.125,"command":"%md\n**Transform the fitted algorithm to predict the category of the tweet being either positive or negative**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7cb6d29d-8bc7-4d78-a4cf-f58d01177da1"},{"version":"CommandV1","origId":128235,"guid":"5f031756-3bf9-435d-85f4-f9acc208292f","subtype":"command","commandType":"auto","position":17.25,"command":" tweetModel=model.transform(trumpTweet)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464997691262E12,"submitTime":1.464997648531E12,"finishTime":1.464997691335E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4a5bdafb-6cdf-4000-858f-21be121c1e07"},{"version":"CommandV1","origId":128396,"guid":"d1797213-d25b-4920-93fa-432217aad493","subtype":"command","commandType":"auto","position":17.3125,"command":"%md\n**Determine the accuracy rate of the predicted sentiment**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"919052fe-4f84-4278-b451-ed1b3e22a6b0"},{"version":"CommandV1","origId":128236,"guid":"28cf8281-4f9c-4e3a-a706-1452be233bf0","subtype":"command","commandType":"auto","position":17.375,"command":"evaluator = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\", metricName=\"precision\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997713508E12,"submitTime":1.464997670778E12,"finishTime":1.46499771358E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f8da7718-4737-4499-9674-37c78c801b3f"},{"version":"CommandV1","origId":128237,"guid":"0b9881d9-d87f-44d8-8b5e-8ea1452f0c2c","subtype":"command","commandType":"auto","position":17.4375,"command":"accuracytweetSet = evaluator.evaluate(tweetModel)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997717204E12,"submitTime":1.464997674472E12,"finishTime":1.46499772895E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e7fd0d9c-8037-4b91-91ce-173baecc756e"},{"version":"CommandV1","origId":128238,"guid":"167f550a-5f5b-4d17-8178-0073121c8d41","subtype":"command","commandType":"auto","position":17.46875,"command":"accuracytweetSet","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">47</span><span class=\"ansired\">]: </span>0.9636297109403585\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464997731136E12,"submitTime":1.464997688403E12,"finishTime":1.464997731159E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"726c5bf7-b7a2-46e4-9a07-aa8f48e11ec6"},{"version":"CommandV1","origId":128239,"guid":"ca8daff8-ea91-46f5-b9e9-26fc998868bf","subtype":"command","commandType":"auto","position":17.5,"command":"# display(tweetModel.select(\"prediction\", \"review\", \"probability\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":"Command skipped","error":null,"startTime":1.464997341437E12,"submitTime":1.464997341437E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"831c7972-01fa-49e1-915f-b312871cd376"},{"version":"CommandV1","origId":128397,"guid":"d461c2ca-3898-4aa2-bf23-28635ae4f31a","subtype":"command","commandType":"auto","position":17.625,"command":"%md\n**Display the predicted category, tweet and probability of the tweet being negative**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6492fd2d-2c99-4a86-ba68-27636fa0994c"},{"version":"CommandV1","origId":128240,"guid":"e8d4fc73-90f4-4ffb-8307-87a0b3515a7d","subtype":"command","commandType":"auto","position":17.75,"command":"tweetModel.select(\"prediction\", \"review\", \"probability\").show(100)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+--------------------+--------------------+\n|prediction|              review|         probability|\n+----------+--------------------+--------------------+\n|       0.0|https://t.co/jQXT...|[0.56937110854529...|\n|       0.0|RT @trump2016fan:...|[0.52851856873702...|\n|       0.0|I&apos;m suprised the ...|[0.56260106092759...|\n|       0.0|RT @DebAlwaystrum...|[0.53024480082842...|\n|       0.0|RT @Tez: I though...|[0.56768122620480...|\n|       0.0|RT @amrightnow: #...|[0.59246780939691...|\n|       0.0|RT @DVSblast: hey...|[0.53574373395612...|\n|       0.0|U.S. bombing of h...|[0.55963085430581...|\n|       1.0|seeing misha drag...|[0.48268112840342...|\n|       0.0|sometimes I reall...|[0.55399957398712...|\n|       0.0|@TheDonaldNews @r...|[0.53366646864077...|\n|       0.0|@vanaric_trump_1 ...|[0.56768122620480...|\n|       0.0|RT @ScottAdamsSay...|[0.56260106092759...|\n|       0.0|@Starbuck an he w...|[0.56696218904354...|\n|       0.0|RT @workdeluxe: m...|[0.62154517492904...|\n|       0.0|RT @rappanave: ??...|[0.56768122620480...|\n|       0.0|Fooling around in...|[0.52851856873702...|\n|       0.0|RT @mechanicaltru...|[0.56768122620480...|\n|       1.0|RT @bfraser747: I...|[0.49933576638198...|\n|       0.0|        donald trump|[0.56768122620480...|\n|       0.0|it got too rowdy ...|[0.58808065186919...|\n|       0.0|#RIPPrince LARGE ...|[0.56768122620480...|\n|       0.0|@corporatepigs29 ...|[0.56768122620480...|\n|       0.0|RT @SecureAmerica...|[0.55281627143342...|\n|       0.0|@vishnuhindusena ...|[0.56768122620480...|\n|       0.0|RT @DanDmb68: Whe...|[0.54141531919032...|\n|       0.0|Here comes the Da...|[0.56260106092759...|\n|       0.0|@Ruderealism part...|[0.57534611034439...|\n|       0.0|RT @ArsalaiH: The...|[0.56698878957064...|\n|       0.0|RT @larrymunchkin...|[0.54836686025294...|\n|       0.0|@georgeunangst33 ...|[0.58808065186919...|\n|       0.0|@DrJamesDManning ...|[0.56421985485282...|\n|       0.0|RT @swapapilots: ...|[0.52851856873702...|\n|       0.0|@trumpology @Momm...|[0.56732174307313...|\n|       0.0|RT @CorruptMsm: D...|[0.54920104800209...|\n|       0.0|RT @castielnov4k:...|[0.57954600885317...|\n|       0.0|also she said she...|[0.53038585999352...|\n|       0.0|RT @DebAlwaystrum...|[0.53024480082842...|\n|       0.0|RT @Aldebaran519:...|[0.56793570944472...|\n|       0.0|RT @DanDmb68: Whe...|[0.54141531919032...|\n|       0.0|RT @immigrant4tru...|[0.54029953487232...|\n|       0.0|&apos;Harvard, please ...|[0.56768122620480...|\n|       0.0|RT @immigrant4tru...|[0.58646224366093...|\n|       0.0|RT @bakedalaska: ...|[0.56260106092759...|\n|       0.0|Uniquely Canadian...|[0.56768122620480...|\n|       0.0|@INDIGOMEISH agre...|[0.56768122620480...|\n|       0.0|@ThatWeissGuy lik...|[0.56260106092759...|\n|       0.0|RT @ClovisStarMed...|[0.56793570944472...|\n|       0.0|RT @CcusackRaw: N...|[0.58013957971446...|\n|       0.0|RT @immigrant4tru...|[0.54029953487232...|\n|       0.0|@KevinMaddenDC @c...|[0.58381160110718...|\n|       0.0|The violence and ...|[0.50600513291187...|\n|       0.0|@LeeSr17 @jstew11...|[0.58698650585335...|\n|       0.0|RT @aracelydlt: s...|[0.50265358594996...|\n|       0.0|RT @DebAlwaystrum...|[0.58213373911312...|\n|       0.0|RT @TexasYankee00...|[0.54542943725769...|\n|       0.0|@realDonaldTrump ...|[0.56768122620480...|\n|       0.0|RT @bakedalaska: ...|[0.56260106092759...|\n|       0.0|RT @dude_gang: do...|[0.56768122620480...|\n|       0.0|RT @RickRWells: C...|[0.54542943725769...|\n|       0.0|RT @stumpinfortru...|[0.56768122620480...|\n|       0.0|Literally the fir...|[0.56260106092759...|\n|       0.0|@ValentineTronik ...|[0.53697949899012...|\n|       0.0|@SpecialReport we...|[0.53516107862462...|\n|       0.0|RT @amrightnow: #...|[0.56260106092759...|\n|       0.0|@immigrant4trump ...|[0.56768122620480...|\n|       0.0|RT @DebAlwaystrum...|[0.53024480082842...|\n|       0.0|@der_is_a_beast f...|[0.56768122620480...|\n|       0.0|RT @ASVP_Lou: My ...|[0.52336459580777...|\n|       0.0|@cher trump is no...|[0.56006985493037...|\n|       0.0|dat nigga trump w...|[0.56260106092759...|\n|       0.0|RT @iowa_trump: T...|[0.56768122620480...|\n|       0.0|why is our #potus...|[0.58409138479220...|\n|       0.0|RT @kittykaresles...|[0.53697949899012...|\n|       0.0|RT @thotfulvision...|[0.53215948717282...|\n|       0.0|RT @wef: Are you ...|[0.56768122620480...|\n|       0.0|RT @akshi0511: We...|[0.56768122620480...|\n|       0.0|RT @JamieW1776: I...|[0.56768122620480...|\n|       0.0|RT @wef: Are you ...|[0.56768122620480...|\n|       0.0|RT @swapapilots: ...|[0.52851856873702...|\n|       0.0|RT @trump2021: @e...|[0.56768122620480...|\n|       0.0|@pcgameplayer1 @C...|[0.56768122620480...|\n|       0.0|RT @immigrant4tru...|[0.56260106092759...|\n|       0.0|@ChloeBennet4 pil...|[0.55963085430581...|\n|       0.0|Trump Could B Fac...|[0.56768122620480...|\n|       0.0|RT @amrightnow: @...|[0.59246780939691...|\n|       0.0|RT @blacktrump: T...|[0.65702313163406...|\n|       0.0|RT @LuvRedWhiteBl...|[0.56291050279853...|\n|       0.0|@ChloeBennet4 tru...|[0.71602219168733...|\n|       0.0|RT @blacktrump: C...|[0.63162815079315...|\n|       0.0|is Donald trump s...|[0.54542943725769...|\n|       0.0|RT @bakedalaska: ...|[0.56260106092759...|\n|       0.0|RT @amrightnow: #...|[0.56768122620480...|\n|       0.0|RT @DebAlwaystrum...|[0.58213373911312...|\n|       0.0|RT @LeeBrya888825...|[0.54740272601895...|\n|       0.0|#trumpprotests   ...|[0.53366646864077...|\n|       0.0|https://t.co/kTI7...|[0.56768122620480...|\n|       0.0|RT @wef: Are you ...|[0.56768122620480...|\n|       0.0|RT @lilblnde: It&apos;...|[0.50716040383503...|\n|       0.0|RT @SeAnna022: Ca...|[0.53516107862462...|\n+----------+--------------------+--------------------+\nonly showing top 100 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464998501572E12,"submitTime":1.464998458779E12,"finishTime":1.464998503182E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"40dd1f7f-63bc-450c-977a-f65ed233ac6c"},{"version":"CommandV1","origId":128398,"guid":"4ca7ce61-a078-445b-a6f1-40af2b5c9642","subtype":"command","commandType":"auto","position":17.8125,"command":"%md\n**Save the sentiment category of the historical tweets for additional ETL**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f2b674ff-c27c-46d6-9b72-da0ec09d8355"},{"version":"CommandV1","origId":128241,"guid":"a68a3a1b-6eec-4059-838b-c16c0f52cf3a","subtype":"command","commandType":"auto","position":17.875,"command":"trumpSentiment=tweetModel.select(\"prediction\", \"review\", \"probability\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464998570695E12,"submitTime":1.464998527908E12,"finishTime":1.464998570766E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4201bd01-b801-4b74-aafb-022011f7d468"},{"version":"CommandV1","origId":128242,"guid":"69f7e9ca-4381-49b5-b2b7-9b341afe67d0","subtype":"command","commandType":"auto","position":17.890625,"command":"trumpSentiment.write.save(\"dbfs:/mnt/s3Data/trumpSen.parquet\")  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;path dbfs:/trumpSen.parquet already exists.;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-64-e4be807496c5&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>trumpSentiment<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>save<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;trumpSen.parquet&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">save</span><span class=\"ansiblue\">(self, path, format, mode, partitionBy, **options)</span>\n<span class=\"ansigreen\">    395</span>             self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>save<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    396</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 397</span><span class=\"ansiyellow\">             </span>self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>save<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    398</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    399</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.4</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     49</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     50</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 51</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     52</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     53</span>                 <span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;path dbfs:/trumpSen.parquet already exists.;&apos;\n</div>","startTime":1.464999591701E12,"submitTime":1.464999548841E12,"finishTime":1.464999609076E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3abbbea4-95ff-4f5d-b2d7-5b3d9aedd2b6"},{"version":"CommandV1","origId":128243,"guid":"bbe3f34e-a719-4596-ab3a-6a28f52955a3","subtype":"command","commandType":"auto","position":17.9375,"command":"trumpSentiment.show(50)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+--------------------+--------------------+\n|prediction|              review|         probability|\n+----------+--------------------+--------------------+\n|       0.0|https://t.co/jQXT...|[0.56937110854529...|\n|       0.0|RT @trump2016fan:...|[0.52851856873702...|\n|       0.0|I&apos;m suprised the ...|[0.56260106092759...|\n|       0.0|RT @DebAlwaystrum...|[0.53024480082842...|\n|       0.0|RT @Tez: I though...|[0.56768122620480...|\n|       0.0|RT @amrightnow: #...|[0.59246780939691...|\n|       0.0|RT @DVSblast: hey...|[0.53574373395612...|\n|       0.0|U.S. bombing of h...|[0.55963085430581...|\n|       1.0|seeing misha drag...|[0.48268112840342...|\n|       0.0|sometimes I reall...|[0.55399957398712...|\n|       0.0|@TheDonaldNews @r...|[0.53366646864077...|\n|       0.0|@vanaric_trump_1 ...|[0.56768122620480...|\n|       0.0|RT @ScottAdamsSay...|[0.56260106092759...|\n|       0.0|@Starbuck an he w...|[0.56696218904354...|\n|       0.0|RT @workdeluxe: m...|[0.62154517492904...|\n|       0.0|RT @rappanave: ??...|[0.56768122620480...|\n|       0.0|Fooling around in...|[0.52851856873702...|\n|       0.0|RT @mechanicaltru...|[0.56768122620480...|\n|       1.0|RT @bfraser747: I...|[0.49933576638198...|\n|       0.0|        donald trump|[0.56768122620480...|\n|       0.0|it got too rowdy ...|[0.58808065186919...|\n|       0.0|#RIPPrince LARGE ...|[0.56768122620480...|\n|       0.0|@corporatepigs29 ...|[0.56768122620480...|\n|       0.0|RT @SecureAmerica...|[0.55281627143342...|\n|       0.0|@vishnuhindusena ...|[0.56768122620480...|\n|       0.0|RT @DanDmb68: Whe...|[0.54141531919032...|\n|       0.0|Here comes the Da...|[0.56260106092759...|\n|       0.0|@Ruderealism part...|[0.57534611034439...|\n|       0.0|RT @ArsalaiH: The...|[0.56698878957064...|\n|       0.0|RT @larrymunchkin...|[0.54836686025294...|\n|       0.0|@georgeunangst33 ...|[0.58808065186919...|\n|       0.0|@DrJamesDManning ...|[0.56421985485282...|\n|       0.0|RT @swapapilots: ...|[0.52851856873702...|\n|       0.0|@trumpology @Momm...|[0.56732174307313...|\n|       0.0|RT @CorruptMsm: D...|[0.54920104800209...|\n|       0.0|RT @castielnov4k:...|[0.57954600885317...|\n|       0.0|also she said she...|[0.53038585999352...|\n|       0.0|RT @DebAlwaystrum...|[0.53024480082842...|\n|       0.0|RT @Aldebaran519:...|[0.56793570944472...|\n|       0.0|RT @DanDmb68: Whe...|[0.54141531919032...|\n|       0.0|RT @immigrant4tru...|[0.54029953487232...|\n|       0.0|&apos;Harvard, please ...|[0.56768122620480...|\n|       0.0|RT @immigrant4tru...|[0.58646224366093...|\n|       0.0|RT @bakedalaska: ...|[0.56260106092759...|\n|       0.0|Uniquely Canadian...|[0.56768122620480...|\n|       0.0|@INDIGOMEISH agre...|[0.56768122620480...|\n|       0.0|@ThatWeissGuy lik...|[0.56260106092759...|\n|       0.0|RT @ClovisStarMed...|[0.56793570944472...|\n|       0.0|RT @CcusackRaw: N...|[0.58013957971446...|\n|       0.0|RT @immigrant4tru...|[0.54029953487232...|\n+----------+--------------------+--------------------+\nonly showing top 50 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464997932674E12,"submitTime":1.464997889931E12,"finishTime":1.464997933354E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"499c6c00-177b-4f7d-931f-e1f067e8bab0"},{"version":"CommandV1","origId":128244,"guid":"fa0d1e66-2550-471e-a902-2369ab58d240","subtype":"command","commandType":"auto","position":19.21875,"command":"display(dbutils.fs.ls(\"dbfs:/mnt/s3Data\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/s3Data/TrumpSen.parquet/","TrumpSen.parquet/",0.0],["dbfs:/mnt/s3Data/TrumpSentiment.parquet/","TrumpSentiment.parquet/",0.0],["dbfs:/mnt/s3Data/TrumpTweet.parquet/","TrumpTweet.parquet/",0.0],["dbfs:/mnt/s3Data/TrumpTweetText.parquet/","TrumpTweetText.parquet/",0.0],["dbfs:/mnt/s3Data/filteredTweet/","filteredTweet/",0.0],["dbfs:/mnt/s3Data/textData/","textData/",0.0],["dbfs:/mnt/s3Data/trumpSen.parquet/","trumpSen.parquet/",0.0],["dbfs:/mnt/s3Data/tweetAll.parquet/","tweetAll.parquet/",0.0],["dbfs:/mnt/s3Data/twitter/","twitter/",0.0],["dbfs:/mnt/s3Data/twitterNew/","twitterNew/",0.0],["dbfs:/mnt/s3Data/twitterNew2/","twitterNew2/",0.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"startTime":1.464999614194E12,"submitTime":1.464999571336E12,"finishTime":1.464999614437E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1f760e10-ead0-4f40-a572-96cda3cb8eeb"},{"version":"CommandV1","origId":128245,"guid":"40b4770f-80f0-4284-ae88-bfe286f36913","subtype":"command","commandType":"auto","position":20.5,"command":"trumpSen= sqlContext.read.parquet(\"dbfs:/mnt/s3Data/trumpSen.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.AssertionError: assertion failed: No predefined schema found, and no Parquet data files or summary files found under dbfs:/mnt/s3Data/trumpSen.parquet.","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-63-fec538b5e4c3&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>trumpSen<span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>parquet<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;dbfs:/mnt/s3Data/trumpSen.parquet&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">parquet</span><span class=\"ansiblue\">(self, *paths)</span>\n<span class=\"ansigreen\">    213</span>         <span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;name&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;string&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;year&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;int&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;month&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;int&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;day&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;int&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    214</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 215</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>parquet<span class=\"ansiyellow\">(</span>_to_seq<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sqlContext<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">,</span> paths<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    216</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    217</span>     <span class=\"ansiyellow\">@</span>ignore_unicode_prefix<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o1076.parquet.\n: java.lang.AssertionError: assertion failed: No predefined schema found, and no Parquet data files or summary files found under dbfs:/mnt/s3Data/trumpSen.parquet.\n\tat scala.Predef$.assert(Predef.scala:179)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$MetadataCache$$readSchema(ParquetRelation.scala:512)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache$$anonfun$12.apply(ParquetRelation.scala:421)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache$$anonfun$12.apply(ParquetRelation.scala:421)\n\tat scala.Option.orElse(Option.scala:257)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$MetadataCache.refresh(ParquetRelation.scala:421)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$$metadataCache$lzycompute(ParquetRelation.scala:145)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.org$apache$spark$sql$execution$datasources$parquet$ParquetRelation$$metadataCache(ParquetRelation.scala:143)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$6.apply(ParquetRelation.scala:202)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation$$anonfun$6.apply(ParquetRelation.scala:202)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetRelation.dataSchema(ParquetRelation.scala:202)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema$lzycompute(interfaces.scala:636)\n\tat org.apache.spark.sql.sources.HadoopFsRelation.schema(interfaces.scala:635)\n\tat org.apache.spark.sql.execution.datasources.LogicalRelation.&lt;init&gt;(LogicalRelation.scala:37)\n\tat org.apache.spark.sql.SQLContext.baseRelationToDataFrame(SQLContext.scala:441)\n\tat org.apache.spark.sql.DataFrameReader.parquet(DataFrameReader.scala:316)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","startTime":1.464999623259E12,"submitTime":1.464999580394E12,"finishTime":1.464999624367E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bb63c70a-f0b7-4943-a207-55b30be8c444"},{"version":"CommandV1","origId":128246,"guid":"9f6e6b3e-f887-4693-864d-76f2feffc36c","subtype":"command","commandType":"auto","position":21.5,"command":"trumpSen.registerTempTable('trumpSenTable')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.46499970325E12,"submitTime":1.464999660355E12,"finishTime":1.464999703289E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6cef8413-73db-49d6-85e0-bb183f31ec8c"},{"version":"CommandV1","origId":128247,"guid":"e77ef683-7986-42aa-8489-ccf85e1c2129","subtype":"command","commandType":"auto","position":22.5,"command":"%sql SELECT COUNT(*) as TweetCount FROM trumpSenTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[13665.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"TweetCount","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"startTime":1.465000001371E12,"submitTime":1.464999958498E12,"finishTime":1.465000009929E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ad6ea277-4de0-4b44-ae78-e70ade2e83d6"},{"version":"CommandV1","origId":128248,"guid":"548f1694-011f-49ed-bf6a-8c7da0ef98c6","subtype":"command","commandType":"auto","position":23.0,"command":"%sql SELECT * FROM trumpSenTable WHERE prediction ==1 LIMIT 5","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.0,"seeing misha dragging trump is my purpose in life tbh",[1.0,2.0,[],[0.48268112840342325,0.5173188715965767]]],[1.0,"RT @bfraser747: If you live anywhere in California and want to Volunteer and help TEAM TRUMP please visit donaldjtrump/california https://t?",[1.0,2.0,[],[0.49933576638198324,0.5006642336180167]]],[1.0,"@trump2021 @BernieSanders I WAS THERE AND SAW MANY CHILDREN AND AT NO TIME PERSONALLY SAW ANY DANGER TO THEM  BERNIE U ARE THE DANGER 2 THEM",[1.0,2.0,[],[0.4835330483527228,0.5164669516472772]]],[1.0,"@politico yeah bobby, world is burning and understanding basketball rhetoric is key Maybe part of trump negotiations shld b throwing a chair",[1.0,2.0,[],[0.4642832423755324,0.5357167576244676]]],[1.0,"RT @bfraser747: If you live anywhere in California and want to Volunteer and help TEAM TRUMP please visit donaldjtrump/california https://t?",[1.0,2.0,[],[0.49933576638198324,0.5006642336180167]]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"prediction","type":"\"double\""},{"name":"review","type":"\"string\""},{"name":"probability","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"type\",\"type\":\"byte\",\"nullable\":true,\"metadata\":{}},{\"name\":\"size\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"indices\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"values\",\"type\":{\"type\":\"array\",\"elementType\":\"double\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}}]}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"startTime":1.465000564494E12,"submitTime":1.465000521581E12,"finishTime":1.465000566013E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9e5b2705-dcfe-4554-9522-b3b6fdded275"},{"version":"CommandV1","origId":128399,"guid":"b7505ab9-2372-4ef2-9e76-648725ad35c2","subtype":"command","commandType":"auto","position":23.25,"command":"%md\n**Count and plot the percentage of Tweets about Trump that is positive and negative**","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"106585ef-f3ac-4672-aafb-c8127e8a1201"},{"version":"CommandV1","origId":128249,"guid":"c7fba2c8-9f91-40ce-8d7c-dadacab43cc1","subtype":"command","commandType":"auto","position":23.5,"command":"%sql SELECT if(prediction == 1, \"positive\", \"negative\") as Sentiment, count(*) as TweetCount FROM trumpSenTable GROUP BY prediction ORDER BY prediction","commandVersion":0,"state":"finished","results":{"type":"table","data":[["negative",13168.0],["positive",497.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Sentiment","type":"\"string\""},{"name":"TweetCount","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: cannot resolve 'category' given input columns: [prediction, review, probability]; line 1 pos 44","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: cannot resolve 'category' given input columns: [prediction, review, probability]; line 1 pos 44\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:57)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:335)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:69)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:334)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionUp$1(QueryPlan.scala:108)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:118)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2$1.apply(QueryPlan.scala:122)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:122)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$2.apply(QueryPlan.scala:127)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:48)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:103)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableOnce$class.to(TraversableOnce.scala:273)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:265)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1157)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:252)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1157)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:127)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:57)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:121)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:50)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:44)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:34)\n\tat org.apache.spark.sql.DataFrame.<init>(DataFrame.scala:133)\n\tat org.apache.spark.sql.DataFrame$.apply(DataFrame.scala:52)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:816)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:169)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:169)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:121)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:31)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:154)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:31)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:169)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:169)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:121)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:116)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:31)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:154)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:31)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:483)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:480)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:381)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:212)\n\tat java.lang.Thread.run(Thread.java:745)\n","startTime":1.465000098621E12,"submitTime":1.465000055694E12,"finishTime":1.465000106924E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1663.066666","height":"156.066666","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"tripplehay777@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6973604f-144e-43ce-acf5-54354f7715d8"},{"version":"CommandV1","origId":128410,"guid":"6bd8d30d-ba7d-4d26-a16c-149aa704febf","subtype":"command","commandType":"auto","position":24.5,"command":"%md\n\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n\n### Course Project by [Akinwande Atanda](https://nz.linkedin.com/in/akinwande-atanda)\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2f6a5ad5-321a-4a5a-b2ae-ad3d206bb2e8"}],"dashboards":[],"guid":"98b6574a-41e1-45c9-8a35-1e3a6c722590","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
