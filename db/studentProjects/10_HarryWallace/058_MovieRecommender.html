<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>058_MovieRecommender - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-sydney.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":false,"nameAndEmail":"Raazesh Sainudiin (r.sainudiin@math.canterbury.ac.nz)","enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-30-9-162-U0c2673ac85-Sa2ee4664b2-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-30-9-162-U0c2673ac85-S33a1e4b9c6-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-9-162-U0c2673ac85-S5917a1044d-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.0","packageLabel":"spark-1.6-jenkins-ip-10-30-9-162-U0c2673ac85-Scabba801f3-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.12.3","accountsLimit":-1,"enableNotebookGitBranching":true,"local":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":false,"enableUserInviteWorkflow":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-9-162-U0c2673ac85-S5917a1044d-2016-02-09-02:05:59.455061","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":false,"enableSparkConfUI":true,"enableOrgSwitcherUI":false,"clustersLimit":-1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"12bce259-f517-4e48-9d6f-2aff50eb3568","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"someName":"Raazesh Sainudiin","enableWorkspaceAcls":true,"gitHash":"0c2673ac858e227cad536fdb45d140aeded238db","userFullname":"Raazesh Sainudiin","enableClusterCreatePage":false,"enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100005,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Workspace 0","orgId":0}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","enableHybridClusters":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"r.sainudiin@math.canterbury.ac.nz","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"enableNewInputWidgetUI":false,"accounts":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":123755,"name":"058_MovieRecommender","language":"scala","commands":[{"version":"CommandV1","origId":123757,"guid":"541d078c-279f-4045-943d-422a7a2f932a","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n## Movie Recommender\n\n### Scalable data science project by Harry Wallace\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)\n\nMost of the content below is from Module 5 of Anthony Joseph's edX course CS100-1x from the Community Edition of databricks that has been added to this databricks shard at [/#workspace/scalable-data-science/xtraResources/edXBigDataSeries2015/CS100-1x](/#workspace/scalable-data-science/xtraResources/edXBigDataSeries2015/CS100-1x) as extra resources for the project-focussed course [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/). Here we use scala instead of python.\n\n(done with significant assistance from Raazesh Sainudiin to write all the code in scala here)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835525357E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1a9b4cf8-31ad-4141-b476-9730e2265e57"},{"version":"CommandV1","origId":123758,"guid":"4b1c5efe-b186-46bf-8a11-8aec16e8be0d","subtype":"command","commandType":"auto","position":1.8203125,"command":"%md\n## What is Collaborarive Filtering?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835525395E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7ee8c70a-1418-4026-9917-54c75adc5963"},{"version":"CommandV1","origId":123760,"guid":"b8aa68e2-1008-488a-9207-2325a1b4c236","subtype":"command","commandType":"auto","position":1.826171875,"command":"%md\nSOURCE: Module 5 of AJ's course.\n\n\n## **Collaborative Filtering**\n\n**(watch now 61 seconds)**:\n\n[![Spark Summit East 2016 - What is Collaborative Filtering](http://img.youtube.com/vi/0HGELVQSHb8/0.jpg)](https://www.youtube.com/v/0HGELVQSHb8?rel=0&autoplay=1&modestbranding=1&start=18&end=79)\n\n\nLet us use MLlib to make personalized movie recommendations.\n \nWe are going to use a technique called [collaborative filtering][collab]. Collaborative filtering is a method of making automatic predictions (filtering) about the interests of a user by collecting preferences or taste information from many users (collaborating). The underlying assumption of the collaborative filtering approach is that if a person A has the same opinion as a person B on an issue, A is more likely to have B's opinion on a different issue x than to have the opinion on x of a person chosen randomly. You can read more about collaborative filtering [here][collab2].\n \nThe image below (from [Wikipedia][collab]) shows an example of predicting of the user's rating using collaborative filtering. At first, people rate different items (like videos, images, games). After that, the system is making predictions about a user's rating for an item, which the user has not rated yet. These predictions are built upon the existing ratings of other users, who have similar ratings with the active user. For instance, in the image below the system has made a prediction, that the active user will not like the video.\n\n![collaborative filtering](https://courses.edx.org/c4x/BerkeleyX/CS100.1x/asset/Collaborative_filtering.gif)\n \n[mllib]: https://spark.apache.org/mllib/\n[collab]: https://en.wikipedia.org/?title=Collaborative_filtering\n[collab2]: http://recommender-systems.org/collaborative-filtering/\n \n**Resources:**\n* [mllib](https://spark.apache.org/mllib/)\n* [Wikipedia - collaborative filtering](https://en.wikipedia.org/?title=Collaborative_filtering)\n* [Recommender Systems - collaborative filtering](http://recommender-systems.org/collaborative-filtering/)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835525535E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6b5884c9-5118-45e4-b3f7-a6fc90976090"},{"version":"CommandV1","origId":123761,"guid":"1f4c1acd-33cb-4f1f-b996-2d3681b959da","subtype":"command","commandType":"auto","position":1.82666015625,"command":"%md\nFor movie recommendations, we start with a matrix whose entries are movie ratings by users (shown in red in the diagram below).  Each column represents a user (shown in green) and each row represents a particular movie (shown in blue).\n \nSince not all users have rated all movies, we do not know all of the entries in this matrix, which is precisely why we need collaborative filtering.  For each user, we have ratings for only a subset of the movies.  With collaborative filtering, the idea is to approximate the ratings matrix by factorizing it as the product of two matrices: one that describes properties of each user (shown in green), and one that describes properties of each movie (shown in blue).\n \n![factorization](http://spark-mooc.github.io/web-assets/images/matrix_factorization.png)\n\nWe want to select these two matrices such that the error for the users/movie pairs where we know the correct ratings is minimized. The [Alternating Least Squares][als] algorithm does this by first randomly filling the users matrix with values and then optimizing the value of the movies such that the error is minimized.  Then, it holds the movies matrix constrant and optimizes the value of the user's matrix.  This alternation between which matrix to optimize is the reason for the \"alternating\" in the name.\n \nThis optimization is what's being shown on the right in the image above.  Given a fixed set of user factors (i.e., values in the users matrix), we use the known ratings to find the best values for the movie factors using the optimization written at the bottom of the figure.  Then we \"alternate\" and pick the best user factors given fixed movie factors.\n \nFor a simple example of what the users and movies matrices might look like, check out the [videos from Lecture 8][videos] or the [slides from Lecture 8][slides]\n[videos]: https://courses.edx.org/courses/BerkeleyX/CS100.1x/1T2015/courseware/00eb8b17939b4889a41a6d8d2f35db83/3bd3bba368be4102b40780550d3d8da6/\n[slides]: https://courses.edx.org/c4x/BerkeleyX/CS100.1x/asset/Week4Lec8.pdf\n[als]: https://en.wikiversity.org/wiki/Least-Squares_Method","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835525607E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5de3d3d6-66b9-42e1-bb92-6ec7f5a63f27"},{"version":"CommandV1","origId":123762,"guid":"305ddf9a-e67c-4661-8d21-40f6e05dd4e8","subtype":"command","commandType":"auto","position":1.8271484375,"command":"%md\nSee\n[http://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#collaborative-filtering](http://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#collaborative-filtering).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464841165156E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"r.sainudiin@math.canterbury.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d6a46d51-deb6-4a60-94ec-897d2fbd6059"},{"version":"CommandV1","origId":123763,"guid":"eadfb76a-5895-49b5-8e9c-e03a2136cc90","subtype":"command","commandType":"auto","position":1.8272705078125,"command":"display(dbutils.fs.ls(\"/databricks-datasets/cs100/lab4/data-001/\")) // The data is already here","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/cs100/lab4/data-001/movies.dat","movies.dat",171308.0],["dbfs:/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz","ratings.dat.gz",2837683.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"startTime":1.464835732402E12,"submitTime":1.464835525733E12,"finishTime":1.464835733638E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a1efb383-6735-44b5-8ab0-037974a75523"},{"version":"CommandV1","origId":123764,"guid":"92888950-ad95-4e7d-9e40-109251b0670a","subtype":"command","commandType":"auto","position":1.827301025390625,"command":"%md\n#### **Import**\nLet us import the relevant libraries for `mllib`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.4648355258E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"90f3d086-ca80-4bab-b715-69b974bb7d29"},{"version":"CommandV1","origId":123765,"guid":"59d0ce64-4c7f-40ce-93a8-818cc1174fd5","subtype":"command","commandType":"auto","position":1.8273162841796875,"command":"import org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464835733641E12,"submitTime":1.464835525899E12,"finishTime":1.464835733698E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d401df78-f6b5-4870-96d2-3f089009d115"},{"version":"CommandV1","origId":123766,"guid":"aa124cd8-3406-4769-895f-39baa9f39627","subtype":"command","commandType":"auto","position":1.82733154296875,"command":"%md\n#### **Preliminaries**\nWe read in each of the files and create an RDD consisting of parsed lines.\nEach line in the ratings dataset (`ratings.dat.gz`) is formatted as:\n  `UserID::MovieID::Rating::Timestamp`\nEach line in the movies (`movies.dat`) dataset is formatted as:\n  `MovieID::Title::Genres`\nThe `Genres` field has the format\n  `Genres1|Genres2|Genres3|...`\nThe format of these files is uniform and simple, so we can use `split()`.\n\nParsing the two files yields two RDDS\n* For each line in the ratings dataset, we create a tuple of (UserID, MovieID, Rating). We drop the timestamp because we do not need it for this exercise.\n* For each line in the movies dataset, we create a tuple of (MovieID, Title). We drop the Genres because we do not need them for this exercise.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.46483552599E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e1bbc846-dc1b-43af-8b7b-eca0772fa1db"},{"version":"CommandV1","origId":123767,"guid":"0c233e02-743a-40e8-a98e-5ef71ffe2215","subtype":"command","commandType":"auto","position":1.8273468017578125,"command":"val timedRatingsRDD = sc.textFile(\"/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz\").map { line =>\n      val fields = line.split(\"::\")\n      // format: (timestamp % 10, Rating(userId, movieId, rating))\n      (fields(3).toLong % 10, Rating(fields(0).toInt, fields(1).toInt, fields(2).toDouble))\n    }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">timedRatingsRDD: org.apache.spark.rdd.RDD[(Long, org.apache.spark.mllib.recommendation.Rating)] = MapPartitionsRDD[5669] at map at &lt;console&gt;:45\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:37: error: not found: value Rating\n             (fields(3).toLong % 10, Rating(fields(0).toInt, fields(1).toInt, fields(2).toDouble))\n                                     ^\n</div>","error":null,"startTime":1.464835733701E12,"submitTime":1.464835526209E12,"finishTime":1.464835733826E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ca7268c5-01ea-41cb-b1c3-3e4745e55d05"},{"version":"CommandV1","origId":126095,"guid":"09a98a3a-8c2b-4755-88e3-f99346ab1399","subtype":"command","commandType":"auto","position":1.8273487091064453,"command":"%md\nWe have a look at the first 10 entries in the Ratings RDD to check it's ok","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"855e3d7c-6b45-484b-bd7d-fa1c6e135795"},{"version":"CommandV1","origId":123768,"guid":"c818124f-2fba-40ee-9868-a257fe169e51","subtype":"command","commandType":"auto","position":1.8273506164550781,"command":"timedRatingsRDD.take(10).map(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(0,Rating(1,1193,5.0))\n(9,Rating(1,661,3.0))\n(8,Rating(1,914,3.0))\n(5,Rating(1,3408,4.0))\n(1,Rating(1,2355,5.0))\n(8,Rating(1,1197,3.0))\n(9,Rating(1,1287,5.0))\n(9,Rating(1,2804,5.0))\n(8,Rating(1,594,4.0))\n(8,Rating(1,919,4.0))\nres63: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:34: error: not found: value timedRatingsRDD\n              timedRatingsRDD.take(5).map(println)\n              ^\n</div>","error":null,"startTime":1.464838033394E12,"submitTime":1.464837830266E12,"finishTime":1.464838034016E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2516ff1a-52ed-4726-8313-7d916882c98a"},{"version":"CommandV1","origId":126103,"guid":"3b9fdffc-38b7-4870-a7d3-1e05fd9f7f18","subtype":"command","commandType":"auto","position":1.8273515701293945,"command":"%md\nThe timestamp is unused here so we want to remove it","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2cd562d0-1101-4889-bf8d-d63ad64142bd"},{"version":"CommandV1","origId":123770,"guid":"32bbbfd8-cd23-451c-b651-2bf478730bad","subtype":"command","commandType":"auto","position":1.827352523803711,"command":"val ratingsRDD = sc.textFile(\"/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz\").map { line =>\n      val fields = line.split(\"::\")\n      // format: Rating(userId, movieId, rating)\n      Rating(fields(0).toInt, fields(1).toInt, fields(2).toDouble)\n    }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratingsRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[5673] at map at &lt;console&gt;:45\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464835734541E12,"submitTime":1.464835526322E12,"finishTime":1.464835734667E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b39ae3e7-524d-4379-a517-c32b738cac66"},{"version":"CommandV1","origId":126104,"guid":"aabe3f0d-e95f-49e6-b76a-c1e390dbcc69","subtype":"command","commandType":"auto","position":1.8273530006408691,"command":"%md\nNow our final ratings RDD looks as follows:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"29c237c5-d8e7-4f7e-a0bf-c6615aeadd58"},{"version":"CommandV1","origId":123771,"guid":"4709c0d2-4a18-4b64-9bbe-00e714d39ce0","subtype":"command","commandType":"auto","position":1.8273534774780273,"command":"ratingsRDD.take(10).map(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Rating(1,1193,5.0)\nRating(1,661,3.0)\nRating(1,914,3.0)\nRating(1,3408,4.0)\nRating(1,2355,5.0)\nRating(1,1197,3.0)\nRating(1,1287,5.0)\nRating(1,2804,5.0)\nRating(1,594,4.0)\nRating(1,919,4.0)\nres61: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464837954385E12,"submitTime":1.464837751293E12,"finishTime":1.464837955111E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"afcbb974-dddd-4f4e-aa79-d778983b8dd6"},{"version":"CommandV1","origId":127469,"guid":"bdc10061-0b0a-4852-9c06-1c1c6fed3240","subtype":"command","commandType":"auto","position":1.8273539543151855,"command":"%md\nA similar command is used to format the movies. We ignore the genres in this recommender","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ae51bd59-99c0-4ae6-938a-d1c2006a7752"},{"version":"CommandV1","origId":123772,"guid":"e315bfae-ff5b-40ed-b763-903268973528","subtype":"command","commandType":"auto","position":1.8273544311523438,"command":"val movies = sc.textFile(\"/databricks-datasets/cs100/lab4/data-001/movies.dat\").map { line =>\n      val fields = line.split(\"::\")\n      // format: (movieId, movieName)\n      (fields(0).toInt, fields(1))\n    }.collect.toMap","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">movies: scala.collection.immutable.Map[Int,String] = Map(2163 -&gt; Attack of the Killer Tomatoes! (1980), 645 -&gt; Nelly &amp; Monsieur Arnaud (1995), 892 -&gt; Twelfth Night (1996), 69 -&gt; Friday (1995), 2199 -&gt; Phoenix (1998), 3021 -&gt; Funhouse, The (1981), 1322 -&gt; Amityville 1992: It's About Time (1992), 1665 -&gt; Bean (1997), 1036 -&gt; Die Hard (1988), 2822 -&gt; Medicine Man (1992), 2630 -&gt; Besieged (L' Assedio) (1998), 3873 -&gt; Cat Ballou (1965), 1586 -&gt; G.I. Jane (1997), 1501 -&gt; Keys to Tulsa (1997), 2452 -&gt; Gate II: Trespassers, The (1990), 809 -&gt; Fled (1996), 1879 -&gt; Hanging Garden, The (1997), 1337 -&gt; Body Snatcher, The (1945), 1718 -&gt; Stranger in the House (1997), 2094 -&gt; Rocketeer, The (1991), 3944 -&gt; Bootmen (2000), 1411 -&gt; Hamlet (1996), 629 -&gt; Rude (1995), 3883 -&gt; Catfish in Black Bean Sauce (2000), 2612 -&gt; Mildred Pierce (1945), 1024 -&gt; Three Caballeros, The (1945), 365 -&gt; Little Buddha (1993), 2744 -&gt; Otello (1986), 1369 -&gt; I Can't Sleep (J'ai pas sommeil) (1994), 138 -&gt; Neon Bible, The (1995), 2889 -&gt; Mystery, Alaska (1999), 1190 -&gt; Tie Me Up! Tie Me Down! (1990), 1168 -&gt; Bad Moon (1996), 2295 -&gt; Impostors, The (1998), 2306 -&gt; Holy Man (1998), 3053 -&gt; Messenger: The Story of Joan of Arc, The (1999), 3345 -&gt; Charlie, the Lonesome Cougar (1967), 760 -&gt; Stalingrad (1993), 2341 -&gt; Dancing at Lughnasa (1998), 101 -&gt; Bottle Rocket (1996), 2336 -&gt; Elizabeth (1998), 3008 -&gt; Last Night (1998), 2109 -&gt; Jerk, The (1979), 2131 -&gt; Autumn Sonata (H?stsonaten ) (1978), 1454 -&gt; SubUrbia (1997), 2031 -&gt; $1,000,000 Duck (1971), 1633 -&gt; Ulee's Gold (1997), 2778 -&gt; Never Talk to Strangers (1995), 2072 -&gt; 'burbs, The (1989), 3661 -&gt; Puppet Master II (1990), 1767 -&gt; Music From Another Room (1998), 3399 -&gt; Sesame Street Presents Follow That Bird (1985), 1995 -&gt; Poltergeist II: The Other Side (1986), 2263 -&gt; Seventh Sign, The (1988), 3930 -&gt; Creature From the Black Lagoon, The (1954), 479 -&gt; Judgment Night (1993), 3798 -&gt; What Lies Beneath (2000), 1559 -&gt; Next Step, The (1995), 1105 -&gt; Children of the Corn IV: The Gathering (1996), 347 -&gt; Bitter Moon (1992), 3666 -&gt; Retro Puppetmaster (1999), 1729 -&gt; Jackie Brown (1997), 3434 -&gt; Death Wish V: The Face of Death (1994), 3167 -&gt; Carnal Knowledge (1971), 2412 -&gt; Rocky V (1990), 2876 -&gt; Thumbelina (1994), 1237 -&gt; Seventh Seal, The (Sjunde inseglet, Det) (1957), 846 -&gt; Flirt (1995), 909 -&gt; Apartment, The (1960), 2921 -&gt; High Plains Drifter (1972), 3477 -&gt; Empire Records (1995), 3698 -&gt; Running Man, The (1987), 333 -&gt; Tommy Boy (1995), 628 -&gt; Primal Fear (1996), 1031 -&gt; Bedknobs and Broomsticks (1971), 249 -&gt; Immortal Beloved (1994), 2463 -&gt; Ruthless People (1986), 3397 -&gt; Great Muppet Caper, The (1981), 1899 -&gt; Passion in the Desert (1998), 893 -&gt; Mother Night (1996), 1840 -&gt; He Got Game (1998), 3581 -&gt; Human Traffic (1999), 1315 -&gt; Paris Was a Woman (1995), 3863 -&gt; Cell, The (2000), 3830 -&gt; Psycho Beach Party (2000), 2787 -&gt; Cat's Eye (1985), 2595 -&gt; Photographer (Fotoamator) (1998), 518 -&gt; Road to Wellville, The (1994), 1850 -&gt; I Love You, Don't Touch Me! (1998), 2499 -&gt; God Said 'Ha!' (1998), 2427 -&gt; Thin Red Line, The (1998), 2480 -&gt; Dry Cleaning (Nettoyage ? sec) (1997), 1083 -&gt; Great Race, The (1965), 962 -&gt; They Made Me a Criminal (1939), 1982 -&gt; Halloween (1978), 468 -&gt; Englishman Who Went Up a Hill, But Came Down a Mountain, The (1995), 2559 -&gt; King and I, The (1999), 3449 -&gt; Good Mother, The (1988), 234 -&gt; Exit to Eden (1994), 2544 -&gt; School of Flesh, The (L' ?cole de la chair) (1998), 941 -&gt; Mark of Zorro, The (1940), 3927 -&gt; Fantastic Voyage (1966), 1179 -&gt; Grifters, The (1990), 2331 -&gt; Living Out Loud (1998), 777 -&gt; Pharaoh's Army (1995), 3566 -&gt; Big Kahuna, The (2000), 555 -&gt; True Romance (1993), 666 -&gt; All Things Fair (1996), 1295 -&gt; Unbearable Lightness of Being, The (1988), 1956 -&gt; Ordinary People (1980), 1950 -&gt; In the Heat of the Night (1967), 88 -&gt; Black Sheep (1996), 1549 -&gt; Rough Magic (1995), 2280 -&gt; Clay Pigeons (1998), 1554 -&gt; Pillow Book, The (1995), 1110 -&gt; Bird of Prey (1996), 3172 -&gt; Ulysses (Ulisse) (1954), 1686 -&gt; Red Corner (1997), 481 -&gt; Kalifornia (1993), 352 -&gt; Crooklyn (1994), 2250 -&gt; Men Don't Leave (1990), 2363 -&gt; Godzilla (Gojira) (1954), 1855 -&gt; Krippendorf's Tribe (1998), 3680 -&gt; Decline of Western Civilization Part II: The Metal Years, The (1988), 1200 -&gt; Aliens (1986), 2077 -&gt; Journey of Natty Gann, The (1985), 3534 -&gt; 28 Days (2000), 1750 -&gt; Star Kid (1997), 3185 -&gt; Snow Falling on Cedars (1999), 408 -&gt; 8 Seconds (1994), 977 -&gt; Moonlight Murder (1936), 170 -&gt; Hackers (1995), 3681 -&gt; For a Few Dollars More (1965), 1211 -&gt; Wings of Desire (Der Himmel ?ber Berlin) (1987), 523 -&gt; Ruby in Paradise (1993), 1158 -&gt; Here Comes Cookie (1935), 2309 -&gt; Inheritors, The (Die Siebtelbauern) (1998), 2512 -&gt; Ballad of Narayama, The (Narayama Bushiko) (1982), 582 -&gt; Metisse (Caf? au Lait) (1993), 2976 -&gt; Bringing Out the Dead (1999), 762 -&gt; Striptease (1996), 3072 -&gt; Moonstruck (1987), 1924 -&gt; Plan 9 from Outer Space (1958), 1005 -&gt; D3: The Mighty Ducks (1996), 2210 -&gt; Sabotage (1936), 2117 -&gt; Nineteen Eighty-Four (1984), 2940 -&gt; Gilda (1946), 1596 -&gt; Career Girls (1997), 1406 -&gt; C?r?monie, La (1995), 115 -&gt; Happiness Is in the Field (1995), 2104 -&gt; Tex (1982), 3317 -&gt; Wonder Boys (2000), 683 -&gt; Eye of Vichy, The (Oeil de Vichy, L') (1993), 730 -&gt; Low Life, The (1994), 1290 -&gt; Some Kind of Wonderful (1987), 1882 -&gt; Godzilla (1998), 217 -&gt; Babysitter, The (1995), 276 -&gt; Milk Money (1994), 2231 -&gt; Rounders (1998), 2622 -&gt; Midsummer Night's Dream, A (1999), 1068 -&gt; Crossfire (1947), 3858 -&gt; Cecil B. Demented (2000), 2808 -&gt; Universal Soldier (1992), 3905 -&gt; Specials, The (2000), 1522 -&gt; Ripe (1996), 3762 -&gt; Daughter of Dr. Jeckyll (1957), 2644 -&gt; Dracula (1931), 3813 -&gt; Interiors (1978), 2495 -&gt; Fantastic Planet, The (La Plan?te sauvage) (1973), 3230 -&gt; Odessa File, The (1974), 2381 -&gt; Police Academy 4: Citizens on Patrol (1987), 2395 -&gt; Rushmore (1998), 2908 -&gt; Boys Don't Cry (1999), 2062 -&gt; Governess, The (1998), 3549 -&gt; Guys and Dolls (1955), 1443 -&gt; Tickle in the Heart, A (1996), 2776 -&gt; Marcello Mastroianni: I Remember Yes, I Remember (1997), 2659 -&gt; It Came from Hollywood (1982), 3417 -&gt; Crimson Pirate, The (1952), 3509 -&gt; Black and White (1999), 3285 -&gt; Beach, The (2000), 3377 -&gt; Hangmen Also Die (1943), 994 -&gt; Big Night (1996), 2527 -&gt; Westworld (1973), 3040 -&gt; Meatballs (1979), 3153 -&gt; 7th Voyage of Sinbad, The (1958), 2953 -&gt; Home Alone 2: Lost in New York (1992), 2590 -&gt; Hideous Kinky (1998), 1401 -&gt; Ghosts of Mississippi (1996), 3460 -&gt; Hillbillys in a Haunted House (1967), 1422 -&gt; Murder at 1600 (1997), 308 -&gt; Three Colors: White (1994), 2947 -&gt; Goldfinger (1964), 1569 -&gt; My Best Friend's Wedding (1997), 1939 -&gt; Best Years of Our Lives, The (1946), 2248 -&gt; Say Anything... (1989), 3912 -&gt; Beautiful (2000), 3098 -&gt; Natural, The (1984), 741 -&gt; Ghost in the Shell (Kokaku kidotai) (1995), 1073 -&gt; Willy Wonka and the Chocolate Factory (1971), 2671 -&gt; Notting Hill (1999), 1544 -&gt; Lost World: Jurassic Park, The (1997), 2676 -&gt; Instinct (1999), 2014 -&gt; Freaky Friday (1977), 3910 -&gt; Dancer in the Dark (2000), 5 -&gt; Father of the Bride Part II (1995), 1728 -&gt; Winter Guest, The (1997), 3108 -&gt; Fisher King, The (1991), 873 -&gt; Shadow of Angels (Schatten der Engel) (1976), 3012 -&gt; Battling Butler (1926), 1205 -&gt; Transformers: The Movie, The (1986), 449 -&gt; Fear of a Black Hat (1993), 120 -&gt; Race the Sun (1996), 2099 -&gt; Song of the South (1946), 2282 -&gt; Pecker (1998), 247 -&gt; Heavenly Creatures (1994), 1591 -&gt; Spawn (1997), 2114 -&gt; Outsiders, The (1983), 2837 -&gt; Bedrooms &amp; Hallways (1998), 1142 -&gt; Get Over It (1996), 379 -&gt; Timecop (1994), 1269 -&gt; Arsenic and Old Lace (1944), 878 -&gt; Bye-Bye (1995), 440 -&gt; Dave (1993), 655 -&gt; Mutters Courage (1995), 3498 -&gt; Midnight Express (1978), 511 -&gt; Program, The (1993), 2380 -&gt; Police Academy 3: Back in Training (1986), 1971 -&gt; Nightmare on Elm Street 4: The Dream Master, A (1988), 1793 -&gt; Welcome to Woop-Woop (1997), 3402 -&gt; Turtle Diary (1985), 2854 -&gt; Don't Look in the Basement! (1973), 1533 -&gt; Promise, The (La Promesse) (1996), 614 -&gt; Loaded (1994), 1692 -&gt; Alien Escape (1995), 269 -&gt; My Crazy Life (Mi vida loca) (1993), 1305 -&gt; Paris, Texas (1984), 202 -&gt; Total Eclipse (1995), 597 -&gt; Pretty Woman (1990), 1437 -&gt; Cement Garden, The (1993), 1041 -&gt; Secrets &amp; Lies (1996), 861 -&gt; Supercop (1992), 3382 -&gt; Song of Freedom (1936), 1173 -&gt; Cook the Thief His Wife &amp; Her Lover, The (1989), 1486 -&gt; Quiet Room, The (1996), 3848 -&gt; Silent Fall (1994), 1497 -&gt; Double Team (1997), 10 -&gt; GoldenEye (1995), 2195 -&gt; Dirty Work (1998), 1705 -&gt; Guy (1996), 3017 -&gt; Creepshow 2 (1987), 1078 -&gt; Bananas (1971), 1788 -&gt; Men With Guns (1997), 1426 -&gt; Zeus and Roxanne (1997), 3217 -&gt; Star Is Born, A (1937), 3530 -&gt; Smoking/No Smoking (1993), 1671 -&gt; Deceiver (1997), 3794 -&gt; Chuck &amp; Buck (2000), 1608 -&gt; Air Force One (1997), 3439 -&gt; Teenage Mutant Ninja Turtles II: The Secret of the Ooze (1991), 385 -&gt; Man of No Importance, A (1994), 384 -&gt; Bad Company (1995), 56 -&gt; Kids of the Round Table (1995), 1655 -&gt; Phantoms (1998), 3120 -&gt; Distinguished Gentleman, The (1992), 3429 -&gt; Creature Comforts (1990), 3049 -&gt; How I Won the War (1967), 3745 -&gt; Titan A.E. (2000), 1137 -&gt; Hustler White (1996), 2607 -&gt; Get Real (1998), 2686 -&gt; Red Violin, The (Le Violon rouge) (1998), 1756 -&gt; Prophecy II, The (1998), 1310 -&gt; Hype! (1996), 533 -&gt; Shadow, The (1994), 3004 -&gt; Bachelor, The (1999), 2035 -&gt; Blackbeard's Ghost (1968), 3332 -&gt; Legend of Lobo, The (1962), 3367 -&gt; Devil's Brigade, The (1968), 3648 -&gt; Abominable Snowman, The (1957), 3135 -&gt; Great Santini, The (1979), 3942 -&gt; Sorority House Massacre II (1990), 550 -&gt; Threesome (1994), 3649 -&gt; American Gigolo (1980), 3365 -&gt; Searchers, The (1956), 142 -&gt; Shadows (Cienie) (1988), 2740 -&gt; Kindred, The (1986), 2918 -&gt; Ferris Bueller's Day Off (1986), 3044 -&gt; Dead Again (1991), 1735 -&gt; Great Expectations (1998), 1867 -&gt; Tarzan and the Lost City (1998), 500 -&gt; Mrs. Doubtfire (1993), 2184 -&gt; Trouble with Harry, The (1955), 3175 -&gt; Galaxy Quest (1999), 1164 -&gt; Two or Three Things I Know About Her (1966), 1999 -&gt; Exorcist III, The (1990), 797 -&gt; Old Lady Who Walked in the Sea, The (Vieille qui marchait dans la mer, La) (1991), 2316 -&gt; Practical Magic (1998), 3446 -&gt; Funny Bones (1995), 715 -&gt; Horseman on the Roof, The (Hussard sur le toit, Le) (1995), 2448 -&gt; Virus (1999), 3338 -&gt; For All Mankind (1989), 2933 -&gt; Fire Within, The (Le Feu Follet) (1963), 1275 -&gt; Highlander (1986), 2141 -&gt; American Tail, An (1986), 2434 -&gt; Down in the Delta (1998), 1872 -&gt; Go Now (1995), 2712 -&gt; Eyes Wide Shut (1999), 472 -&gt; I'll Do Anything (1994), 3616 -&gt; Loser (2000), 1233 -&gt; Boat, The (Das Boot) (1981), 3781 -&gt; Shaft in Africa (1973), 814 -&gt; Boy Called Hate, A (1995), 1327 -&gt; Amityville Horror, The (1979), 3693 -&gt; Toxic Avenger, The (1985), 2476 -&gt; Heartbreak Ridge (1986), 2627 -&gt; Endurance (1998), 2168 -&gt; Dance with Me (1998), 1260 -&gt; M (1931), 698 -&gt; Delta of Venus (1994), 1919 -&gt; Madeline (1998), 3253 -&gt; Wayne's World (1992), 1988 -&gt; Hello Mary Lou: Prom Night II (1987), 3826 -&gt; Hollow Man (2000), 2459 -&gt; Texas Chainsaw Massacre, The (1974), 3414 -&gt; Love Is a Many-Splendored Thing (1955), 1342 -&gt; Candyman (1992), 3121 -&gt; Hitch-Hiker, The (1953), 747 -&gt; Stupids, The (1996), 913 -&gt; Maltese Falcon, The (1941), 3481 -&gt; High Fidelity (2000), 3562 -&gt; Committed (2000), 1640 -&gt; How to Be a Player (1997), 2580 -&gt; Go (1999), 2901 -&gt; Phantasm (1979), 945 -&gt; Top Hat (1935), 3313 -&gt; Class Reunion (1982), 1063 -&gt; Johns (1996), 1954 -&gt; Rocky (1976), 2844 -&gt; Minus Man, The (1999), 340 -&gt; War, The (1994), 3577 -&gt; Two Moon Juction (1988), 2042 -&gt; D2: The Mighty Ducks (1994), 538 -&gt; Six Degrees of Separation (1993), 1354 -&gt; Breaking the Waves (1996), 153 -&gt; Batman Forever (1995), 2146 -&gt; St. Elmo's Fire (1985), 1507 -&gt; Paradise Road (1997), 1222 -&gt; Full Metal Jacket (1987), 930 -&gt; Notorious (1946), 3895 -&gt; Watcher, The (2000), 3717 -&gt; Gone in 60 Seconds (2000), 2360 -&gt; Celebration, The (Festen) (1998), 1458 -&gt; Touch (1997), 670 -&gt; World of Apu, The (Apur Sansar) (1959), 3276 -&gt; Gun Shy (2000), 2575 -&gt; Dreamlife of Angels, The (La Vie r?v?e des anges) (1998), 829 -&gt; Joe's Apartment (1996), 3370 -&gt; Betrayed (1988), 174 -&gt; Jury Duty (1995), 1095 -&gt; Glengarry Glen Ross (1992), 404 -&gt; Brother Minister: The Assassination of Malcolm X (1994), 3335 -&gt; Jail Bait (1954), 1196 -&gt; Star Wars: Episode V - The Empire Strikes Back (1980), 1746 -&gt; Senseless (1998), 3103 -&gt; Stanley &amp; Iris (1990), 898 -&gt; Philadelphia Story, The (1940), 185 -&gt; Net, The (1995), 1835 -&gt; City of Angels (1998), 3836 -&gt; Kelly's Heroes (1970), 2216 -&gt; Skin Game, The (1931), 3236 -&gt; Zachariah (1971), 3629 -&gt; Gold Rush, The (1925), 2348 -&gt; Sid and Nancy (1986), 3350 -&gt; Raisin in the Sun, A (1961), 1001 -&gt; Associate, The (L'Associe)(1982), 3545 -&gt; Cabaret (1972), 2723 -&gt; Mystery Men (1999), 2972 -&gt; Red Sorghum (Hong Gao Liang) (1987), 3634 -&gt; Seven Days in May (1964), 2046 -&gt; Flight of the Navigator (1986), 3766 -&gt; Missing in Action (1984), 2432 -&gt; Stepmom (1998), 1914 -&gt; Smoke Signals (1998), 2491 -&gt; Simply Irresistible (1999), 1243 -&gt; Rosencrantz and Guildenstern Are Dead (1990), 1127 -&gt; Abyss, The (1989), 2763 -&gt; Thomas Crown Affair, The (1999), 3915 -&gt; Girlfight (2000), 2548 -&gt; Rage: Carrie 2, The (1999), 1782 -&gt; Little City (1998), 3502 -&gt; My Life (1993), 42 -&gt; Dead Presidents (1995), 2985 -&gt; Robocop (1987), 2227 -&gt; Lodger, The (1926), 1391 -&gt; Mars Attacks! (1996), 3249 -&gt; Hand That Rocks the Cradle, The (1992), 782 -&gt; Fan, The (1996), 1441 -&gt; Benny &amp; Joon (1993), 709 -&gt; Oliver &amp; Company (1988), 2020 -&gt; Dangerous Liaisons (1988), 841 -&gt; Eyes Without a Face (1959), 3513 -&gt; Rules of Engagement (2000), 417 -&gt; Barcelona (1994), 24 -&gt; Powder (1995), 973 -&gt; Meet John Doe (1941), 885 -&gt; Bogus (1996), 3088 -&gt; Harvey (1950), 3777 -&gt; Nekromantik (1987), 1046 -&gt; Beautiful Thing (1996), 288 -&gt; Natural Born Killers (1994), 1613 -&gt; Star Maps (1997), 3308 -&gt; Flamingo Kid, The (1984), 2010 -&gt; Metropolis (1926), 1935 -&gt; How Green Was My Valley (1941), 3947 -&gt; Get Carter (1971), 1650 -&gt; Washington Square (1997), 3730 -&gt; Conversation, The (1974), 1645 -&gt; Devil's Advocate, The (1997), 1921 -&gt; Pi (1998), 2886 -&gt; Adventures of Elmo in Grouchland, The (1999), 1359 -&gt; Jingle All the Way (1996), 1601 -&gt; Hoodlum (1997), 1386 -&gt; Terror in a Texas Town (1958), 3281 -&gt; Brandon Teena Story, The (1998), 3466 -&gt; Heart and Souls (1993), 301 -&gt; Picture Bride (1995), 3898 -&gt; Bait (2000), 2082 -&gt; Mighty Ducks, The (1992), 3140 -&gt; Three Ages, The (1923), 1724 -&gt; Full Speed (1996), 1475 -&gt; Kama Sutra: A Tale of Love (1996), 320 -&gt; Suture (1993), 3809 -&gt; What About Bob? (1991), 2173 -&gt; Navigator: A Mediaeval Odyssey, The (1988), 565 -&gt; Cronos (1992), 1366 -&gt; Crucible, The (1996), 2516 -&gt; Children of the Corn III (1994), 2400 -&gt; Prancer (1989), 2067 -&gt; Doctor Zhivago (1965), 2825 -&gt; Rosie (1998), 1529 -&gt; Nowhere (1997), 1967 -&gt; Labyrinth (1986), 2819 -&gt; Three Days of the Condor (1975), 436 -&gt; Color of Night (1994), 3880 -&gt; Ballad of Ramblin' Jack, The (2000), 3878 -&gt; X: The Unknown (1956), 2136 -&gt; Nutty Professor, The (1963), 37 -&gt; Across the Sea of Time (1995), 1904 -&gt; Henry Fool (1997), 1518 -&gt; Breakdown (1997), 1265 -&gt; Groundhog Day (1993), 1703 -&gt; For Richer or Poorer (1997), 2531 -&gt; Battle for the Planet of the Apes (1973), 2405 -&gt; Jewel of the Nile, The (1985), 1228 -&gt; Raging Bull (1980), 1623 -&gt; Wishmaster (1997), 1482 -&gt; Van, The (1996), 3597 -&gt; Whipped (2000), 25 -&gt; Leaving Las Vegas (1995), 1254 -&gt; Treasure of the Sierra Madre, The (1948), 3688 -&gt; Porky's (1981), 2869 -&gt; Separation, The (La S?paration) (1994), 1887 -&gt; Almost Heroes (1998), 651 -&gt; Superweib, Das (1996), 2957 -&gt; Sparrows (1926), 257 -&gt; Just Cause (1995), 3820 -&gt; Thomas and the Magic Railroad (2000), 3891 -&gt; Turn It Up (2000), 2654 -&gt; Wolf Man, The (1941), 389 -&gt; Colonel Chabert, Le (1994), 1628 -&gt; Locusts, The (1997), 3248 -&gt; Sister Act 2: Back in the Habit (1993), 52 -&gt; Mighty Aphrodite (1995), 1055 -&gt; Shadow Conspiracy (1997), 1409 -&gt; Michael (1996), 724 -&gt; Craft, The (1996), 3204 -&gt; Boys from Brazil, The (1978), 3442 -&gt; Band of the Hand (1986), 3263 -&gt; White Men Can't Jump (1992), 1287 -&gt; Ben-Hur (1959), 3221 -&gt; Draughtsman's Contract, The (1982), 14 -&gt; Nixon (1995), 1709 -&gt; Legal Deceit (1997), 2603 -&gt; N? (1998), 2328 -&gt; Vampires (1998), 2916 -&gt; Total Recall (1990), 3938 -&gt; Slumber Party Massacre, The (1982), 3195 -&gt; Tess of the Storm Country (1922), 3029 -&gt; Nighthawks (1981), 570 -&gt; Slingshot, The (K?disbellan ) (1993), 3425 -&gt; Mo' Better Blues (1990), 1792 -&gt; U.S. Marshalls (1998), 1430 -&gt; Underworld (1997), 3644 -&gt; Dark Command (1940), 2735 -&gt; Golden Child, The (1986), 2814 -&gt; Bat, The (1959), 1985 -&gt; Halloween 4: The Return of Michael Myers (1988), 2039 -&gt; Cheetah (1989), 3275 -&gt; Boondock Saints, The (1999), 184 -&gt; Nadja (1994), 2698 -&gt; Zone 39 (1997), 1760 -&gt; Spice World (1997), 3131 -&gt; Broadway Damage (1997), 1660 -&gt; Eve's Bayou (1997), 1298 -&gt; Pink Floyd - The Wall (1982), 3116 -&gt; Miss Julie (1999), 2667 -&gt; Mole People, The (1956), 719 -&gt; Multiplicity (1996), 2339 -&gt; I'll Be Home For Christmas (1998), 785 -&gt; Kingpin (1996), 3046 -&gt; Incredibly True Adventure of Two Girls in Love, The (1995), 3689 -&gt; Porky's II: The Next Day (1983), 3342 -&gt; Birdy (1984), 2269 -&gt; Indecent Proposal (1993), 2755 -&gt; Light of Day (1987), 372 -&gt; Reality Bites (1994), 3495 -&gt; Roadside Prophets (1992), 504 -&gt; No Escape (1994), 1871 -&gt; Friend of the Deceased, A (1997), 3574 -&gt; Carnosaur 3: Primal Species (1996), 3061 -&gt; Holiday Inn (1942), 110 -&gt; Braveheart (1995), 2708 -&gt; Autumn Tale, An (Conte d'automne) (1998), 3821 -&gt; Nutty Professor II: The Klumps (2000), 1907 -&gt; Mulan (1998), 2501 -&gt; October Sky (1999), 3617 -&gt; Road Trip (2000), 1330 -&gt; April Fool's Day (1986), 2444 -&gt; 24 7: Twenty Four Seven (1997), 1860 -&gt; Character (Karakter) (1997), 1264 -&gt; Diva (1981), 2217 -&gt; Elstree Calling (1930), 587 -&gt; Ghost (1990), 1323 -&gt; Amityville 3-D (1983), 3612 -&gt; Slipper and the Rose, The (1976), 3148 -&gt; Cider House Rules, The (1999), 3653 -&gt; Endless Summer, The (1966), 619 -&gt; Ed (1996), 838 -&gt; Emma (1996), 1511 -&gt; A Chef in Love (1996), 2274 -&gt; Lilian's Story (1995), 917 -&gt; Little Princess, The (1939), 702 -&gt; Faces (1968), 751 -&gt; Careful (1992), 3485 -&gt; Autopsy (Macchie Solari) (1975), 802 -&gt; Phenomenon (1996), 125 -&gt; Flirting With Disaster (1996), 344 -&gt; Ace Ventura: Pet Detective (1994), 3776 -&gt; Melody Time (1948), 2682 -&gt; Limbo (1999), 3125 -&gt; End of the Affair, The (1999), 1826 -&gt; Barney's Great Adventure (1998), 3542 -&gt; Coming Apart (1969), 1313 -&gt; Mad Dog Time (1996), 1279 -&gt; Night on Earth (1991), 3410 -&gt; Soft Fruit (1999), 2185 -&gt; I Confess (1953), 1577 -&gt; Mondo (1996), 1455 -&gt; Hotel de Love (1996), 3280 -&gt; Baby, The (1973), 3749 -&gt; Time Regained (Le Temps Retrouv?) (1999), 3845 -&gt; And God Created Woman (Et Dieu&amp;#8230;Cr?a la Femme) (1956), 2562 -&gt; Bandits (1997), 3089 -&gt; Bicycle Thief, The (Ladri di biciclette) (1948), 2488 -&gt; Peeping Tom (1960), 1832 -&gt; Heaven's Burning (1997), 2897 -&gt; And the Ship Sails On (E la nave va) (1984), 934 -&gt; Father of the Bride (1950), 357 -&gt; Four Weddings and a Funeral (1994), 1191 -&gt; Madonna: Truth or Dare (1991), 3744 -&gt; Shaft (2000), 1992 -&gt; Child's Play 2 (1990), 3353 -&gt; Closer You Get, The (2000), 3803 -&gt; Greaser's Palace (1972), 2466 -&gt; Belizaire the Cajun (1986), 2126 -&gt; Snake Eyes (1998), 196 -&gt; Species (1995), 1462 -&gt; Unforgotten: Twenty-Five Years After Willowbrook (1996), 1059 -&gt; William Shakespeare's Romeo and Juliet (1996), 1132 -&gt; Manon of the Spring (Manon des sources) (1986), 3043 -&gt; Meatballs 4 (1992), 3855 -&gt; Affair of Love, An (Une Liaison Pornographique) (1999), 949 -&gt; East of Eden (1955), 2745 -&gt; Mission, The (1986), 2571 -&gt; Matrix, The (1999), 3713 -&gt; Long Walk Home, The (1990), 2356 -&gt; Celebrity (1998), 542 -&gt; Son in Law (1993), 460 -&gt; Getting Even with Dad (1994), 157 -&gt; Canadian Bacon (1994), 2703 -&gt; Broken Vessels (1998), 1545 -&gt; Ponette (1996), 2420 -&gt; Karate Kid, The (1984), 1922 -&gt; Whatever (1998), 2691 -&gt; Legend of 1900, The (Leggenda del pianista sull'oceano) (1998), 902 -&gt; Breakfast at Tiffany's (1961), 559 -&gt; Paris, France (1993), 3099 -&gt; Shampoo (1975), 2713 -&gt; Lake Placid (1999), 3517 -&gt; Bells, The (1926), 638 -&gt; Jack and Sarah (1995), 853 -&gt; Dingo (1992), 3840 -&gt; Pumpkinhead (1988), 1892 -&gt; Perfect Murder, A (1998), 3463 -&gt; Last Resort (1994), 1379 -&gt; Young Guns II (1990), 3374 -&gt; Daughters of the Dust (1992), 3385 -&gt; Volunteers (1985), 2857 -&gt; Yellow Submarine (1968), 2169 -&gt; Dead Man on Campus (1998), 2403 -&gt; First Blood (1982), 3638 -&gt; Moonraker (1979), 1087 -&gt; Madame Butterfly (1995), 1514 -&gt; Temptress Moon (Feng Yue) (1996), 189 -&gt; Reckless (1995), 20 -&gt; Money Train (1995), 1147 -&gt; When We Were Kings (1996), 1247 -&gt; Graduate, The (1967), 2049 -&gt; Happiest Millionaire, The (1967), 2552 -&gt; My Boyfriend's Back (1993), 1319 -&gt; Kids of Survival (1993), 1704 -&gt; Good Will Hunting (1997), 421 -&gt; Black Beauty (1994), 870 -&gt; Gone Fishin' (1997), 1890 -&gt; Little Boy Blue (1997), 2767 -&gt; Illuminata (1998), 1479 -&gt; Saint, The (1997), 46 -&gt; How to Make an American Quilt (1995), 1609 -&gt; 187 (1997), 969 -&gt; African Queen, The (1951), 93 -&gt; Vampire in Brooklyn (1995), 2373 -&gt; Red Sonja (1985), 606 -&gt; Candyman: Farewell to the Flesh (1995), 1347 -&gt; Nightmare on Elm Street, A (1984), 1572 -&gt; Contempt (Le M?pris) (1963), 3919 -&gt; Hellraiser III: Hell on Earth (1992), 1013 -&gt; Parent Trap, The (1961), 3216 -&gt; Vampyros Lesbos (Las Vampiras) (1970), 284 -&gt; New York Cop (1996), 770 -&gt; Costa Brava (1946), 1741 -&gt; Midaq Alley (Callej?n de los milagros, El) (1995), 1398 -&gt; In Love and War (1996), 881 -&gt; First Kid (1996), 3084 -&gt; Home Page (1999), 416 -&gt; Bad Girls (1994), 1115 -&gt; Sleepover (1995), 2635 -&gt; Mummy's Curse, The (1944), 2929 -&gt; Reds (1981), 325 -&gt; National Lampoon's Senior Trip (1995), 3470 -&gt; Dersu Uzala (1974), 3312 -&gt; McCullochs, The (1975), 3902 -&gt; Goya in Bordeaux (Goya en Bodeos) (1999), 3657 -&gt; Pandora and the Flying Dutchman (1951), 1931 -&gt; Mutiny on the Bounty (1935), 152 -&gt; Addiction, The (1995), 1568 -&gt; MURDER and murder (1996), 3734 -&gt; Prince of the City (1981), 3014 -&gt; Bustin' Loose (1981), 2520 -&gt; Airport (1970), 2730 -&gt; Barry Lyndon (1975), 228 -&gt; Destiny Turns on the Radio (1995), 3951 -&gt; Two Family House (2000), 2158 -&gt; Henry: Portrait of a Serial Killer, Part 2 (1996), 2024 -&gt; Rapture, The (1991), 1641 -&gt; Full Monty, The (1997), 3835 -&gt; Crush, The (1993), 3708 -&gt; Firestarter (1984), 289 -&gt; Only You (1994), 1773 -&gt; Tokyo Fist (1995), 448 -&gt; Fearless (1993), 2301 -&gt; History of the World: Part I (1981), 1815 -&gt; Eden (1997), 1494 -&gt; Sixth Man, The (1997), 57 -&gt; Home for the Holidays (1995), 2989 -&gt; For Your Eyes Only (1981), 316 -&gt; Stargate (1994), 1362 -&gt; Garden of Finzi-Contini, The (Giardino dei Finzi-Contini, Il) (1970), 1963 -&gt; Take the Money and Run (1969), 3180 -&gt; Play it to the Bone (1999), 3602 -&gt; G. I. Blues (1960), 3557 -&gt; Jennifer 8 (1992), 78 -&gt; Crossing Guard, The (1995), 1875 -&gt; Clockwatchers (1997), 2852 -&gt; Soldier's Story, A (1984), 3231 -&gt; Saphead, The (1920), 2388 -&gt; Steam: The Turkish Bath (Hamam) (1997), 3866 -&gt; Sunset Strip (2000), 2533 -&gt; Escape from the Planet of the Apes (1971), 1100 -&gt; Days of Thunder (1990), 261 -&gt; Little Women (1994), 1232 -&gt; Stalker (1979), 3268 -&gt; Stop! Or My Mom Will Shoot (1992), 3258 -&gt; Death Becomes Her (1992), 1847 -&gt; Ratchet (1996), 29 -&gt; City of Lost Children, The (1995), 2829 -&gt; Muse, The (1999), 3788 -&gt; Blowup (1966), 2456 -&gt; Fly II, The (1989), 2007 -&gt; Polish Wedding (1998), 2178 -&gt; Frenzy (1972), 2222 -&gt; Champagne (1928), 216 -&gt; Billy Madison (1995), 1489 -&gt; Cats Don't Dance (1997), 2950 -&gt; Blue Lagoon, The (1980), 2237 -&gt; Without Limits (1998), 1415 -&gt; Thieves (Voleurs, Les) (1996), 475 -&gt; In the Name of the Father (1993), 924 -&gt; 2001: A Space Odyssey (1968), 3322 -&gt; 3 Strikes (2000), 2616 -&gt; Dick Tracy (1990), 1946 -&gt; Marty (1955), 492 -&gt; Manhattan Murder Mystery (1993), 164 -&gt; Devil in a Blue Dress (1995), 1465 -&gt; Rosewood (1997), 3524 -&gt; Arthur (1981), 3431 -&gt; Death Wish II (1982), 1302 -&gt; Field of Dreams (1989), 756 -&gt; Carmen Miranda: Bananas Is My Business (1994), 1664 -&gt; N?nette et Boni (1996), 2794 -&gt; European Vacation (1985), 3887 -&gt; Went to Coney Island on a Mission From God... Be Back by Five (1998), 2324 -&gt; Life Is Beautiful (La Vita ? bella) (1997), 1714 -&gt; Never Met Picasso (1996), 2027 -&gt; Mafia! (1998), 3199 -&gt; Pal Joey (1957), 789 -&gt; I, Worst of All (Yo, la peor de todas) (1990), 3934 -&gt; Kronos (1957), 2105 -&gt; Tron (1982), 3075 -&gt; Repulsion (1965), 1811 -&gt; Niagara, Niagara (1997), 179 -&gt; Mad Love (1995), 1450 -&gt; Prisoner of the Mountains (Kavkazsky Plennik) (1996), 2090 -&gt; Rescuers, The (1977), 591 -&gt; Tough and Deadly (1995), 3393 -&gt; Date with an Angel (1987), 1373 -&gt; Star Trek V: The Final Frontier (1989), 2996 -&gt; Music of the Heart (1999), 443 -&gt; Endless Summer 2, The (1994), 3724 -&gt; Coming Home (1978), 1911 -&gt; Doctor Dolittle (1998), 3295 -&gt; Raining Stones (1993), 2782 -&gt; Pit and the Pendulum (1961), 1040 -&gt; Secret Agent, The (1996), 1109 -&gt; Charm's Incidents (1996), 2893 -&gt; Plunkett &amp; MaCleane (1999), 1632 -&gt; Smile Like Yours, A (1997), 321 -&gt; Strawberry and Chocolate (Fresa y chocolate) (1993), 2469 -&gt; Peggy Sue Got Married (1986), 3670 -&gt; Story of G.I. Joe, The (1945), 376 -&gt; River Wild, The (1994), 2259 -&gt; Blame It on Rio (1984), 3163 -&gt; Topsy-Turvy (1999), 2650 -&gt; Ghost of Frankenstein, The (1942), 3453 -&gt; Here on Earth (2000), 2451 -&gt; Gate, The (1987), 2236 -&gt; Simon Birch (1998), 623 -&gt; Modern Affair, A (1995), 1334 -&gt; Blob, The (1958), 211 -&gt; Browning Version, The (1994), 3527 -&gt; Predator (1987), 3473 -&gt; Jonah Who Will Be 25 in the Year 2000 (1976), 3702 -&gt; Mad Max (1979), 253 -&gt; Interview with the Vampire (1994), 2880 -&gt; Operation Condor 2 (Longxiong hudi) (1990), 1682 -&gt; Truman Show, The (1998), 485 -&gt; Last Action Hero (1993), 1136 -&gt; Monty Python and the Holy Grail (1974), 834 -&gt; Phat Beach (1996), 1858 -&gt; Mr. Nice Guy (1997), 3438 -&gt; Teenage Mutant Ninja Turtles (1990), 3525 -&gt; Bachelor Party (1984), 1864 -&gt; Sour Grapes (1998), 2122 -&gt; Children of the Corn (1984), 106 -&gt; Nobody Loves Me (Keiner liebt mich) (1994), 238 -&gt; Far From Home: The Adventures of Yellow Dog (1995), 3621 -&gt; Possession (1981), 2925 -&gt; Conformist, The (Il Conformista) (1970), 1978 -&gt; Friday the 13th Part V: A New Beginning (1985), 121 -&gt; Boys of St. Vincent, The (1993), 514 -&gt; Ref, The (1994), 1151 -&gt; Faust (1994), 937 -&gt; Love in the Afternoon (1957), 2291 -&gt; Edward Scissorhands (1990), 1383 -&gt; Adrenalin: Fear the Rush (1996), 1020 -&gt; Cool Runnings (1993), 348 -&gt; Bullets Over Broadway (1994), 3357 -&gt; East-West (Est-ouest) (1999), 574 -&gt; Spanking the Monkey (1994), 2254 -&gt; Choices (1981), 3569 -&gt; Idiots, The (Idioterne) (1998), 1677 -&gt; Critical Care (1997), 2540 -&gt; Corruptor, The (1999), 2034 -&gt; Black Hole, The (1979), 3923 -&gt; Return of the Fly (1959), 1960 -&gt; Last Emperor, The (1987), 2555 -&gt; Baby Geniuses (1999), 3290 -&gt; Soft Toilet Seats (1999), 806 -&gt; American Buffalo (1996), 84 -&gt; Last Summer in the Hamptons (1995), 3300 -&gt; Pitch Black (2000), 3093 -&gt; McCabe &amp; Mrs. Miller (1971), 1581 -&gt; Out to Sea (1997), 353 -&gt; Crow, The (1994), 2335 -&gt; Waterboy, The (1998), 966 -&gt; Walk in the Sun, A (1945), 2777 -&gt; Cobra (1925), 3152 -&gt; Last Picture Show, The (1971), 1183 -&gt; English Patient, The (1996), 1283 -&gt; High Noon (1952), 2073 -&gt; Fandango (1985), 1051 -&gt; Trees Lounge (1996), 3771 -&gt; Golden Voyage of Sinbad, The (1974), 821 -&gt; Crude Oasis, The (1995), 3851 -&gt; I'm the One That I Want (2000), 2017 -&gt; Babes in Toyland (1961), 905 -&gt; It Happened One Night (1934), 480 -&gt; Jurassic Park (1993), 3389 -&gt; Let's Get Harry (1986), 602 -&gt; Great Day in Harlem, A (1994), 2508 -&gt; Breaks, The (1999), 981 -&gt; Dangerous Ground (1997), 766 -&gt; I Shot Andy Warhol (1996), 2964 -&gt; Julien Donkey-Boy (1999), 147 -&gt; Basketball Diaries, The (1995), 1843 -&gt; Slappy and the Stinkers (1998), 2058 -&gt; Negotiator, The (1998), 1169 -&gt; American Dream (1990), 397 -&gt; Fear, The (1995), 687 -&gt; Country Life (1994), 2367 -&gt; King Kong (1976), 2437 -&gt; Wilde (1997), 3537 -&gt; Where the Money Is (2000), 1928 -&gt; Cimarron (1931), 3068 -&gt; Verdict, The (1982), 1377 -&gt; Batman Returns (1992), 280 -&gt; Murder in the First (1995), 2618 -&gt; Castle, The (1997), 2833 -&gt; Lucie Aubrac (1997), 3189 -&gt; My Dog Skip (1999), 3739 -&gt; Trouble in Paradise (1932), 2281 -&gt; Monument Ave. (1998), 2861 -&gt; For Love of the Game (1999), 1215 -&gt; Army of Darkness (1993), 61 -&gt; Eye for an Eye (1996), 634 -&gt; Theodore Rex (1995), 1896 -&gt; Cousin Bette (1998), 877 -&gt; Girls Town (1996), 692 -&gt; Solo (1996), 2190 -&gt; Why Do Fools Fall In Love? (1998), 3421 -&gt; Animal House (1978), 734 -&gt; Getting Away With Murder (1996), 3712 -&gt; Soapdish (1991), 1447 -&gt; Gridlock'd (1997), 2483 -&gt; Day of the Beast, The (El D?a de la bestia) (1995), 293 -&gt; Professional, The (a.k.a. Leon: The Professional) (1994), 956 -&gt; Penny Serenade (1941), 3505 -&gt; No Way Out (1987), 3685 -&gt; Prizzi's Honor (1985), 866 -&gt; Bound (1996), 1886 -&gt; I Got the Hook Up (1998), 3808 -&gt; Two Women (La Ciociara) (1961), 2523 -&gt; Rollercoaster (1977), 1796 -&gt; In God's Hands (1998), 3036 -&gt; Quest for Fire (1981), 2530 -&gt; Beneath the Planet of the Apes (1970), 453 -&gt; For Love or Money (1993), 1119 -&gt; Drunks (1997), 132 -&gt; Jade (1995), 1622 -&gt; Kicked in the Head (1997), 2424 -&gt; You've Got Mail (1998), 774 -&gt; Wend Kuuni (God's Gift) (1982), 2371 -&gt; Fletch (1985), 2979 -&gt; Body Shots (1999), 1394 -&gt; Raising Arizona (1987), 2772 -&gt; Detroit Rock City (1999), 3157 -&gt; Stuart Little (1999), 396 -&gt; Fall Time (1995), 1526 -&gt; Fathers' Day (1997), 3676 -&gt; Eraserhead (1977), 2137 -&gt; Charlotte's Web (1973), 89 -&gt; Nick of Time (1995), 1351 -&gt; Blood &amp; Wine (1997), 133 -&gt; Nueba Yol (1995), 660 -&gt; August (1996), 3361 -&gt; Bull Durham (1988), 2002 -&gt; Lethal Weapon 3 (1992), 998 -&gt; Set It Off (1996), 3756 -&gt; Golden Bowl, The (2000), 3243 -&gt; Encino Man (1992), 2809 -&gt; Love Stinks (1999), 2242 -&gt; Grandview, U.S.A. (1984), 411 -&gt; You So Crazy (1994), 1345 -&gt; Carrie (1976), 988 -&gt; Grace of My Heart (1996), 2799 -&gt; Problem Child 2 (1991), 2286 -&gt; Fiendish Plot of Dr. Fu Manchu, The (1980), 2639 -&gt; Mommie Dearest (1981), 3327 -&gt; Beyond the Mat (2000), 1433 -&gt; Machine, The (1994), 116 -&gt; Anne Frank Remembered (1995), 2103 -&gt; Tall Tale (1994), 2750 -&gt; Radio Days (1987), 243 -&gt; Gordy (1995), 1405 -&gt; Beavis and Butt-head Do America (1996), 3226 -&gt; Hellhounds on My Trail (1999), 1943 -&gt; Greatest Show on Earth, The (1952), 428 -&gt; Bronx Tale, A (1993), 1201 -&gt; Good, The Bad and The Ugly, The (1966), 2804 -&gt; Christmas Story, A (1983), 2965 -&gt; Omega Code, The (1999), 1 -&gt; Toy Story (1995), 1600 -&gt; She's So Lovely (1997), 3870 -&gt; Our Town (1940), 3588 -&gt; King of Marvin Gardens, The (1972), 1104 -&gt; Streetcar Named Desire, A (1951), 1697 -&gt; Big Bang Theory, The (1994), 1242 -&gt; Glory (1989), 265 -&gt; Like Water for Chocolate (Como agua para chocolate) (1992), 3559 -&gt; Limelight (1952), 849 -&gt; Escape from L.A. (1996), 3606 -&gt; On the Town (1949), 3211 -&gt; Cry in the Dark, A (1988), 2392 -&gt; Jack Frost (1998), 2154 -&gt; How Stella Got Her Groove Back (1998), 3906 -&gt; Under Suspicion (2000), 507 -&gt; Perfect World, A (1993), 527 -&gt; Schindler's List (1993), 312 -&gt; Stuart Saves His Family (1995), 74 -&gt; Bed of Roses (1996), 3492 -&gt; Son of the Sheik, The (1926), 2718 -&gt; Drop Dead Gorgeous (1999), 3406 -&gt; Captain Horatio Hornblower (1951), 2205 -&gt; Mr. &amp; Mrs. Smith (1941), 1696 -&gt; Bent (1997), 3184 -&gt; Montana (1998), 206 -&gt; Unzipped (1995), 2586 -&gt; Goodbye, Lover (1999), 2982 -&gt; Guardian, The (1990), 2884 -&gt; Dog Park (1998), 1975 -&gt; Friday the 13th Part 2 (1981), 3510 -&gt; Frequency (2000), 1564 -&gt; Roseanna's Grave (For Roseanna) (1997), 2762 -&gt; Sixth Sense, The (1999), 3378 -&gt; Ogre, The (Der Unhold) (1996), 1863 -&gt; Major League: Back to the Minors (1998), 3435 -&gt; Double Indemnity (1944), 2954 -&gt; Penitentiary (1979), 307 -&gt; Three Colors: Blue (1993), 1651 -&gt; Telling Lies in America (1997), 1604 -&gt; Money Talks (1997), 3899 -&gt; Circus (2000), 2922 -&gt; Hang 'em High (1967), 3151 -&gt; Bat Whispers, The (1930), 2011 -&gt; Back to the Future Part II (1989), 3097 -&gt; Shop Around the Corner, The (1940), 3582 -&gt; Jails, Hospitals &amp; Hip-Hop (2000), 292 -&gt; Outbreak (1995), 3229 -&gt; Another Man's Poison (1952), 3011 -&gt; They Shoot Horses, Don't They? (1969), 1206 -&gt; Clockwork Orange, A (1971), 233 -&gt; Exotica (1994), 452 -&gt; Widows' Peak (1994), 6 -&gt; Heat (1995), 920 -&gt; Gone with the Wind (1939), 248 -&gt; Houseguest (1994), 3857 -&gt; Bless the Child (2000), 60 -&gt; Indian in the Cupboard, The (1995), 380 -&gt; True Lies (1994), 3450 -&gt; Grumpy Old Men (1993), 3503 -&gt; Solaris (Solyaris) (1972), 3459 -&gt; Gothic (1986), 117 -&gt; Young Poisoner's Handbook, The (1995), 512 -&gt; Robert A. Heinlein's The Puppet Masters (1994), 942 -&gt; Laura (1944), 439 -&gt; Dangerous Game (1993), 3591 -&gt; Mr. Mom (1983), 2910 -&gt; Ennui, L' (1998), 3301 -&gt; Whole Nine Yards, The (2000), 2204 -&gt; Saboteur (1942), 3303 -&gt; Black Tar Heroin: The Dark End of the Street (1999), 678 -&gt; Some Folks Call It a Sling Blade (1993), 2473 -&gt; Soul Man (1986), 270 -&gt; Love Affair (1994), 529 -&gt; Searching for Bobby Fischer (1993), 3567 -&gt; Bossa Nova (1999), 2574 -&gt; Out-of-Towners, The (1999), 1438 -&gt; Dante's Peak (1997), 3720 -&gt; Sunshine (1999), 661 -&gt; James and the Giant Peach (1996), 546 -&gt; Super Mario Bros. (1993), 793 -&gt; My Life and Times With Antonin Artaud (En compagnie d'Antonin Artaud) (1993), 3169 -&gt; Falcon and the Snowman, The (1984), 3265 -&gt; Hard-Boiled (Lashou shentan) (1992), 2646 -&gt; House of Dracula (1945), 925 -&gt; Golden Earrings (1947), 3852 -&gt; Tao of Steve, The (2000), 85 -&gt; Angels and Insects (1995), 1306 -&gt; Until the End of the World (Bis ans Ende der Welt) (1991), 201 -&gt; Three Wishes (1995), 3531 -&gt; All the Vermeers in New York (1990))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:37: error: not found: value movieLensHomeDir\n       val movies = sc.textFile(movieLensHomeDir + &quot;/movies.dat&quot;).map { line =&gt;\n                                ^\n</div>","error":null,"startTime":1.464835735224E12,"submitTime":1.464835526424E12,"finishTime":1.464835736013E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1219dd27-702b-4866-9790-237c887fd20e"},{"version":"CommandV1","origId":123773,"guid":"ccfd7d3c-f22f-407d-9f97-d947461b18bc","subtype":"command","commandType":"auto","position":1.8273582458496094,"command":"%md\nLet's make a data frame to visually explore the data next.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835526475E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"be909633-c519-4801-93fa-90b661addaea"},{"version":"CommandV1","origId":123774,"guid":"a233a2c4-0916-40f7-89bc-7df3508102bb","subtype":"command","commandType":"auto","position":1.8273591995239258,"command":"val timedRatingsDF = sc.textFile(\"/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz\").map { line =>\n      val fields = line.split(\"::\")\n      // format: (timestamp % 10, Rating(userId, movieId, rating))\n      (fields(3).toLong % 10, fields(0).toInt, fields(1).toInt, fields(2).toDouble)\n    }.toDF(\"timestamp\", \"userId\", \"movieId\", \"rating\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">timedRatingsDF: org.apache.spark.sql.DataFrame = [timestamp: bigint, userId: int, movieId: int, rating: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:4: error: identifier expected but integer literal found.\n             format: (timestamp % 10, Rating(userId, movieId, rating))\n                                  ^\n&lt;console&gt;:6: error: ')' expected but '}' found.\n           }.toDF(&quot;userId&quot;, &quot;movieId&quot;, &quot;rating&quot;)\n           ^\n</div>","error":null,"startTime":1.464843593488E12,"submitTime":1.464843390175E12,"finishTime":1.4648435938E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b83a78a9-def0-48c3-b836-6bf2698b48f4"},{"version":"CommandV1","origId":123775,"guid":"b19a3fbb-85a1-40fc-8574-a898ec1f5152","subtype":"command","commandType":"auto","position":1.827359676361084,"command":"display(timedRatingsDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0,1.0,1193.0,5.0],[9.0,1.0,661.0,3.0],[8.0,1.0,914.0,3.0],[5.0,1.0,3408.0,4.0],[1.0,1.0,2355.0,5.0],[8.0,1.0,1197.0,3.0],[9.0,1.0,1287.0,5.0],[9.0,1.0,2804.0,5.0],[8.0,1.0,594.0,4.0],[8.0,1.0,919.0,4.0],[8.0,1.0,595.0,5.0],[2.0,1.0,938.0,4.0],[1.0,1.0,2398.0,4.0],[4.0,1.0,2918.0,4.0],[3.0,1.0,1035.0,5.0],[8.0,1.0,2791.0,4.0],[8.0,1.0,2687.0,3.0],[7.0,1.0,2018.0,4.0],[3.0,1.0,3105.0,5.0],[9.0,1.0,2797.0,4.0],[5.0,1.0,2321.0,3.0],[0.0,1.0,720.0,3.0],[5.0,1.0,1270.0,5.0],[5.0,1.0,527.0,5.0],[3.0,1.0,2340.0,3.0],[1.0,1.0,48.0,5.0],[3.0,1.0,1097.0,4.0],[5.0,1.0,1721.0,4.0],[9.0,1.0,1545.0,4.0],[8.0,1.0,745.0,3.0],[1.0,1.0,2294.0,4.0],[9.0,1.0,3186.0,4.0],[0.0,1.0,1566.0,4.0],[8.0,1.0,588.0,4.0],[0.0,1.0,1907.0,4.0],[1.0,1.0,783.0,4.0],[2.0,1.0,1836.0,5.0],[5.0,1.0,1022.0,5.0],[1.0,1.0,2762.0,4.0],[7.0,1.0,150.0,5.0],[8.0,1.0,1.0,5.0],[0.0,1.0,1961.0,5.0],[3.0,1.0,1962.0,4.0],[0.0,1.0,2692.0,4.0],[0.0,1.0,260.0,4.0],[7.0,1.0,1028.0,5.0],[5.0,1.0,1029.0,5.0],[9.0,1.0,1207.0,4.0],[9.0,1.0,2028.0,5.0],[9.0,1.0,531.0,4.0],[4.0,1.0,3114.0,4.0],[8.0,1.0,608.0,4.0],[1.0,1.0,1246.0,4.0],[9.0,2.0,1357.0,5.0],[0.0,2.0,3068.0,4.0],[0.0,2.0,1537.0,4.0],[1.0,2.0,647.0,3.0],[7.0,2.0,2194.0,4.0],[3.0,2.0,648.0,4.0],[7.0,2.0,2268.0,5.0],[1.0,2.0,2628.0,3.0],[5.0,2.0,1103.0,3.0],[9.0,2.0,2916.0,3.0],[2.0,2.0,3468.0,5.0],[1.0,2.0,1210.0,4.0],[1.0,2.0,1792.0,3.0],[4.0,2.0,1687.0,3.0],[8.0,2.0,1213.0,2.0],[8.0,2.0,3578.0,5.0],[2.0,2.0,2881.0,3.0],[4.0,2.0,3030.0,4.0],[1.0,2.0,1217.0,3.0],[3.0,2.0,3105.0,4.0],[4.0,2.0,434.0,2.0],[3.0,2.0,2126.0,3.0],[2.0,2.0,3107.0,2.0],[2.0,2.0,3108.0,3.0],[5.0,2.0,3035.0,4.0],[0.0,2.0,1253.0,3.0],[9.0,2.0,1610.0,5.0],[3.0,2.0,292.0,3.0],[0.0,2.0,2236.0,5.0],[0.0,2.0,3071.0,4.0],[5.0,2.0,902.0,2.0],[2.0,2.0,368.0,4.0],[1.0,2.0,1259.0,5.0],[2.0,2.0,3147.0,5.0],[4.0,2.0,1544.0,4.0],[1.0,2.0,1293.0,5.0],[0.0,2.0,1188.0,4.0],[1.0,2.0,3255.0,4.0],[9.0,2.0,3256.0,2.0],[3.0,2.0,3257.0,3.0],[5.0,2.0,110.0,5.0],[9.0,2.0,2278.0,3.0],[6.0,2.0,2490.0,3.0],[3.0,2.0,1834.0,4.0],[4.0,2.0,3471.0,5.0],[3.0,2.0,589.0,4.0],[1.0,2.0,1690.0,3.0],[4.0,2.0,3654.0,3.0],[8.0,2.0,2852.0,3.0],[8.0,2.0,1945.0,5.0],[9.0,2.0,982.0,4.0],[2.0,2.0,1873.0,4.0],[4.0,2.0,2858.0,4.0],[1.0,2.0,1225.0,5.0],[3.0,2.0,2028.0,4.0],[2.0,2.0,515.0,5.0],[5.0,2.0,442.0,3.0],[6.0,2.0,2312.0,3.0],[6.0,2.0,265.0,4.0],[9.0,2.0,1408.0,3.0],[3.0,2.0,1084.0,3.0],[3.0,2.0,3699.0,2.0],[9.0,2.0,480.0,5.0],[7.0,2.0,1442.0,4.0],[5.0,2.0,2067.0,5.0],[2.0,2.0,1265.0,3.0],[9.0,2.0,1370.0,5.0],[3.0,2.0,1193.0,5.0],[2.0,2.0,1801.0,3.0],[1.0,2.0,1372.0,3.0],[1.0,2.0,2353.0,4.0],[8.0,2.0,3334.0,4.0],[3.0,2.0,2427.0,2.0],[3.0,2.0,590.0,5.0],[0.0,2.0,1196.0,5.0],[1.0,2.0,1552.0,3.0],[0.0,2.0,736.0,4.0],[4.0,2.0,1198.0,4.0],[7.0,2.0,593.0,5.0],[6.0,2.0,2359.0,3.0],[3.0,2.0,95.0,2.0],[6.0,2.0,2717.0,3.0],[3.0,2.0,2571.0,4.0],[4.0,2.0,1917.0,3.0],[1.0,2.0,2396.0,4.0],[4.0,2.0,3735.0,3.0],[5.0,2.0,1953.0,4.0],[5.0,2.0,1597.0,3.0],[2.0,2.0,3809.0,3.0],[1.0,2.0,1954.0,5.0],[0.0,2.0,1955.0,4.0],[1.0,2.0,235.0,3.0],[8.0,2.0,1124.0,5.0],[0.0,2.0,1957.0,5.0],[9.0,2.0,163.0,4.0],[9.0,2.0,21.0,1.0],[2.0,2.0,165.0,3.0],[6.0,2.0,2321.0,3.0],[0.0,2.0,1090.0,2.0],[9.0,2.0,380.0,5.0],[0.0,2.0,2501.0,5.0],[9.0,2.0,349.0,4.0],[3.0,2.0,457.0,4.0],[6.0,2.0,1096.0,4.0],[5.0,2.0,920.0,5.0],[2.0,2.0,459.0,3.0],[9.0,2.0,1527.0,4.0],[9.0,2.0,3418.0,4.0],[6.0,2.0,1385.0,3.0],[4.0,2.0,3451.0,4.0],[7.0,2.0,3095.0,4.0],[6.0,2.0,780.0,3.0],[8.0,2.0,498.0,3.0],[1.0,2.0,2728.0,3.0],[0.0,2.0,2002.0,5.0],[3.0,2.0,1962.0,5.0],[1.0,2.0,1784.0,5.0],[2.0,2.0,2943.0,4.0],[1.0,2.0,2006.0,3.0],[3.0,2.0,318.0,5.0],[8.0,2.0,1207.0,4.0],[1.0,2.0,1968.0,2.0],[0.0,2.0,3678.0,3.0],[3.0,2.0,1244.0,3.0],[6.0,2.0,356.0,5.0],[0.0,2.0,1245.0,2.0],[8.0,2.0,1246.0,5.0],[5.0,2.0,3893.0,1.0],[2.0,2.0,1247.0,5.0],[7.0,3.0,3421.0,4.0],[0.0,3.0,1641.0,2.0],[7.0,3.0,648.0,3.0],[7.0,3.0,1394.0,4.0],[8.0,3.0,3534.0,3.0],[6.0,3.0,104.0,4.0],[7.0,3.0,2735.0,4.0],[0.0,3.0,1210.0,4.0],[5.0,3.0,1431.0,3.0],[6.0,3.0,3868.0,3.0],[6.0,3.0,1079.0,5.0],[7.0,3.0,2997.0,3.0],[0.0,3.0,1615.0,5.0],[0.0,3.0,1291.0,4.0],[6.0,3.0,1259.0,5.0],[7.0,3.0,653.0,4.0],[0.0,3.0,2167.0,5.0],[3.0,3.0,1580.0,3.0],[1.0,3.0,3619.0,2.0],[2.0,3.0,260.0,5.0],[9.0,3.0,2858.0,4.0],[3.0,3.0,3114.0,3.0],[5.0,3.0,1049.0,4.0],[3.0,3.0,1261.0,1.0],[7.0,3.0,552.0,4.0],[0.0,3.0,480.0,4.0],[6.0,3.0,1265.0,2.0],[6.0,3.0,1266.0,5.0],[7.0,3.0,733.0,5.0],[9.0,3.0,1196.0,4.0],[9.0,3.0,590.0,4.0],[0.0,3.0,2355.0,5.0],[0.0,3.0,1197.0,5.0],[0.0,3.0,1198.0,5.0],[9.0,3.0,1378.0,5.0],[8.0,3.0,593.0,3.0],[9.0,3.0,1379.0,4.0],[9.0,3.0,3552.0,5.0],[6.0,3.0,1304.0,5.0],[1.0,3.0,1270.0,3.0],[7.0,3.0,2470.0,4.0],[0.0,3.0,3168.0,4.0],[7.0,3.0,2617.0,2.0],[5.0,3.0,1961.0,4.0],[9.0,3.0,3671.0,5.0],[7.0,3.0,2006.0,4.0],[9.0,3.0,2871.0,4.0],[7.0,3.0,2115.0,4.0],[8.0,3.0,1968.0,4.0],[9.0,3.0,1136.0,5.0],[4.0,3.0,2081.0,4.0],[8.0,4.0,3468.0,5.0],[4.0,4.0,1210.0,3.0],[2.0,4.0,2951.0,4.0],[0.0,4.0,1214.0,4.0],[2.0,4.0,1036.0,4.0],[9.0,4.0,260.0,5.0],[0.0,4.0,2028.0,5.0],[8.0,4.0,480.0,4.0],[9.0,4.0,1196.0,2.0],[9.0,4.0,1198.0,5.0],[2.0,4.0,1954.0,5.0],[4.0,4.0,1097.0,4.0],[0.0,4.0,3418.0,4.0],[0.0,4.0,3702.0,4.0],[0.0,4.0,2366.0,4.0],[9.0,4.0,1387.0,5.0],[8.0,4.0,3527.0,1.0],[0.0,4.0,1201.0,5.0],[0.0,4.0,2692.0,5.0],[0.0,4.0,2947.0,5.0],[0.0,4.0,1240.0,5.0],[0.0,5.0,2987.0,4.0],[7.0,5.0,2333.0,4.0],[9.0,5.0,1175.0,5.0],[7.0,5.0,39.0,3.0],[5.0,5.0,288.0,2.0],[1.0,5.0,2337.0,5.0],[3.0,5.0,1535.0,4.0],[5.0,5.0,1392.0,4.0],[3.0,5.0,2268.0,2.0],[5.0,5.0,1466.0,3.0],[3.0,5.0,860.0,2.0],[8.0,5.0,1683.0,3.0],[4.0,5.0,866.0,4.0],[0.0,5.0,1684.0,3.0],[5.0,5.0,2916.0,1.0],[1.0,5.0,2770.0,4.0],[2.0,5.0,215.0,3.0],[3.0,5.0,1759.0,4.0],[1.0,5.0,501.0,1.0],[3.0,5.0,3578.0,2.0],[9.0,5.0,506.0,4.0],[2.0,5.0,1250.0,5.0],[0.0,5.0,3793.0,2.0],[9.0,5.0,509.0,4.0],[2.0,5.0,41.0,4.0],[5.0,5.0,1610.0,4.0],[0.0,5.0,2058.0,1.0],[7.0,5.0,3799.0,3.0],[6.0,5.0,2997.0,5.0],[4.0,5.0,47.0,3.0],[5.0,5.0,2700.0,4.0],[7.0,5.0,296.0,4.0],[8.0,5.0,581.0,3.0],[5.0,5.0,1617.0,3.0],[9.0,5.0,728.0,4.0],[4.0,5.0,299.0,3.0],[2.0,5.0,3079.0,2.0],[7.0,5.0,2560.0,4.0],[9.0,5.0,1909.0,3.0],[3.0,5.0,150.0,2.0],[9.0,5.0,224.0,3.0],[8.0,5.0,3728.0,2.0],[8.0,5.0,229.0,3.0],[6.0,5.0,6.0,2.0],[2.0,5.0,3006.0,3.0],[0.0,5.0,2858.0,4.0],[4.0,5.0,1046.0,5.0],[1.0,5.0,515.0,4.0],[0.0,5.0,800.0,2.0],[5.0,5.0,50.0,5.0],[9.0,5.0,52.0,2.0],[6.0,5.0,1191.0,2.0],[3.0,5.0,1192.0,5.0],[3.0,5.0,733.0,1.0],[4.0,5.0,3081.0,3.0],[9.0,5.0,377.0,4.0],[0.0,5.0,2353.0,3.0],[8.0,5.0,1268.0,2.0],[4.0,5.0,3083.0,5.0],[0.0,5.0,2427.0,5.0],[6.0,5.0,3513.0,1.0],[1.0,5.0,2428.0,3.0],[1.0,5.0,2355.0,5.0],[7.0,5.0,2282.0,3.0],[9.0,5.0,3514.0,2.0],[0.0,5.0,1554.0,3.0],[4.0,5.0,1912.0,3.0],[7.0,5.0,593.0,4.0],[8.0,5.0,2359.0,3.0],[7.0,5.0,2716.0,3.0],[6.0,5.0,1485.0,3.0],[2.0,5.0,2717.0,1.0],[3.0,5.0,2571.0,5.0],[8.0,5.0,2289.0,4.0],[4.0,5.0,162.0,4.0],[0.0,5.0,1127.0,1.0],[6.0,5.0,3016.0,4.0],[1.0,5.0,2070.0,2.0],[7.0,5.0,1704.0,3.0],[2.0,5.0,3163.0,5.0],[9.0,5.0,2437.0,2.0],[8.0,5.0,2291.0,5.0],[4.0,5.0,1635.0,4.0],[4.0,5.0,1279.0,1.0],[1.0,5.0,2721.0,3.0],[8.0,5.0,2723.0,4.0],[2.0,5.0,1921.0,4.0],[2.0,5.0,2725.0,2.0],[4.0,5.0,1923.0,3.0],[7.0,5.0,2580.0,4.0],[8.0,5.0,3386.0,2.0],[6.0,5.0,3744.0,1.0],[7.0,5.0,968.0,3.0],[3.0,5.0,896.0,4.0],[6.0,5.0,3020.0,1.0],[3.0,5.0,1788.0,3.0],[7.0,5.0,318.0,3.0],[8.0,5.0,176.0,4.0],[3.0,5.0,461.0,3.0],[7.0,5.0,608.0,4.0],[9.0,5.0,1429.0,3.0],[8.0,5.0,2159.0,1.0],[1.0,5.0,1715.0,4.0],[6.0,5.0,1643.0,3.0],[6.0,5.0,3249.0,1.0],[5.0,5.0,3176.0,2.0],[5.0,5.0,1719.0,3.0],[5.0,5.0,2806.0,2.0],[8.0,5.0,2734.0,2.0],[7.0,5.0,1649.0,4.0],[3.0,5.0,321.0,3.0],[4.0,5.0,2013.0,3.0],[5.0,5.0,3100.0,1.0],[0.0,5.0,2952.0,2.0],[7.0,5.0,1213.0,5.0],[6.0,5.0,1794.0,3.0],[3.0,5.0,2599.0,5.0],[4.0,5.0,1500.0,3.0],[6.0,5.0,3105.0,2.0],[1.0,5.0,2959.0,4.0],[2.0,5.0,1509.0,3.0],[3.0,5.0,1721.0,1.0],[8.0,5.0,1722.0,2.0],[4.0,5.0,1650.0,3.0],[2.0,5.0,908.0,4.0],[9.0,5.0,1580.0,4.0],[1.0,5.0,1653.0,2.0],[8.0,5.0,2384.0,3.0],[3.0,5.0,1729.0,4.0],[6.0,5.0,3476.0,3.0],[5.0,5.0,2890.0,4.0],[3.0,5.0,3113.0,1.0],[3.0,5.0,2028.0,2.0],[5.0,5.0,16.0,3.0],[7.0,5.0,265.0,3.0],[5.0,5.0,2029.0,4.0],[8.0,5.0,194.0,3.0],[4.0,5.0,551.0,4.0],[7.0,5.0,1513.0,4.0],[2.0,5.0,3046.0,3.0],[0.0,5.0,2318.0,4.0],[8.0,5.0,1517.0,4.0],[5.0,5.0,1089.0,5.0],[5.0,5.0,3260.0,4.0],[0.0,5.0,913.0,5.0],[3.0,5.0,1730.0,4.0],[3.0,5.0,3408.0,3.0],[1.0,5.0,3409.0,3.0],[7.0,5.0,2607.0,2.0],[0.0,5.0,1449.0,4.0],[0.0,5.0,1732.0,5.0],[0.0,5.0,1733.0,3.0],[9.0,5.0,2390.0,4.0],[4.0,5.0,1734.0,4.0],[2.0,5.0,3266.0,2.0],[3.0,5.0,3267.0,4.0],[2.0,5.0,919.0,4.0],[3.0,5.0,3624.0,3.0],[4.0,5.0,2395.0,5.0],[8.0,5.0,1594.0,1.0],[4.0,5.0,2683.0,3.0],[1.0,5.0,412.0,2.0],[0.0,5.0,2759.0,3.0],[0.0,5.0,994.0,5.0],[6.0,5.0,1884.0,3.0],[8.0,5.0,1885.0,4.0],[7.0,5.0,272.0,3.0],[4.0,5.0,24.0,1.0],[4.0,5.0,3051.0,2.0],[3.0,5.0,348.0,4.0],[5.0,5.0,2323.0,4.0],[0.0,5.0,1093.0,2.0],[5.0,5.0,29.0,5.0],[3.0,5.0,562.0,4.0],[5.0,5.0,1095.0,4.0],[9.0,5.0,1527.0,3.0],[7.0,5.0,1529.0,4.0],[2.0,5.0,3418.0,3.0],[0.0,5.0,2188.0,1.0],[7.0,5.0,497.0,3.0],[3.0,5.0,202.0,2.0],[3.0,5.0,1747.0,2.0],[1.0,5.0,2908.0,4.0],[4.0,5.0,2762.0,3.0],[7.0,5.0,2692.0,4.0],[1.0,5.0,1966.0,2.0],[5.0,5.0,3499.0,3.0],[4.0,5.0,353.0,2.0],[2.0,5.0,32.0,4.0],[1.0,5.0,1243.0,3.0],[6.0,5.0,1897.0,4.0],[2.0,5.0,1171.0,4.0],[1.0,5.0,3786.0,3.0],[3.0,5.0,34.0,4.0],[2.0,5.0,356.0,1.0],[9.0,5.0,357.0,2.0],[8.0,5.0,36.0,3.0],[3.0,5.0,714.0,4.0],[0.0,6.0,2406.0,5.0],[0.0,6.0,1101.0,4.0],[1.0,6.0,3717.0,4.0],[1.0,6.0,1030.0,4.0],[0.0,6.0,1688.0,5.0],[7.0,6.0,1035.0,5.0],[5.0,6.0,3578.0,4.0],[0.0,6.0,364.0,4.0],[0.0,6.0,3501.0,5.0],[5.0,6.0,3072.0,4.0],[9.0,6.0,368.0,4.0],[9.0,6.0,296.0,2.0],[0.0,6.0,48.0,5.0],[6.0,6.0,3074.0,5.0],[1.0,6.0,1188.0,4.0],[6.0,6.0,3508.0,3.0],[1.0,6.0,588.0,4.0],[8.0,6.0,1.0,4.0],[9.0,6.0,1043.0,4.0],[9.0,6.0,2858.0,1.0],[3.0,6.0,377.0,3.0],[2.0,6.0,590.0,3.0],[1.0,6.0,595.0,4.0],[9.0,6.0,597.0,5.0],[9.0,6.0,383.0,4.0],[5.0,6.0,2506.0,3.0],[9.0,6.0,3524.0,3.0],[0.0,6.0,1566.0,4.0],[8.0,6.0,1569.0,4.0],[2.0,6.0,2006.0,4.0],[7.0,6.0,2081.0,4.0],[5.0,6.0,2082.0,3.0],[3.0,6.0,3600.0,3.0],[7.0,6.0,3604.0,5.0],[2.0,6.0,2802.0,4.0],[9.0,6.0,3534.0,4.0],[0.0,6.0,3536.0,5.0],[9.0,6.0,1210.0,3.0],[5.0,6.0,3753.0,5.0],[6.0,6.0,3682.0,3.0],[3.0,6.0,2017.0,3.0],[9.0,6.0,3685.0,3.0],[3.0,6.0,3610.0,3.0],[9.0,6.0,1296.0,3.0],[4.0,6.0,838.0,4.0],[6.0,6.0,1007.0,3.0],[7.0,6.0,1947.0,5.0],[3.0,6.0,2966.0,5.0],[9.0,6.0,266.0,4.0],[3.0,6.0,17.0,4.0],[7.0,6.0,3699.0,4.0],[3.0,6.0,1441.0,4.0],[0.0,6.0,1088.0,5.0],[2.0,6.0,912.0,4.0],[0.0,6.0,199.0,5.0],[7.0,6.0,914.0,5.0],[0.0,6.0,3408.0,5.0],[6.0,6.0,1806.0,3.0],[6.0,6.0,3624.0,4.0],[0.0,6.0,2469.0,3.0],[9.0,6.0,2396.0,4.0],[7.0,6.0,2100.0,3.0],[2.0,6.0,1959.0,3.0],[4.0,6.0,2321.0,3.0],[1.0,6.0,1380.0,5.0],[1.0,6.0,920.0,4.0],[6.0,6.0,569.0,4.0],[7.0,6.0,1674.0,4.0],[8.0,6.0,3565.0,4.0],[7.0,6.0,1028.0,4.0],[4.0,6.0,34.0,4.0],[7.0,7.0,648.0,4.0],[4.0,7.0,861.0,4.0],[2.0,7.0,2916.0,5.0],[7.0,7.0,3578.0,3.0],[7.0,7.0,3793.0,3.0],[6.0,7.0,1610.0,5.0],[6.0,7.0,589.0,5.0],[2.0,7.0,6.0,4.0],[2.0,7.0,442.0,4.0],[2.0,7.0,733.0,5.0],[0.0,7.0,377.0,3.0],[4.0,7.0,2353.0,5.0],[2.0,7.0,1196.0,5.0],[6.0,7.0,2571.0,5.0],[4.0,7.0,380.0,5.0],[7.0,7.0,1997.0,5.0],[1.0,7.0,1270.0,4.0],[6.0,7.0,457.0,5.0],[4.0,7.0,1573.0,4.0],[7.0,7.0,3753.0,4.0],[8.0,7.0,3107.0,3.0],[2.0,7.0,474.0,5.0],[4.0,7.0,1722.0,4.0],[4.0,7.0,3256.0,5.0],[2.0,7.0,1580.0,4.0],[6.0,7.0,110.0,5.0],[9.0,7.0,1221.0,4.0],[6.0,7.0,2028.0,5.0],[7.0,7.0,480.0,4.0],[4.0,7.0,349.0,5.0],[0.0,7.0,3418.0,3.0],[1.0,8.0,39.0,3.0],[0.0,8.0,2336.0,3.0],[1.0,8.0,288.0,5.0],[2.0,8.0,3425.0,3.0],[2.0,8.0,2268.0,3.0],[2.0,8.0,1466.0,4.0],[2.0,8.0,1393.0,5.0],[2.0,8.0,1682.0,4.0],[2.0,8.0,2916.0,5.0],[3.0,8.0,506.0,3.0],[5.0,8.0,508.0,3.0],[2.0,8.0,3213.0,3.0],[4.0,8.0,42.0,3.0],[3.0,8.0,650.0,5.0],[4.0,8.0,3500.0,3.0],[7.0,8.0,296.0,5.0],[0.0,8.0,3147.0,5.0],[8.0,8.0,3148.0,3.0],[3.0,8.0,2702.0,3.0],[3.0,8.0,2278.0,3.0],[3.0,8.0,1476.0,3.0],[3.0,8.0,2490.0,2.0],[8.0,8.0,589.0,5.0],[2.0,8.0,1836.0,4.0],[1.0,8.0,1693.0,3.0],[1.0,8.0,150.0,4.0],[0.0,8.0,151.0,4.0],[6.0,8.0,1.0,4.0],[6.0,8.0,510.0,3.0],[3.0,8.0,4.0,3.0],[7.0,8.0,3006.0,3.0],[7.0,8.0,2858.0,5.0],[6.0,8.0,1621.0,3.0],[4.0,8.0,1265.0,5.0],[7.0,8.0,733.0,3.0],[4.0,8.0,377.0,4.0],[1.0,8.0,3155.0,3.0],[4.0,8.0,2427.0,5.0],[6.0,8.0,58.0,5.0],[6.0,8.0,2712.0,3.0],[0.0,8.0,2429.0,2.0],[7.0,8.0,1840.0,4.0],[2.0,8.0,2571.0,5.0],[3.0,8.0,1916.0,5.0],[2.0,8.0,1488.0,3.0],[7.0,8.0,230.0,4.0],[1.0,8.0,1120.0,4.0],[5.0,8.0,161.0,3.0],[6.0,8.0,163.0,5.0],[1.0,8.0,1411.0,5.0],[1.0,8.0,524.0,5.0],[4.0,8.0,1059.0,3.0],[7.0,8.0,527.0,4.0],[3.0,8.0,454.0,3.0],[9.0,8.0,1701.0,4.0],[2.0,8.0,1274.0,5.0],[6.0,8.0,741.0,5.0],[0.0,8.0,1704.0,5.0],[4.0,8.0,1277.0,3.0],[2.0,8.0,2291.0,5.0],[2.0,8.0,1639.0,5.0],[7.0,8.0,3528.0,4.0],[2.0,8.0,2297.0,3.0],[9.0,8.0,3386.0,3.0],[7.0,8.0,2006.0,3.0],[7.0,8.0,608.0,5.0],[3.0,8.0,465.0,5.0],[0.0,8.0,1711.0,3.0],[1.0,8.0,538.0,3.0],[8.0,8.0,393.0,2.0],[0.0,8.0,2442.0,4.0],[0.0,8.0,1357.0,4.0],[6.0,8.0,73.0,4.0],[1.0,8.0,3246.0,4.0],[2.0,8.0,3173.0,2.0],[0.0,8.0,1573.0,4.0],[6.0,8.0,105.0,4.0],[9.0,8.0,1210.0,4.0],[7.0,8.0,1213.0,5.0],[3.0,8.0,253.0,5.0],[6.0,8.0,3105.0,4.0],[6.0,8.0,3107.0,5.0],[4.0,8.0,3250.0,3.0],[3.0,8.0,3252.0,3.0],[0.0,8.0,1721.0,5.0],[7.0,8.0,476.0,3.0],[7.0,8.0,3256.0,5.0],[2.0,8.0,908.0,5.0],[3.0,8.0,3257.0,3.0],[6.0,8.0,1653.0,5.0],[3.0,8.0,1580.0,4.0],[2.0,8.0,110.0,5.0],[2.0,8.0,111.0,5.0],[1.0,8.0,3259.0,4.0],[2.0,8.0,3186.0,4.0],[3.0,8.0,1589.0,4.0],[2.0,8.0,2023.0,3.0],[6.0,8.0,14.0,4.0],[8.0,8.0,2028.0,5.0],[8.0,8.0,337.0,5.0],[1.0,8.0,265.0,4.0],[5.0,8.0,16.0,4.0],[4.0,8.0,266.0,4.0],[1.0,8.0,17.0,4.0],[6.0,8.0,2314.0,3.0],[1.0,8.0,2600.0,2.0],[0.0,8.0,480.0,5.0],[1.0,8.0,269.0,4.0],[4.0,8.0,555.0,4.0],[6.0,8.0,1801.0,3.0],[7.0,8.0,3260.0,3.0],[3.0,8.0,1730.0,4.0],[1.0,8.0,1660.0,3.0],[8.0,8.0,3265.0,5.0],[4.0,8.0,1735.0,4.0],[4.0,8.0,3267.0,5.0],[2.0,8.0,3481.0,4.0],[4.0,8.0,2396.0,5.0],[2.0,8.0,2686.0,4.0],[9.0,8.0,2688.0,3.0],[3.0,8.0,345.0,3.0],[2.0,8.0,2320.0,2.0],[6.0,8.0,24.0,4.0],[7.0,8.0,25.0,5.0],[3.0,8.0,2324.0,3.0],[7.0,8.0,349.0,4.0],[4.0,8.0,562.0,5.0],[0.0,8.0,2329.0,5.0],[1.0,8.0,1810.0,2.0],[1.0,8.0,2541.0,3.0],[8.0,8.0,3418.0,3.0],[6.0,8.0,1673.0,5.0],[2.0,8.0,2908.0,3.0],[9.0,8.0,1678.0,5.0],[8.0,8.0,2692.0,5.0],[3.0,8.0,1027.0,4.0],[7.0,8.0,2699.0,5.0],[2.0,8.0,282.0,3.0],[3.0,8.0,36.0,4.0],[5.0,9.0,2268.0,4.0],[8.0,9.0,1466.0,4.0],[1.0,9.0,1393.0,3.0],[5.0,9.0,861.0,2.0],[2.0,9.0,1682.0,4.0],[9.0,9.0,3717.0,3.0],[5.0,9.0,508.0,3.0],[1.0,9.0,3793.0,4.0],[8.0,9.0,720.0,4.0],[8.0,9.0,367.0,3.0],[3.0,9.0,47.0,5.0],[1.0,9.0,3147.0,4.0],[7.0,9.0,3148.0,3.0],[4.0,9.0,1617.0,4.0],[5.0,9.0,2278.0,4.0],[5.0,9.0,223.0,4.0],[1.0,9.0,150.0,3.0],[6.0,9.0,3298.0,4.0],[2.0,9.0,1.0,5.0],[1.0,9.0,3006.0,3.0],[3.0,9.0,2858.0,4.0],[7.0,9.0,3948.0,3.0],[3.0,9.0,50.0,4.0],[6.0,9.0,1265.0,4.0],[4.0,9.0,805.0,3.0],[0.0,9.0,3510.0,3.0],[0.0,9.0,377.0,3.0],[9.0,9.0,1552.0,2.0],[4.0,9.0,590.0,5.0],[0.0,9.0,3513.0,3.0],[4.0,9.0,2355.0,4.0],[3.0,9.0,1912.0,3.0],[4.0,9.0,593.0,5.0],[4.0,9.0,2571.0,5.0],[3.0,9.0,597.0,3.0],[7.0,9.0,300.0,4.0],[1.0,9.0,1777.0,4.0],[3.0,9.0,162.0,4.0],[9.0,9.0,524.0,4.0],[8.0,9.0,3301.0,2.0],[1.0,9.0,1343.0,3.0],[3.0,9.0,527.0,5.0],[4.0,9.0,3160.0,3.0],[4.0,9.0,529.0,5.0],[6.0,9.0,457.0,5.0],[4.0,9.0,1704.0,4.0],[8.0,9.0,745.0,4.0],[6.0,9.0,3452.0,2.0],[8.0,9.0,2294.0,4.0],[8.0,9.0,1921.0,4.0],[9.0,9.0,1639.0,4.0],[5.0,9.0,1923.0,5.0],[9.0,9.0,1784.0,3.0],[1.0,9.0,1060.0,4.0],[3.0,9.0,318.0,5.0],[8.0,9.0,608.0,4.0],[4.0,9.0,1356.0,3.0],[7.0,9.0,1358.0,4.0],[8.0,9.0,3178.0,3.0],[9.0,9.0,3751.0,4.0],[3.0,9.0,1210.0,4.0],[8.0,9.0,3826.0,2.0],[4.0,9.0,1213.0,4.0],[3.0,9.0,3755.0,2.0],[2.0,9.0,2599.0,2.0],[3.0,9.0,2302.0,4.0],[3.0,9.0,1500.0,4.0],[3.0,9.0,2959.0,4.0],[3.0,9.0,1148.0,4.0],[7.0,9.0,2166.0,4.0],[8.0,9.0,1721.0,5.0],[5.0,9.0,3253.0,4.0],[6.0,9.0,3255.0,4.0],[9.0,9.0,1653.0,4.0],[5.0,9.0,838.0,3.0],[3.0,9.0,1584.0,5.0],[8.0,9.0,1221.0,4.0],[8.0,9.0,1223.0,4.0],[1.0,9.0,2890.0,5.0],[8.0,9.0,2028.0,5.0],[2.0,9.0,3114.0,4.0],[9.0,9.0,16.0,4.0],[8.0,9.0,480.0,4.0],[8.0,9.0,1089.0,4.0],[9.0,9.0,912.0,4.0],[0.0,9.0,1446.0,3.0],[0.0,9.0,3408.0,4.0],[1.0,9.0,3623.0,4.0],[8.0,9.0,778.0,5.0],[0.0,9.0,1669.0,3.0],[8.0,9.0,3484.0,2.0],[1.0,9.0,412.0,3.0],[3.0,9.0,3916.0,3.0],[8.0,9.0,994.0,4.0],[3.0,9.0,1233.0,3.0],[9.0,9.0,1307.0,4.0],[1.0,9.0,25.0,4.0],[6.0,9.0,2324.0,5.0],[4.0,9.0,349.0,4.0],[1.0,9.0,920.0,3.0],[8.0,9.0,3270.0,3.0],[4.0,9.0,2762.0,4.0],[9.0,9.0,1961.0,5.0],[9.0,9.0,2692.0,4.0],[6.0,9.0,1310.0,3.0],[0.0,9.0,428.0,3.0],[2.0,10.0,2622.0,5.0],[5.0,10.0,648.0,4.0],[8.0,10.0,2628.0,3.0],[8.0,10.0,3358.0,5.0],[5.0,10.0,3359.0,3.0],[9.0,10.0,1682.0,5.0],[5.0,10.0,1756.0,4.0],[7.0,10.0,1320.0,3.0],[8.0,10.0,2124.0,3.0],[5.0,10.0,2125.0,5.0],[2.0,10.0,1250.0,3.0],[9.0,10.0,2054.0,4.0],[9.0,10.0,1252.0,3.0],[6.0,10.0,1253.0,5.0],[0.0,10.0,720.0,5.0],[7.0,10.0,3868.0,3.0],[4.0,10.0,1254.0,3.0],[2.0,10.0,3869.0,3.0],[1.0,10.0,1256.0,3.0],[3.0,10.0,3500.0,5.0],[0.0,10.0,1257.0,5.0],[1.0,10.0,3501.0,5.0],[6.0,10.0,2997.0,4.0],[4.0,10.0,1259.0,3.0],[1.0,10.0,653.0,4.0],[6.0,10.0,1831.0,5.0],[6.0,10.0,3363.0,5.0],[7.0,10.0,586.0,3.0],[8.0,10.0,587.0,5.0],[6.0,10.0,3438.0,3.0],[0.0,10.0,588.0,4.0],[4.0,10.0,3439.0,2.0],[8.0,10.0,589.0,4.0],[3.0,10.0,1690.0,4.0],[3.0,10.0,3296.0,4.0],[0.0,10.0,223.0,2.0],[9.0,10.0,150.0,5.0],[7.0,10.0,2496.0,4.0],[4.0,10.0,1.0,5.0],[9.0,10.0,2497.0,4.0],[7.0,10.0,2.0,5.0],[1.0,10.0,2498.0,4.0],[7.0,10.0,153.0,3.0],[3.0,10.0,7.0,4.0],[1.0,10.0,2133.0,4.0],[9.0,10.0,2135.0,4.0],[0.0,10.0,3948.0,4.0],[3.0,10.0,2136.0,4.0],[2.0,10.0,2137.0,4.0],[8.0,10.0,1408.0,4.0],[5.0,10.0,802.0,5.0],[8.0,10.0,2138.0,3.0],[4.0,10.0,1409.0,5.0],[0.0,10.0,2067.0,3.0],[0.0,10.0,1265.0,5.0],[6.0,10.0,1339.0,5.0],[0.0,10.0,1269.0,5.0],[8.0,10.0,1196.0,5.0],[6.0,10.0,590.0,5.0],[0.0,10.0,1197.0,5.0],[0.0,10.0,1198.0,5.0],[0.0,10.0,2640.0,5.0],[3.0,10.0,592.0,4.0],[3.0,10.0,594.0,5.0],[2.0,10.0,2716.0,4.0],[3.0,10.0,595.0,5.0],[3.0,10.0,2717.0,4.0],[8.0,10.0,2571.0,5.0],[4.0,10.0,596.0,4.0],[3.0,10.0,3447.0,5.0],[5.0,10.0,597.0,4.0],[0.0,10.0,1918.0,3.0],[5.0,10.0,2140.0,5.0],[7.0,10.0,1411.0,4.0],[3.0,10.0,2072.0,4.0],[5.0,10.0,1270.0,4.0],[9.0,10.0,1271.0,5.0],[5.0,10.0,1345.0,3.0],[6.0,10.0,2077.0,3.0],[6.0,10.0,2078.0,4.0],[6.0,10.0,1276.0,3.0],[5.0,10.0,743.0,3.0],[8.0,10.0,671.0,3.0],[2.0,10.0,1278.0,5.0],[4.0,10.0,745.0,5.0],[9.0,10.0,3451.0,5.0],[0.0,10.0,3525.0,2.0],[3.0,10.0,1921.0,4.0],[8.0,10.0,1923.0,5.0],[9.0,10.0,1927.0,3.0],[9.0,10.0,3386.0,4.0],[9.0,10.0,2657.0,4.0],[6.0,10.0,3388.0,3.0],[0.0,10.0,1784.0,5.0],[3.0,10.0,316.0,5.0],[5.0,10.0,317.0,4.0],[9.0,10.0,318.0,4.0],[1.0,10.0,248.0,5.0],[6.0,10.0,2080.0,4.0],[3.0,10.0,2081.0,5.0],[4.0,10.0,2082.0,3.0],[9.0,10.0,1282.0,5.0],[1.0,10.0,1356.0,5.0],[4.0,10.0,1283.0,3.0],[6.0,10.0,750.0,4.0],[5.0,10.0,1357.0,5.0],[8.0,10.0,2087.0,5.0],[6.0,10.0,1286.0,5.0],[5.0,10.0,1287.0,3.0],[3.0,10.0,2804.0,5.0],[1.0,10.0,3608.0,3.0],[9.0,10.0,2662.0,4.0],[7.0,10.0,3466.0,5.0],[5.0,10.0,3100.0,3.0],[2.0,10.0,2300.0,5.0],[6.0,10.0,253.0,5.0],[6.0,10.0,180.0,2.0],[8.0,10.0,2599.0,5.0],[7.0,10.0,2302.0,5.0],[7.0,10.0,329.0,5.0],[0.0,10.0,3034.0,4.0],[6.0,10.0,3108.0,5.0],[7.0,10.0,3035.0,3.0],[8.0,10.0,186.0,3.0],[2.0,10.0,2161.0,5.0],[2.0,10.0,3037.0,5.0],[0.0,10.0,2090.0,4.0],[3.0,10.0,3039.0,4.0],[3.0,10.0,2091.0,3.0],[6.0,10.0,902.0,5.0],[6.0,10.0,830.0,5.0],[4.0,10.0,2093.0,4.0],[5.0,10.0,1291.0,5.0],[9.0,10.0,904.0,4.0],[7.0,10.0,2094.0,4.0],[5.0,10.0,1292.0,5.0],[2.0,10.0,1293.0,4.0],[4.0,10.0,2096.0,5.0],[2.0,10.0,1294.0,4.0],[0.0,10.0,765.0,4.0],[1.0,10.0,3471.0,5.0],[7.0,10.0,2746.0,5.0],[7.0,10.0,1009.0,5.0],[5.0,10.0,1947.0,5.0],[0.0,10.0,1948.0,4.0],[1.0,10.0,333.0,3.0],[7.0,10.0,260.0,5.0],[9.0,10.0,3114.0,4.0],[9.0,10.0,2312.0,5.0],[5.0,10.0,339.0,5.0],[0.0,10.0,1513.0,3.0],[6.0,10.0,2316.0,4.0],[1.0,10.0,1441.0,5.0],[1.0,10.0,1517.0,3.0],[7.0,10.0,1371.0,4.0],[9.0,10.0,2174.0,5.0],[8.0,10.0,1372.0,4.0],[8.0,10.0,912.0,3.0],[0.0,10.0,913.0,3.0],[0.0,10.0,1374.0,4.0],[5.0,10.0,914.0,5.0],[2.0,10.0,1375.0,4.0],[5.0,10.0,915.0,5.0],[2.0,10.0,1376.0,4.0],[4.0,10.0,1377.0,3.0],[4.0,10.0,916.0,5.0],[5.0,10.0,918.0,5.0],[1.0,10.0,919.0,5.0],[2.0,10.0,1012.0,3.0],[0.0,10.0,3481.0,4.0],[0.0,10.0,2826.0,4.0],[8.0,10.0,3629.0,3.0],[3.0,10.0,1015.0,3.0],[1.0,10.0,1016.0,5.0],[5.0,10.0,1954.0,3.0],[3.0,10.0,1019.0,4.0],[2.0,10.0,1884.0,2.0],[5.0,10.0,3489.0,4.0],[0.0,10.0,1959.0,5.0],[3.0,10.0,344.0,4.0],[6.0,10.0,24.0,3.0],[6.0,10.0,2321.0,4.0],[1.0,10.0,275.0,4.0],[7.0,10.0,2324.0,5.0],[8.0,10.0,2252.0,5.0],[7.0,10.0,277.0,3.0],[6.0,10.0,1380.0,5.0],[9.0,10.0,920.0,5.0],[5.0,10.0,923.0,3.0],[3.0,10.0,924.0,3.0],[1.0,10.0,3701.0,3.0],[3.0,10.0,3702.0,3.0],[5.0,10.0,780.0,5.0],[5.0,10.0,3703.0,2.0],[2.0,10.0,1387.0,3.0],[2.0,10.0,926.0,4.0],[4.0,10.0,3704.0,2.0],[6.0,10.0,1020.0,3.0],[6.0,10.0,784.0,3.0],[5.0,10.0,858.0,3.0],[9.0,10.0,1022.0,5.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"timestamp","type":"\"long\""},{"name":"userId","type":"\"integer\""},{"name":"movieId","type":"\"integer\""},{"name":"rating","type":"\"double\""}],"overflow":true,"aggData":[[1.0,4.145015105740181],[2.0,3.174698795180723],[3.0,3.0468227424749164],[4.0,2.676056338028169],[5.0,3.051470588235294],[6.0,3.7918552036199094],[7.0,3.3991228070175437],[8.0,2.926829268292683],[9.0,2.727272727272727],[10.0,3.535885167464115],[11.0,3.7657142857142856],[12.0,2.3777777777777778],[13.0,3.088888888888889],[14.0,3.6049382716049383],[15.0,2.358974358974359],[16.0,3.727272727272727],[17.0,3.995180722891566],[18.0,3.0704225352112675],[19.0,2.431578947368421],[20.0,2.5308641975308643],[21.0,3.6160990712074303],[22.0,3.281437125748503],[23.0,2.857142857142857],[24.0,3.145631067961165],[25.0,3.6339285714285716],[26.0,3.5217391304347827],[27.0,3.033333333333333],[28.0,4.063291139240507],[29.0,4.038461538461538],[30.0,3.75],[31.0,3.2419354838709675],[32.0,3.921985815602837],[33.0,3.0],[34.0,3.924882629107981],[35.0,3.3783783783783785],[36.0,3.9584199584199586],[37.0,3.6666666666666665],[38.0,2.4705882352941178],[39.0,3.63302752293578],[40.0,4.125],[41.0,3.9537037037037037],[42.0,2.7731958762886597],[43.0,3.6091954022988504],[44.0,2.7810650887573964],[45.0,3.411111111111111],[46.0,3.0632911392405062],[47.0,4.039285714285715],[48.0,3.0150753768844223],[49.0,3.6],[50.0,4.505415162454874],[52.0,3.581730769230769],[53.0,4.0],[54.0,2.3636363636363638],[55.0,2.8095238095238093],[56.0,2.6666666666666665],[57.0,3.3],[58.0,4.069868995633188],[59.0,2.8],[60.0,3.210526315789474],[61.0,2.875],[62.0,3.671814671814672],[63.0,2.9622641509433962],[64.0,2.4166666666666665],[65.0,2.0821917808219177],[66.0,1.6],[67.0,4.0],[68.0,3.4375],[69.0,3.588235294117647],[70.0,3.1773879142300196],[71.0,2.020408163265306],[72.0,3.6],[73.0,3.965217391304348],[74.0,3.0],[75.0,1.7142857142857142],[76.0,2.781609195402299],[77.0,3.5625],[78.0,3.1363636363636362],[79.0,2.4464285714285716],[80.0,3.6818181818181817],[81.0,3.1486486486486487],[82.0,3.7948717948717947],[83.0,3.5714285714285716],[84.0,3.3],[85.0,3.3863636363636362],[86.0,3.4491525423728815],[87.0,2.236842105263158],[88.0,2.9895833333333335],[89.0,3.104],[90.0,3.0],[92.0,2.388888888888889],[93.0,2.1777777777777776],[94.0,3.7252747252747254],[95.0,2.8471337579617835],[96.0,4.0],[97.0,3.4375],[98.0,1.75],[99.0,3.625],[100.0,3.0],[101.0,3.7829457364341086],[102.0,1.945945945945946],[103.0,3.230769230769231],[104.0,3.4371428571428573],[105.0,3.2555555555555555],[106.0,4.25],[107.0,3.0854700854700856],[108.0,4.0],[110.0,4.184615384615385],[111.0,4.166969147005445],[112.0,3.4486301369863015],[113.0,3.0],[114.0,2.8],[116.0,4.1],[117.0,3.7027027027027026],[118.0,3.1333333333333333],[119.0,2.5714285714285716],[120.0,2.5],[121.0,4.055555555555555],[122.0,2.5454545454545454],[123.0,3.765957446808511],[124.0,4.25],[125.0,3.931972789115646],[126.0,1.8392857142857142],[128.0,4.2],[129.0,3.272727272727273],[130.0,4.0],[131.0,2.3333333333333335],[132.0,2.2285714285714286],[135.0,2.9178082191780823],[136.0,4.0],[137.0,3.0],[139.0,4.0],[140.0,3.227272727272727],[141.0,3.573248407643312],[142.0,1.0],[144.0,3.343065693430657],[145.0,3.2468354430379747],[146.0,2.9],[147.0,3.27027027027027],[148.0,2.857142857142857],[149.0,3.9],[150.0,4.084126984126984],[151.0,3.576642335766423],[152.0,3.230769230769231],[153.0,2.701058201058201],[154.0,3.825],[155.0,3.15],[156.0,3.3225806451612905],[157.0,2.727272727272727],[158.0,2.9761904761904763],[159.0,3.3157894736842106],[160.0,2.193548387096774],[161.0,3.74025974025974],[162.0,4.108108108108108],[163.0,3.4901960784313726],[164.0,3.531578947368421],[165.0,3.5692307692307694],[166.0,2.78125],[167.0,3.6666666666666665],[168.0,2.956043956043956],[169.0,2.037037037037037],[170.0,3.1366459627329193],[171.0,3.488888888888889],[172.0,2.583710407239819],[173.0,2.267924528301887],[174.0,2.347826086956522],[175.0,3.4464285714285716],[176.0,3.9029126213592233],[177.0,2.746031746031746],[178.0,3.6],[179.0,2.076923076923077],[180.0,3.5339366515837103],[181.0,1.7391304347826086],[182.0,3.238095238095238],[183.0,3.4545454545454546],[184.0,3.8],[185.0,2.781132075471698],[186.0,2.8518518518518516],[187.0,3.2127659574468086],[188.0,3.1875],[189.0,3.857142857142857],[190.0,3.7222222222222223],[191.0,2.40625],[192.0,3.0],[193.0,2.0495049504950495],[194.0,3.752577319587629],[195.0,2.9],[196.0,2.8007662835249043],[197.0,2.5714285714285716],[198.0,3.269230769230769],[199.0,3.9523809523809526],[200.0,2.0],[201.0,2.4583333333333335],[202.0,2.4210526315789473],[203.0,2.978723404255319],[204.0,2.8598130841121496],[205.0,3.5641025641025643],[206.0,3.55],[207.0,3.1403508771929824],[208.0,2.6952380952380954],[209.0,2.5217391304347827],[210.0,3.0],[211.0,3.526315789473684],[212.0,1.9230769230769231],[213.0,3.9672131147540983],[214.0,4.1875],[215.0,3.784090909090909],[216.0,3.073446327683616],[217.0,2.217391304347826],[218.0,3.130434782608696],[219.0,3.4285714285714284],[220.0,1.8461538461538463],[222.0,3.484076433121019],[223.0,3.9549929676511955],[224.0,3.4860335195530725],[225.0,3.1192660550458715],[227.0,2.6507936507936507],[228.0,2.5714285714285716],[229.0,3.4901960784313726],[230.0,3.473372781065089],[231.0,3.1651090342679127],[232.0,4.144508670520231],[233.0,3.7570093457943927],[234.0,2.2],[235.0,3.7777777777777777],[236.0,3.3],[237.0,2.9743589743589745],[238.0,2.625],[239.0,2.901098901098901],[240.0,2.9],[241.0,2.9285714285714284],[242.0,3.52],[243.0,2.3333333333333335],[244.0,2.2],[245.0,3.4285714285714284],[246.0,4.1947368421052635],[247.0,3.8505747126436782],[248.0,3.027027027027027],[249.0,3.7716535433070866],[250.0,2.5625],[251.0,3.5],[252.0,3.2923976608187133],[253.0,3.5945945945945947],[254.0,2.9411764705882355],[255.0,2.075],[256.0,2.624],[257.0,2.982456140350877],[258.0,2.267605633802817],[259.0,2.782608695652174],[260.0,4.43953006219765],[261.0,3.6218487394957983],[262.0,3.925925925925926],[263.0,4.0625],[264.0,3.5],[265.0,3.933526011560694],[266.0,3.3464373464373462],[267.0,2.6491228070175437],[268.0,3.3142857142857145],[269.0,3.727272727272727],[270.0,3.0444444444444443],[271.0,3.2941176470588234],[272.0,3.6898395721925135],[273.0,2.8468468468468466],[274.0,2.3333333333333335],[275.0,2.5531914893617023],[276.0,2.690265486725664],[277.0,3.343137254901961],[278.0,2.9166666666666665],[279.0,3.769230769230769],[280.0,3.5],[281.0,3.5923076923076924],[282.0,3.2386363636363638],[283.0,2.9],[287.0,2.5555555555555554],[288.0,3.08],[289.0,3.4415584415584415],[290.0,3.948717948717949],[291.0,2.6],[292.0,3.257575757575758],[293.0,4.167088607594937],[294.0,2.8333333333333335],[295.0,2.7],[296.0,4.296438883541867],[297.0,3.0],[298.0,4.0],[299.0,3.7560975609756095],[300.0,3.75],[301.0,3.0454545454545454],[302.0,3.9743589743589745],[303.0,2.964467005076142],[304.0,3.230769230769231],[305.0,2.5686274509803924],[306.0,4.204081632653061],[307.0,4.0],[308.0,3.9368421052631577],[309.0,3.5625],[310.0,3.0],[312.0,2.5428571428571427],[313.0,2.8],[314.0,3.8947368421052633],[315.0,2.5],[316.0,3.453846153846154],[317.0,3.200617283950617],[318.0,4.5349264705882355],[319.0,3.863157894736842],[320.0,3.4],[321.0,3.764705882352941],[322.0,3.650943396226415],[324.0,3.642857142857143],[325.0,2.347826086956522],[326.0,4.357142857142857],[327.0,2.517857142857143],[328.0,3.090909090909091],[329.0,3.347736625514403],[330.0,2.782051282051282],[331.0,3.2222222222222223],[332.0,2.426829268292683],[333.0,3.51980198019802],[334.0,3.830188679245283],[335.0,3.5],[336.0,2.625],[337.0,3.9212827988338192],[338.0,2.814814814814815],[339.0,3.4894894894894897],[340.0,3.425],[341.0,4.0],[342.0,3.616],[343.0,2.736842105263158],[344.0,3.169491525423729],[345.0,3.7116279069767444],[346.0,3.607142857142857],[347.0,3.391304347826087],[348.0,3.710526315789474],[349.0,3.74120082815735],[350.0,3.354581673306773],[351.0,3.2393162393162394],[352.0,3.0377358490566038],[353.0,3.440625],[354.0,3.21875],[355.0,2.387596899224806],[356.0,4.121270452358036],[357.0,3.7209302325581395],[358.0,3.0588235294117645],[359.0,3.4444444444444446],[360.0,2.6],[361.0,3.420689655172414],[362.0,3.3636363636363638],[363.0,4.37037037037037],[364.0,3.867272727272727],[365.0,3.3421052631578947],[366.0,2.8333333333333335],[367.0,3.2566844919786098],[368.0,3.5303030303030303],[369.0,3.230769230769231],[370.0,2.888888888888889],[371.0,3.2337662337662336],[372.0,3.1785714285714284],[373.0,3.870967741935484],[374.0,2.25531914893617],[375.0,3.4615384615384617],[376.0,3.230337078651685],[377.0,3.607940446650124],[378.0,2.753846153846154],[379.0,2.8211009174311927],[380.0,3.630813953488372],[381.0,3.357142857142857],[382.0,3.0],[383.0,3.1739130434782608],[384.0,3.0625],[385.0,3.6],[386.0,2.4545454545454546],[387.0,2.673076923076923],[388.0,3.64],[389.0,3.7142857142857144],[390.0,3.6176470588235294],[391.0,3.066666666666667],[392.0,3.0],[393.0,1.8095238095238095],[394.0,3.142857142857143],[397.0,2.2],[398.0,4.0],[401.0,3.0],[402.0,3.0],[405.0,2.0776699029126213],[406.0,3.8333333333333335],[407.0,2.8292682926829267],[408.0,3.21875],[409.0,3.090909090909091],[410.0,2.8995433789954337],[411.0,1.8],[412.0,3.5555555555555554],[413.0,2.5948275862068964],[414.0,2.6538461538461537],[415.0,2.4022988505747125],[416.0,2.375],[417.0,3.46],[418.0,2.727272727272727],[419.0,2.123456790123457],[420.0,2.533707865168539],[421.0,3.263157894736842],[422.0,3.076923076923077],[423.0,3.073394495412844],[424.0,2.5555555555555554],[425.0,3.5789473684210527],[426.0,2.983050847457627],[427.0,2.3472222222222223],[428.0,3.945736434108527],[429.0,2.4105263157894736],[430.0,2.3333333333333335],[431.0,3.679738562091503],[432.0,2.614130434782609],[433.0,2.9310344827586206],[434.0,3.1012269938650308],[435.0,2.5962264150943395],[436.0,2.453125],[437.0,2.25],[438.0,2.5833333333333335],[440.0,3.8542094455852154],[441.0,3.6993464052287583],[442.0,3.086053412462908],[443.0,3.1578947368421053],[444.0,2.25],[445.0,2.522727272727273],[446.0,4.109243697478991],[447.0,2.6470588235294117],[448.0,3.5925925925925926],[449.0,3.6216216216216215],[450.0,3.269230769230769],[451.0,3.12],[452.0,3.3125],[453.0,3.0344827586206895],[454.0,3.559077809798271],[455.0,2.614864864864865],[456.0,4.093023255813954],[457.0,4.071129707112971],[458.0,3.217391304347826],[459.0,2.9682539682539684],[460.0,2.111111111111111],[461.0,3.2051282051282053],[462.0,2.4],[463.0,2.7222222222222223],[464.0,2.7818181818181817],[465.0,3.108695652173913],[466.0,2.8297872340425534],[467.0,3.230769230769231],[468.0,3.3055555555555554],[469.0,2.625],[470.0,1.8461538461538463],[471.0,3.665492957746479],[472.0,2.5454545454545454],[473.0,2.1463414634146343],[474.0,3.792887029288703],[475.0,3.903225806451613],[476.0,2.642857142857143],[477.0,3.4563106796116503],[478.0,2.5384615384615383],[479.0,2.943396226415094],[480.0,3.7821503865073787],[481.0,3.3863636363636362],[482.0,3.4],[483.0,3.9],[484.0,2.7857142857142856],[485.0,2.517543859649123],[486.0,2.8],[487.0,2.6216216216216215],[488.0,3.4],[489.0,2.510204081632653],[490.0,3.242424242424242],[491.0,3.303030303030303],[492.0,3.7134502923976607],[493.0,3.533333333333333],[494.0,3.326530612244898],[495.0,3.55],[496.0,3.3846153846153846],[497.0,4.0064935064935066],[498.0,2.6666666666666665],[499.0,2.9],[500.0,3.4376590330788805],[501.0,3.48],[502.0,2.0641025641025643],[503.0,3.5],[504.0,2.841463414634146],[505.0,2.5609756097560976],[506.0,3.5555555555555554],[507.0,3.551282051282051],[508.0,3.8897338403041823],[509.0,3.6666666666666665],[510.0,2.526315789473684],[511.0,2.9615384615384617],[512.0,2.8777777777777778],[513.0,3.230769230769231],[514.0,3.4827586206896552],[515.0,3.960352422907489],[516.0,2.859259259259259],[517.0,3.087912087912088],[518.0,2.4571428571428573],[519.0,1.9166666666666667],[520.0,3.061224489795918],[521.0,3.293103448275862],[522.0,3.5454545454545454],[523.0,3.6842105263157894],[524.0,3.635782747603834],[525.0,3.357142857142857],[526.0,2.25],[527.0,4.515798462852263],[528.0,2.4642857142857144],[529.0,4.0375],[531.0,3.8684210526315788],[532.0,3.110526315789474],[533.0,2.830188679245283],[534.0,3.84251968503937],[535.0,3.847682119205298],[536.0,3.0357142857142856],[537.0,3.2526315789473683],[538.0,3.8940397350993377],[539.0,3.7983367983367984],[540.0,2.2253521126760565],[541.0,4.204733727810651],[542.0,2.650943396226415],[543.0,3.3470031545741326],[544.0,2.706896551724138],[545.0,2.0],[546.0,2.0],[547.0,2.9298245614035086],[548.0,2.493333333333333],[549.0,3.8714285714285714],[550.0,3.0348837209302326],[551.0,3.7193877551020407],[552.0,3.22962962962963],[553.0,3.8512396694214877],[554.0,2.2222222222222223],[555.0,3.896103896103896],[556.0,4.225352112676056],[557.0,5.0],[558.0,2.6623376623376624],[559.0,3.5],[560.0,3.75],[561.0,3.5714285714285716],[562.0,3.777292576419214],[563.0,3.3333333333333335],[564.0,2.1538461538461537],[565.0,3.5],[566.0,2.4285714285714284],[567.0,3.2857142857142856],[568.0,3.8260869565217392],[569.0,2.953125],[570.0,3.272727272727273],[571.0,3.6842105263157894],[573.0,3.125],[574.0,3.6865671641791047],[575.0,2.6557377049180326],[576.0,3.0],[577.0,2.7586206896551726],[578.0,5.0],[579.0,2.0],[580.0,3.227272727272727],[581.0,4.0],[582.0,3.0],[583.0,3.375],[585.0,2.952153110047847],[586.0,3.222560975609756],[587.0,3.5360623781676415],[588.0,3.805680119581465],[589.0,4.075182481751825],[590.0,3.9130434782608696],[592.0,3.655068078668684],[593.0,4.358173076923077],[594.0,3.7964824120603016],[595.0,3.949814126394052],[596.0,3.7868217054263567],[597.0,3.6728778467908905],[598.0,4.0],[599.0,4.036764705882353],[600.0,3.0],[601.0,3.0],[602.0,4.0],[603.0,3.0],[605.0,3.279279279279279],[606.0,2.18],[608.0,4.286535303776683],[609.0,2.888888888888889],[610.0,3.490566037735849],[611.0,2.4018691588785046],[612.0,2.1714285714285713],[613.0,3.526315789473684],[614.0,2.2],[615.0,4.0588235294117645],[616.0,3.1796875],[617.0,3.6363636363636362],[618.0,1.6666666666666667],[619.0,2.5217391304347827],[621.0,3.7],[623.0,2.0],[626.0,2.625],[627.0,3.6315789473684212],[628.0,3.8201754385964914],[630.0,3.5],[631.0,2.0],[632.0,4.333333333333333],[633.0,3.3636363636363638],[634.0,1.6666666666666667],[635.0,3.5675675675675675],[637.0,2.657142857142857],[638.0,3.0],[639.0,2.5185185185185186],[640.0,2.625],[641.0,1.0],[642.0,2.0],[643.0,2.0],[644.0,2.0],[645.0,3.769230769230769],[647.0,3.5120772946859904],[648.0,3.4242068155111633],[649.0,4.428571428571429],[650.0,3.225],[651.0,2.0],[652.0,2.5],[653.0,3.2053872053872055],[655.0,1.0],[656.0,2.4761904761904763],[657.0,3.0],[658.0,3.0],[659.0,3.8461538461538463],[660.0,2.0],[661.0,3.447619047619048],[662.0,2.7666666666666666],[663.0,3.5970149253731343],[664.0,3.0],[665.0,3.6315789473684212],[666.0,2.5],[667.0,1.9523809523809523],[668.0,4.3478260869565215],[669.0,4.3076923076923075],[670.0,4.166666666666667],[671.0,3.836206896551724],[672.0,2.0],[673.0,2.6464285714285714],[674.0,2.9152542372881354],[678.0,4.2517006802721085],[680.0,3.3157894736842106],[681.0,3.875],[682.0,3.3333333333333335],[684.0,1.0],[685.0,3.2222222222222223],[687.0,3.0],[688.0,2.2777777777777777],[690.0,1.0],[691.0,3.05],[692.0,1.9807692307692308],[694.0,2.6956521739130435],[695.0,3.227272727272727],[696.0,3.3333333333333335],[697.0,2.6153846153846154],[698.0,2.0],[700.0,3.364864864864865],[702.0,3.4],[703.0,1.6666666666666667],[704.0,2.185185185185185],[705.0,3.6842105263157894],[706.0,2.5],[707.0,2.96875],[708.0,3.4123076923076923],[709.0,3.0246913580246915],[710.0,2.4166666666666665],[711.0,2.4583333333333335],[712.0,4.0],[714.0,3.8219178082191783],[715.0,3.6666666666666665],[716.0,2.5],[717.0,4.0],[718.0,3.1875],[719.0,2.878260869565217],[720.0,4.465346534653466],[722.0,3.727272727272727],[724.0,3.0726256983240225],[725.0,2.9069767441860463],[726.0,2.8],[728.0,3.792079207920792],[729.0,3.6666666666666665],[730.0,1.0],[731.0,2.588235294117647],[732.0,3.0],[733.0,3.720062208398134],[734.0,3.0],[735.0,3.5961538461538463],[736.0,3.1596806387225547],[737.0,1.9393939393939394],[741.0,4.1017964071856285],[742.0,2.4050632911392404],[743.0,2.46875],[744.0,3.0],[745.0,4.490566037735849],[746.0,3.909090909090909],[747.0,2.1818181818181817],[748.0,3.2222222222222223],[749.0,3.0],[750.0,4.45468509984639],[751.0,3.5],[753.0,3.130434782608696],[754.0,2.875],[755.0,3.75],[756.0,2.6666666666666665],[757.0,4.0],[758.0,4.0],[759.0,4.296296296296297],[760.0,3.3333333333333335],[761.0,2.7419354838709675],[762.0,2.0719424460431655],[764.0,3.261904761904762],[765.0,2.5833333333333335],[766.0,3.609375],[767.0,3.2857142857142856],[769.0,3.6666666666666665],[771.0,3.3333333333333335],[774.0,4.0],[775.0,3.5],[776.0,3.0],[778.0,3.9651162790697674],[779.0,2.6206896551724137],[780.0,3.4687898089171973],[781.0,3.2888888888888888],[782.0,2.532258064516129],[783.0,3.2044444444444444],[784.0,2.7010869565217392],[785.0,3.4646464646464645],[786.0,3.1145374449339207],[787.0,5.0],[788.0,2.9889380530973453],[789.0,3.0],[790.0,3.0],[792.0,4.0],[793.0,2.0],[796.0,3.0],[798.0,2.6153846153846154],[799.0,3.3920454545454546],[800.0,4.107142857142857],[801.0,3.1641791044776117],[802.0,3.447004608294931],[803.0,3.6923076923076925],[804.0,2.972972972972973],[805.0,3.5217391304347827],[806.0,3.103448275862069],[807.0,3.0],[808.0,3.347826086956522],[809.0,2.4814814814814814],[810.0,1.373134328358209],[811.0,3.8],[813.0,2.64],[814.0,3.0],[815.0,2.3333333333333335],[818.0,2.5047619047619047],[821.0,3.0],[823.0,3.5],[824.0,4.428571428571429],[826.0,1.0],[828.0,3.096774193548387],[829.0,2.378787878787879],[830.0,2.907142857142857],[831.0,3.7],[832.0,3.4323308270676693],[833.0,2.130434782608696],[834.0,2.0],[835.0,3.1714285714285713],[836.0,2.575],[837.0,3.4157303370786516],[838.0,3.810126582278481],[839.0,2.2711864406779663],[840.0,2.6538461538461537],[841.0,3.3636363636363638],[842.0,2.779220779220779],[844.0,4.0],[846.0,3.8095238095238093],[847.0,1.0],[848.0,3.359375],[849.0,2.5105485232067513],[850.0,3.466666666666667],[851.0,3.4464285714285716],[852.0,3.168918918918919],[853.0,5.0],[854.0,5.0],[858.0,4.512893982808023],[859.0,2.0],[860.0,3.4],[861.0,3.4965034965034967],[862.0,3.8333333333333335],[863.0,3.5],[864.0,3.75],[865.0,2.0],[866.0,3.8541666666666665],[867.0,2.3333333333333335],[869.0,3.1578947368421053],[870.0,2.2222222222222223],[874.0,3.0],[875.0,3.392857142857143],[876.0,3.0],[877.0,3.2857142857142856],[879.0,2.860869565217391],[880.0,2.1907894736842106],[881.0,2.7435897435897436],[882.0,2.5806451612903225],[884.0,3.0],[885.0,2.7],[886.0,2.8],[887.0,1.0],[888.0,2.1578947368421053],[891.0,2.234782608695652],[892.0,3.7534246575342465],[893.0,3.5945945945945947],[895.0,1.0],[896.0,3.2758620689655173],[897.0,3.630434782608696],[898.0,4.273381294964029],[899.0,4.325842696629214],[900.0,3.7674418604651163],[901.0,3.6904761904761907],[902.0,3.852760736196319],[903.0,4.293706293706293],[904.0,4.457256461232604],[905.0,4.247368421052632],[906.0,4.178217821782178],[907.0,3.8958333333333335],[908.0,4.394285714285714],[909.0,4.091787439613527],[910.0,4.2592592592592595],[911.0,4.133333333333334],[912.0,4.375],[913.0,4.388655462184874],[914.0,4.156050955414012],[915.0,3.9878048780487805],[916.0,4.174757281553398],[917.0,3.84375],[918.0,3.7717391304347827],[919.0,4.268053855569155],[920.0,4.053763440860215],[921.0,3.8455882352941178],[922.0,4.506550218340611],[923.0,4.379506641366224],[924.0,4.07521578298397],[925.0,3.25],[926.0,4.248618784530387],[927.0,3.9],[928.0,4.180851063829787],[929.0,3.730769230769231],[930.0,4.315068493150685],[931.0,3.8333333333333335],[932.0,3.923076923076923],[933.0,4.058558558558558],[934.0,3.622047244094488],[935.0,3.8],[936.0,4.057971014492754],[937.0,3.789473684210526],[938.0,3.688888888888889],[939.0,3.2],[940.0,3.8536585365853657],[941.0,3.595744680851064],[942.0,4.214285714285714],[943.0,4.04],[944.0,4.0],[945.0,4.183206106870229],[946.0,3.9452054794520546],[947.0,4.078651685393258],[948.0,3.6785714285714284],[949.0,3.923076923076923],[950.0,4.2631578947368425],[951.0,4.286384976525822],[952.0,3.591304347826087],[953.0,4.294460641399417],[954.0,4.251461988304094],[955.0,4.119791666666667],[956.0,3.611111111111111],[957.0,3.4444444444444446],[958.0,3.625],[959.0,3.689655172413793],[960.0,3.888888888888889],[961.0,3.6363636363636362],[962.0,3.8333333333333335],[963.0,3.8461538461538463],[964.0,3.3181818181818183],[965.0,4.016666666666667],[966.0,4.333333333333333],[967.0,3.4],[968.0,3.647727272727273],[969.0,4.209876543209877],[970.0,3.1875],[971.0,4.046511627906977],[972.0,3.0],[973.0,3.892857142857143],[974.0,3.75],[976.0,3.576923076923077],[977.0,2.0],[978.0,3.8541666666666665],[980.0,2.75],[982.0,3.5],[984.0,2.7333333333333334],[985.0,2.0],[986.0,3.536363636363636],[987.0,2.9047619047619047],[988.0,3.4545454545454546],[989.0,5.0],[990.0,2.4782608695652173],[991.0,3.5833333333333335],[992.0,2.3333333333333335],[993.0,2.857142857142857],[994.0,4.044897959183674],[996.0,2.893939393939394],[997.0,3.230769230769231],[998.0,2.9148936170212765],[999.0,3.2735042735042734],[1000.0,3.3333333333333335],[1002.0,4.666666666666667],[1003.0,2.903225806451613],[1004.0,2.522727272727273],[1005.0,2.2465753424657535],[1006.0,3.0],[1007.0,3.018018018018018],[1008.0,3.340909090909091],[1009.0,3.1777777777777776],[1010.0,3.2195121951219514],[1011.0,2.7],[1012.0,3.6780821917808217],[1013.0,3.576],[1014.0,3.485294117647059],[1015.0,3.314516129032258],[1016.0,3.2289156626506026],[1017.0,3.6357142857142857],[1018.0,3.1538461538461537],[1019.0,3.7263157894736842],[1020.0,3.18974358974359],[1021.0,2.763157894736842],[1022.0,3.7804054054054053],[1023.0,3.9411764705882355],[1024.0,3.25],[1025.0,3.639751552795031],[1026.0,3.75],[1027.0,3.10062893081761],[1028.0,3.8632286995515694],[1029.0,3.632107023411371],[1030.0,3.065359477124183],[1031.0,3.4615384615384617],[1032.0,3.6666666666666665],[1033.0,3.4285714285714284],[1034.0,3.597560975609756],[1035.0,3.8780036968576708],[1036.0,4.124678663239075],[1037.0,2.5916955017301038],[1038.0,3.142857142857143],[1039.0,4.0],[1040.0,2.3333333333333335],[1041.0,4.059055118110236],[1042.0,3.536842105263158],[1043.0,2.760869565217391],[1044.0,3.2666666666666666],[1046.0,4.065217391304348],[1047.0,3.4380952380952383],[1049.0,3.3348837209302324],[1050.0,3.987012987012987],[1051.0,3.576923076923077],[1053.0,2.8125],[1054.0,3.395348837209302],[1055.0,2.75],[1056.0,3.4583333333333335],[1057.0,3.586206896551724],[1058.0,3.4285714285714284],[1059.0,3.3771186440677967],[1060.0,3.9193954659949624],[1061.0,3.5083798882681565],[1062.0,2.5],[1063.0,3.125],[1064.0,2.873873873873874],[1066.0,4.168539325842697],[1067.0,3.6],[1068.0,3.7333333333333334],[1069.0,3.8823529411764706],[1071.0,2.0],[1073.0,3.8828125],[1076.0,3.909090909090909],[1077.0,3.8984126984126983],[1078.0,3.8109756097560976],[1079.0,3.9591503267973858],[1080.0,4.028436018957346],[1081.0,3.5235602094240837],[1082.0,3.8378378378378377],[1083.0,3.5180722891566263],[1084.0,4.1017964071856285],[1085.0,3.6724137931034484],[1086.0,4.11864406779661],[1087.0,3.7142857142857144],[1088.0,3.29595015576324],[1089.0,4.157545605306799],[1090.0,4.057971014492754],[1091.0,2.7934782608695654],[1092.0,3.4782608695652173],[1093.0,3.385113268608414],[1094.0,3.775474956822107],[1095.0,3.8892857142857142],[1096.0,3.9352941176470586],[1097.0,3.989833641404806],[1098.0,2.3333333333333335],[1099.0,4.0],[1100.0,2.8],[1101.0,3.6767241379310347]],"aggSchema":[{"name":"movieId","type":"\"integer\""},{"name":"rating","type":"\"double\""}],"aggOverflow":true,"aggSeriesLimitReached":false,"aggError":"","aggType":"scalar","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"startTime":1.464838286518E12,"submitTime":1.464838083275E12,"finishTime":1.464838290185E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["movieId"],"yColumns":["rating"],"pivotColumns":[],"pivotAggregation":"avg","customPlotOptions":{"barChart":[{"key":"grouped","value":false},{"key":"stacked","value":true},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"600d62db-f17b-47e1-8ac5-bec8e08cd250"},{"version":"CommandV1","origId":127475,"guid":"70f9ed21-1397-4c60-af79-332e7e020ba2","subtype":"command","commandType":"auto","position":1.8273608684539795,"command":"%md\nHere we simply check the size of the datasets we are using","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"15a76166-8efd-4af8-aabb-6673ebc58686"},{"version":"CommandV1","origId":123776,"guid":"9705a2b7-fd09-4f35-a321-5957bc802b53","subtype":"command","commandType":"auto","position":1.827362060546875,"command":"val numRatings = ratingsRDD.count\nval numUsers = ratingsRDD.map(_.user).distinct.count\nval numMovies = ratingsRDD.map(_.product).distinct.count\n\nprintln(\"Got \" + numRatings + \" ratings from \"\n        + numUsers + \" users on \" + numMovies + \" movies.\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Got 487650 ratings from 2999 users on 3615 movies.\nnumRatings: Long = 487650\nnumUsers: Long = 2999\nnumMovies: Long = 3615\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:49: error: value _2 is not a member of org.apache.spark.mllib.recommendation.Rating\n              val numUsers = ratingsRDD.map(_._2.user).distinct.count\n                                              ^\n&lt;console&gt;:50: error: value _2 is not a member of org.apache.spark.mllib.recommendation.Rating\n              val numMovies = ratingsRDD.map(_._2.product).distinct.count\n                                               ^\n</div>","error":null,"startTime":1.464835736427E12,"submitTime":1.464835526696E12,"finishTime":1.464835740139E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f16d194e-4ca3-4ef2-83db-a05c5cec78c2"},{"version":"CommandV1","origId":123777,"guid":"237053a7-5a28-47e1-aa3c-5184e3bf69bd","subtype":"command","commandType":"auto","position":1.8273773193359375,"command":"%md\nNow that we have the dataset we need, let's make a recommender system.\n\n**Creating a Training Set, test Set and Validation Set**\n\nBefore we jump into using machine learning, we need to break up the `ratingsRDD` dataset into three pieces:\n* A training set (RDD), which we will use to train models\n* A validation set (RDD), which we will use to choose the best model\n* A test set (RDD), which we will use for our experiments\nTo randomly split the dataset into the multiple groups, we can use the `randomSplit()` transformation. `randomSplit()` takes a set of splits and seed and returns multiple RDDs.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835526723E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"686122b6-9651-4e1b-ac9c-af62a2fc6274"},{"version":"CommandV1","origId":123778,"guid":"b84ecce5-b8ee-4eb4-8876-aafc18c499cf","subtype":"command","commandType":"auto","position":1.8273849487304688,"command":"val Array(trainingRDD, validationRDD, testRDD) = ratingsRDD.randomSplit(Array(0.60, 0.20, 0.20), 0L)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">trainingRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[13857] at randomSplit at &lt;console&gt;:57\nvalidationRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[13858] at randomSplit at &lt;console&gt;:57\ntestRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[13859] at randomSplit at &lt;console&gt;:57\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:32: error: not found: value ratingsRDD\n       val Array(trainingRDD, validationRDD, testRDD) = ratingsRDD.randomSplit(Array(0.60, 0.20, 0.20), 0L)\n                                                        ^\n&lt;console&gt;:32: error: recursive value x$1 needs type\n       val Array(trainingRDD, validationRDD, testRDD) = ratingsRDD.randomSplit(Array(0.60, 0.20, 0.20), 0L)\n                 ^\n</div>","error":null,"startTime":1.464845362098E12,"submitTime":1.464845158712E12,"finishTime":1.464845362283E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"34d96308-5ad5-4d16-b495-7e7919ae8529"},{"version":"CommandV1","origId":123779,"guid":"e6c1598a-d024-4184-89af-e3efef85bef4","subtype":"command","commandType":"auto","position":1.8273868560791016,"command":"%md\nAfter splitting the dataset, your training set has about 293,000 entries and the validation and test sets each have about 97,000 entries (the exact number of entries in each dataset varies slightly due to the random nature of the `randomSplit()` transformation.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835526864E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"54582b97-ab19-401e-8b34-4b9458b36603"},{"version":"CommandV1","origId":123780,"guid":"36ab3ce1-9d08-4ff0-b422-a241539a1e29","subtype":"command","commandType":"auto","position":1.8273887634277344,"command":"// let's find the exact sizes we have next\nprintln(\" training data size = \" + trainingRDD.count() +\n        \", validation data size = \" + validationRDD.count() +\n        \", test data size = \" + testRDD.count() + \".\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"> training data size = 291854, validation data size = 97914, test data size = 97882.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:35: error: not found: value trainingRDD\n              println(&quot; training data size = &quot; + trainingRDD.count() +\n                                                 ^\n</div>","error":null,"startTime":1.464845365751E12,"submitTime":1.464845162341E12,"finishTime":1.464845369409E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ab1f1902-fbbc-4be8-ad2c-6a4c9310ad3c"},{"version":"CommandV1","origId":123781,"guid":"7d0ab253-8ae4-4177-b845-7eef234392e6","subtype":"command","commandType":"auto","position":1.8273906707763672,"command":"%md\nSee [http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.recommendation.ALS](http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.recommendation.ALS).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464843932681E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"57c22e45-166d-401c-b45c-2aa7ff19dd42"},{"version":"CommandV1","origId":123782,"guid":"0f106f63-bcfa-4244-9fec-dc619e8d880a","subtype":"command","commandType":"auto","position":1.8273911476135254,"command":"%md\n**(2c) Using ALS.train()**\n \nIn this part, we will use the MLlib implementation of Alternating Least Squares, [ALS.train()](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.recommendation.ALS). ALS takes a training dataset (RDD) and several parameters that control the model creation process. To determine the best values for the parameters, we will use ALS to train several models, and then we will select the best model and use the parameters from that model in the rest of this lab exercise.\n \nThe process we will use for determining the best model is as follows:\n* Pick a set of model parameters. The most important parameter to `ALS.train()` is the *rank*, which is the number of rows in the Users matrix (green in the diagram above) or the number of columns in the Movies matrix (blue in the diagram above). (In general, a lower rank will mean higher error on the training dataset, but a high rank may lead to [overfitting](https://en.wikipedia.org/wiki/Overfitting).)  We will train models with ranks of 4, 8, and 12 using the `trainingRDD` dataset.\n* Create a model using `ALS.train(trainingRDD, rank, seed=seed, iterations=iterations, lambda_=regularizationParameter)` with three parameters: an RDD consisting of tuples of the form (UserID, MovieID, rating) used to train the model, an integer rank (4, 8, or 12), a number of iterations to execute (we will use 5 for the `iterations` parameter), and a regularization coefficient (we will use 0.1 for the `regularizationParameter`).\n* For the prediction step, create an input RDD, `validationForPredictRDD`, consisting of (UserID, MovieID) pairs that you extract from `validationRDD`. You will end up with an RDD of the form: `[(1, 1287), (1, 594), (1, 1270)]`\n* Using the model and `validationForPredictRDD`, we can predict rating values by calling [model.predictAll()](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.recommendation.MatrixFactorizationModel.predictAll) with the `validationForPredictRDD` dataset, where `model` is the model we generated with ALS.train().  `predictAll` accepts an RDD with each entry in the format (userID, movieID) and outputs an RDD with each entry in the format (userID, movieID, rating).\n\n \n\n \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835527037E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ea71c6d8-f7bc-4755-80b8-0eef96f0a72f"},{"version":"CommandV1","origId":123783,"guid":"4f40ca30-b774-43ee-9b2e-db2af63d3869","subtype":"command","commandType":"auto","position":1.8273916244506836,"command":"// Build the recommendation model using ALS by fitting to the training data\n// using a fixed rank=10, numIterations=10 and regularisation=0.01\nval rank = 10\nval numIterations = 10\nval model = ALS.train(trainingRDD, rank, numIterations, 0.01)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rank: Int = 10\nnumIterations: Int = 10\nmodel: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@642c372c\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:46: error: type mismatch;\n found   : org.apache.spark.rdd.RDD[(Long, org.apache.spark.mllib.recommendation.Rating)]\n required: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating]\n       val model = ALS.train(ratingsRDD, rank, numIterations, 0.01)\n                             ^\n</div>","error":null,"startTime":1.464845384855E12,"submitTime":1.464845181464E12,"finishTime":1.464845389247E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"970d4fe3-1ca9-4696-9eb0-42b758ff707d"},{"version":"CommandV1","origId":123784,"guid":"60fc9660-db42-4a6f-bf69-c71030471173","subtype":"command","commandType":"auto","position":1.827392339706421,"command":"// Evaluate the model on test data\nval usersProductsTest = testRDD.map { case Rating(user, product, rate) =>\n  (user, product)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">usersProductsTest: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[14074] at map at &lt;console&gt;:50\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464845394042E12,"submitTime":1.464845190655E12,"finishTime":1.464845394144E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bf54794d-99a8-42b6-8d5b-9ef620c673bb"},{"version":"CommandV1","origId":123785,"guid":"e1ea1e7e-e10f-47b1-bdc7-55cfdd3e504a","subtype":"command","commandType":"auto","position":1.8273923993110657,"command":"usersProductsTest.take(10) // Checking","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res84: Array[(Int, Int)] = Array((1,1193), (1,3408), (1,1197), (1,1270), (1,527), (1,1097), (1,1721), (1,3186), (1,2762), (1,1))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464845396675E12,"submitTime":1.464845193294E12,"finishTime":1.464845397168E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1872eca9-9139-4391-95e6-2d565531d239"},{"version":"CommandV1","origId":123786,"guid":"522cc922-062f-4a56-a70a-af9276a42a84","subtype":"command","commandType":"auto","position":1.8273924589157104,"command":"// get the predictions on test data\nval predictions =\n  model.predict(usersProductsTest).map { case Rating(user, product, rate) =>\n    ((user, product), rate)\n  }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictions: org.apache.spark.rdd.RDD[((Int, Int), Double)] = MapPartitionsRDD[14086] at map at &lt;console&gt;:61\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464845406662E12,"submitTime":1.464845203263E12,"finishTime":1.464845408063E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d27cbf15-1fb3-4a5f-962d-4ca78b66a1b9"},{"version":"CommandV1","origId":123787,"guid":"47e1011b-e283-424c-87f2-bb2b660abea7","subtype":"command","commandType":"auto","position":1.8273924887180328,"command":"// find the actual ratings and join with predictions\nval ratesAndPreds = testRDD.map { case Rating(user, product, rate) =>\n  ((user, product), rate)\n}.join(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratesAndPreds: org.apache.spark.rdd.RDD[((Int, Int), (Double, Double))] = MapPartitionsRDD[14090] at join at &lt;console&gt;:64\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464845410566E12,"submitTime":1.464845207173E12,"finishTime":1.464845410695E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"480dbaa8-44af-4086-a9a2-2ffc8f6a4d67"},{"version":"CommandV1","origId":123788,"guid":"59f06e7c-b1bd-45b4-83e4-d868c0b7577f","subtype":"command","commandType":"auto","position":1.8273925185203552,"command":"ratesAndPreds.take(10).map(println) // print first 10 pairs of (user,product) and (true_rating, predicted_rating)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">((233,1265),(4.0,4.363702599597743))\n((1980,1132),(5.0,4.488675495492076))\n((319,342),(3.0,3.0952430400559283))\n((2457,3639),(4.0,3.923789983370526))\n((2500,1744),(4.0,3.959636137678639))\n((2109,3928),(2.0,3.509780026486319))\n((955,780),(4.0,3.452986085939768))\n((1244,1784),(2.0,3.95992775258794))\n((2526,951),(3.0,4.476918073583996))\n((1897,2511),(3.0,3.2093065701055585))\nres67: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464839666402E12,"submitTime":1.464839463208E12,"finishTime":1.464839668346E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f853fbc9-2fd6-4acd-819b-71a5ad3291c8"},{"version":"CommandV1","origId":123789,"guid":"b060119f-8528-42f2-b988-63db8f574817","subtype":"command","commandType":"auto","position":1.8273925483226776,"command":"%md\nLet's evaluate the model using Mean Squared Error metric.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835527568E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fd8d1504-fcb5-4a7e-a508-168038203b30"},{"version":"CommandV1","origId":123790,"guid":"5a0a2e99-2755-49ee-8c96-b3e5622b99b9","subtype":"command","commandType":"auto","position":1.8273925632238388,"command":"val MSE = ratesAndPreds.map { case ((user, product), (r1, r2)) =>\n  val err = (r1 - r2)\n  err * err\n}.mean()\nprintln(\"Mean Squared Error = \" + MSE)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Mean Squared Error = 0.9738201666622741\nMSE: Double = 0.9738201666622741\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.46484541538E12,"submitTime":1.464845211977E12,"finishTime":1.464845417663E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7c6eb0da-d9e3-4bb3-9848-c23038870468"},{"version":"CommandV1","origId":123791,"guid":"a174e7d4-8db1-4486-97ed-4142da509d1d","subtype":"command","commandType":"auto","position":1.8273925706744194,"command":"%md\nCan we improve the MSE by changing one of the hyper parameters?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835527703E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7fa486d6-692f-43e2-be42-fad5f0d07170"},{"version":"CommandV1","origId":123792,"guid":"4d85af3e-cf02-4cab-a17f-c47808357612","subtype":"command","commandType":"auto","position":1.8273925743997097,"command":"// Build the recommendation model using ALS by fitting to the validation data\n// just trying three different hyper-parameter (rank) values to optimise over\nval ranks = List(4, 8, 12); \nvar rank=0;\nfor ( rank <- ranks ){\n  val numIterations = 10\n  val regularizationParameter = 0.01\n  val model = ALS.train(trainingRDD, rank, numIterations, regularizationParameter)\n\n  // Evaluate the model on test data\n  val usersProductsValidate = validationRDD.map { case Rating(user, product, rate) =>\n                                              (user, product)\n  }\n\n  // get the predictions on test data\n  val predictions = model.predict(usersProductsValidate)\n                         .map { case Rating(user, product, rate)\n                                     => ((user, product), rate)\n    }\n\n  // find the actual ratings and join with predictions\n  val ratesAndPreds = validationRDD.map { case Rating(user, product, rate) \n                                     => ((user, product), rate)\n                                   }.join(predictions)\n  \n\n  val MSE = ratesAndPreds.map { case ((user, product), (r1, r2)) =>\n    val err = (r1 - r2)\n    err * err\n  }.mean()\n  \n  println(\"rank and Mean Squared Error = \" +  rank + \" and \" + MSE)\n} // end of loop over ranks","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rank and Mean Squared Error = 4 and 0.8329327350161514\nrank and Mean Squared Error = 8 and 0.9224918299123507\nrank and Mean Squared Error = 12 and 0.9982805377824524\nranks: List[Int] = List(4, 8, 12)\nrank: Int = 0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:104: error: value MSE is not a member of String\n                println(&quot;rank and Mean Squared Error = &quot; + + rank + &quot; and &quot; MSE)\n                                                                            ^\n</div>","error":null,"startTime":1.464845426764E12,"submitTime":1.464845223354E12,"finishTime":1.464845459498E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b26274a3-0b77-4a05-8078-a756a8573b5e"},{"version":"CommandV1","origId":123793,"guid":"dbed1884-1903-4726-9a47-a4c36dc3501b","subtype":"command","commandType":"auto","position":1.8273925753310323,"command":"%md\nNow let us try to apply this to the test data and find the MSE for the best model.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835527848E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e15be1ad-2e6c-482b-8c15-e42ade7f0138"},{"version":"CommandV1","origId":123794,"guid":"976224dd-4ee8-4dc3-a1f7-0dcf7641f89b","subtype":"command","commandType":"auto","position":1.8273925757966936,"command":"  val rank = 4\n  val numIterations = 10\n  val regularizationParameter = 0.01\n  val model = ALS.train(trainingRDD, rank, numIterations, regularizationParameter)\n\n  // Evaluate the model on test data\n  val usersProductsTest = testRDD.map { case Rating(user, product, rate) =>\n                                              (user, product)\n  }\n\n  // get the predictions on test data\n  val predictions = model.predict(usersProductsTest)\n                         .map { case Rating(user, product, rate)\n                                     => ((user, product), rate)\n    }\n\n  // find the actual ratings and join with predictions\n  val ratesAndPreds = testRDD.map { case Rating(user, product, rate) \n                                     => ((user, product), rate)\n                                   }.join(predictions)\n\n  val MSE = ratesAndPreds.map { case ((user, product), (r1, r2)) =>\n    val err = (r1 - r2)\n    err * err\n  }.mean()\n  \n  println(\"rank and Mean Squared Error for test data = \" +  rank + \" and \" + MSE)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rank and Mean Squared Error for test data = 4 and 0.8448731276242801\nrank: Int = 4\nnumIterations: Int = 10\nregularizationParameter: Double = 0.01\nmodel: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@44e0c325\nusersProductsTest: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[6838] at map at &lt;console&gt;:72\npredictions: org.apache.spark.rdd.RDD[((Int, Int), Double)] = MapPartitionsRDD[6852] at map at &lt;console&gt;:78\nratesAndPreds: org.apache.spark.rdd.RDD[((Int, Int), (Double, Double))] = MapPartitionsRDD[6856] at join at &lt;console&gt;:85\nMSE: Double = 0.8448731276242801\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464835774874E12,"submitTime":1.464835527941E12,"finishTime":1.464835785634E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b38ec000-d258-4cca-ab2a-004503fc8171"},{"version":"CommandV1","origId":123795,"guid":"41f62c86-8750-4363-9597-6557fbf4ac0e","subtype":"command","commandType":"auto","position":1.8273925768444315,"command":"%md\n** Potential flaws of CF **\n\n* Cold start for users and items\n* Synonym faults\n* Grey/Black sheep, individuality\n* Shilling\n* Positive feedback problems (rich-get-richer effect)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7a48447f-fc8e-4a2b-8fc4-6bfcbc2e6332"},{"version":"CommandV1","origId":123796,"guid":"3216ee11-d0c5-4d37-918f-1ded1f5cf714","subtype":"command","commandType":"auto","position":1.8273925773683004,"command":"%md\n** Areas to improve upon **\n\n* Works in theory but didn't manage to produce a system that takes user info and outputs suggestions\n* More complete models would include analysing the genres to give better recommendations.\n* For first time users, the program could give the top rated movies over all users.\n* Could have used bigger dataset","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6f6ba288-52b5-453d-9006-51af616310ef"},{"version":"CommandV1","origId":123797,"guid":"0915fd3d-758b-4dad-9b1d-bf2286d10c3f","subtype":"command","commandType":"auto","position":1.8273925778921694,"command":"%md\n---\n\n_End of Presentation_\n\n---","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835527966E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"90307050-cb07-47a6-86af-a1026ebde688"},{"version":"CommandV1","origId":123800,"guid":"c1b22f29-be37-4010-8276-967cbf74a330","subtype":"command","commandType":"auto","position":1.827392578125,"command":"%md\n## An Example for working with dataset that is downloaded from the internet...","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835528052E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ebc60eb0-43f0-463b-a3ab-ced1d9e905c0"},{"version":"CommandV1","origId":123801,"guid":"bd1c6f23-760b-4ceb-9134-1314b88e438e","subtype":"command","commandType":"auto","position":1.82763671875,"command":"%md\nThe following is adapted from [http://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#collaborative-filtering](http://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#collaborative-filtering).\n\nSee supplementary notebook 'loadMoviesData' for instructions on downloading the data on movie ratings and loading into dbfs.\n\nIn the following example we load rating data. Each row consists of a user, a product and a rating. We use the default ALS.train() method which assumes ratings are explicit. We evaluate the recommendation model by measuring the Mean Squared Error of rating prediction.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835528173E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4e610e58-49f6-4592-a753-d5e17e2acb0f"},{"version":"CommandV1","origId":123802,"guid":"9657a82e-0826-4d3c-89ae-49a5aeb2250d","subtype":"command","commandType":"auto","position":1.828125,"command":"import org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464835785638E12,"submitTime":1.464835528279E12,"finishTime":1.4648357857E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"83986b48-c82b-4e89-afae-3ed579036e3f"},{"version":"CommandV1","origId":123803,"guid":"7959abfa-cd5d-4814-81ba-60e662ea5b99","subtype":"command","commandType":"auto","position":1.8359375,"command":"// Load the data\nval ratingsText = sc.textFile(\"dbfs:/datasets/movies/ml-latest-small/ratings.csv\")\n\nval ratingsTextLarge = sc.textFile(\"dbfs:/datasets/movies/ml-10M100K/ratings.dat\")\n\nval moviesTextSmall = sc.textFile(\"dbfs:/datasets/movies/ml-latest-small/movies.csv\")\n\nval moviesTextLarge = sc.textFile(\"dbfs:/datasets/movies/ml-10M100K/movies.dat\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratingsText: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/movies/ml-latest-small/ratings.csv MapPartitionsRDD[11712] at textFile at &lt;console&gt;:50\nratingsTextLarge: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/movies/ml-10M100K/ratings.dat MapPartitionsRDD[11714] at textFile at &lt;console&gt;:52\nmoviesTextSmall: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/movies/ml-latest-small/movies.csv MapPartitionsRDD[11716] at textFile at &lt;console&gt;:54\nmoviesTextLarge: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/movies/ml-10M100K/movies.dat MapPartitionsRDD[11718] at textFile at &lt;console&gt;:56\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.464840299038E12,"submitTime":1.464840095849E12,"finishTime":1.464840299166E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0f097713-8957-49bf-be93-270378a48377"},{"version":"CommandV1","origId":123804,"guid":"d8fff1f0-5e04-4167-b7de-90f52a8fb7a7","subtype":"command","commandType":"auto","position":1.837890625,"command":"moviesTextLarge.take(10).map(println) // see first 10 lines","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1::Toy Story (1995)::Adventure|Animation|Children|Comedy|Fantasy\n2::Jumanji (1995)::Adventure|Children|Fantasy\n3::Grumpier Old Men (1995)::Comedy|Romance\n4::Waiting to Exhale (1995)::Comedy|Drama|Romance\n5::Father of the Bride Part II (1995)::Comedy\n6::Heat (1995)::Action|Crime|Thriller\n7::Sabrina (1995)::Comedy|Romance\n8::Tom and Huck (1995)::Adventure|Children\n9::Sudden Death (1995)::Action\n10::GoldenEye (1995)::Action|Adventure|Thriller\nres72: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.46484030367E12,"submitTime":1.464840100476E12,"finishTime":1.464840304574E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6251ee8f-cdb5-4e74-8e63-9bdb8b6fa5aa"},{"version":"CommandV1","origId":123805,"guid":"516e082b-75bb-488b-b86b-73d1d258a4da","subtype":"command","commandType":"auto","position":1.8388671875,"command":"%md\nLet's obtain a dataframe from this structured CSV file to quickly emplore the data.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835528434E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a4732a61-7329-44db-81d8-6e2f02787d4c"},{"version":"CommandV1","origId":123806,"guid":"dafae637-3dc6-4017-8a66-0dfbd5b83bc5","subtype":"command","commandType":"auto","position":1.83984375,"command":"val ratingsDF = sqlContext.read    \n    .format(\"com.databricks.spark.csv\") // use spark.csv package\n    .option(\"header\", \"true\") // Use first line of all files as header\n    .option(\"inferSchema\", \"true\") // Automatically infer data types\n    .option(\"delimiter\", \",\") // Specify the delimiter as comma or ',' DEFAULT\n    .load(\"dbfs:/datasets/movies/ml-latest-small/ratings.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratingsDF: org.apache.spark.sql.DataFrame = [userId: int, movieId: int, rating: double, timestamp: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"startTime":1.464840307464E12,"submitTime":1.46484010425E12,"finishTime":1.464840308922E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f00b7bfc-cf61-469b-9086-76058f24b0b9"},{"version":"CommandV1","origId":123807,"guid":"790f69a9-eae5-4d57-8d1e-b552cc3dba9f","subtype":"command","commandType":"auto","position":1.8408203125,"command":"ratingsDF.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res47: Array[org.apache.spark.sql.Row] = Array([1,16,4.0,1217897793], [1,24,1.5,1217895807], [1,32,4.0,1217896246], [1,47,4.0,1217896556], [1,50,4.0,1217896523], [1,110,4.0,1217896150], [1,150,3.0,1217895940], [1,161,4.0,1217897864], [1,165,3.0,1217897135], [1,204,0.5,1217895786])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.46483578714E12,"submitTime":1.464835528606E12,"finishTime":1.464835787396E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0891bf53-026e-457e-a2bc-d15133686380"},{"version":"CommandV1","origId":123808,"guid":"df31f87e-24e8-466c-9a49-ef7c0081eb5b","subtype":"command","commandType":"auto","position":1.841796875,"command":"display(ratingsDF) // play with the GUI plots to explore further...","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.0,16.0,4.0,1.217897793E9],[1.0,24.0,1.5,1.217895807E9],[1.0,32.0,4.0,1.217896246E9],[1.0,47.0,4.0,1.217896556E9],[1.0,50.0,4.0,1.217896523E9],[1.0,110.0,4.0,1.21789615E9],[1.0,150.0,3.0,1.21789594E9],[1.0,161.0,4.0,1.217897864E9],[1.0,165.0,3.0,1.217897135E9],[1.0,204.0,0.5,1.217895786E9],[1.0,223.0,4.0,1.217897795E9],[1.0,256.0,0.5,1.217895764E9],[1.0,260.0,4.5,1.217895864E9],[1.0,261.0,1.5,1.21789575E9],[1.0,277.0,0.5,1.217895772E9],[1.0,296.0,4.0,1.217896125E9],[1.0,318.0,4.0,1.21789586E9],[1.0,349.0,4.5,1.217897058E9],[1.0,356.0,3.0,1.217896231E9],[1.0,377.0,2.5,1.217896373E9],[1.0,380.0,3.0,1.21789603E9],[1.0,457.0,4.0,1.217896015E9],[1.0,480.0,3.5,1.217895972E9],[1.0,527.0,4.5,1.217896341E9],[1.0,589.0,3.5,1.217896078E9],[1.0,590.0,3.5,1.217896038E9],[1.0,592.0,2.5,1.217896043E9],[1.0,593.0,5.0,1.217895932E9],[1.0,597.0,3.0,1.217897176E9],[1.0,608.0,3.5,1.217896319E9],[1.0,648.0,3.5,1.217896397E9],[1.0,719.0,0.5,1.217895799E9],[1.0,724.0,3.5,1.217895794E9],[1.0,736.0,3.0,1.217896621E9],[1.0,780.0,3.5,1.217895969E9],[1.0,858.0,5.0,1.217896428E9],[1.0,912.0,5.0,1.217897623E9],[1.0,968.0,4.5,1.217897263E9],[1.0,1061.0,4.0,1.217895811E9],[1.0,1089.0,4.5,1.217897621E9],[1.0,1136.0,5.0,1.21789763E9],[1.0,1196.0,4.5,1.217896095E9],[1.0,1198.0,4.0,1.21789645E9],[1.0,1210.0,4.5,1.217895912E9],[1.0,1213.0,5.0,1.217897617E9],[1.0,1220.0,4.0,1.217897823E9],[1.0,1221.0,5.0,1.217897613E9],[1.0,1222.0,5.0,1.217897625E9],[1.0,1233.0,4.5,1.217897648E9],[1.0,1243.0,3.5,1.217897427E9],[1.0,1258.0,4.5,1.217897678E9],[1.0,1265.0,3.0,1.217897107E9],[1.0,1267.0,4.0,1.217895768E9],[1.0,1270.0,3.0,1.217897006E9],[1.0,1287.0,4.5,1.217897783E9],[1.0,1580.0,3.5,1.217896279E9],[1.0,1617.0,3.5,1.217896636E9],[1.0,1721.0,1.5,1.21789621E9],[1.0,1923.0,1.5,1.217897087E9],[1.0,1961.0,3.0,1.217897157E9],[1.0,2021.0,4.0,1.217895796E9],[1.0,2028.0,4.5,1.217896291E9],[1.0,2105.0,1.5,1.217895783E9],[1.0,2161.0,1.5,1.217895776E9],[1.0,2194.0,4.5,1.217897671E9],[1.0,2396.0,4.0,1.21789701E9],[1.0,2407.0,2.5,1.217895736E9],[1.0,2455.0,2.0,1.217895762E9],[1.0,2467.0,4.5,1.21789778E9],[1.0,2502.0,4.0,1.2178977E9],[1.0,2542.0,4.5,1.217897667E9],[1.0,2571.0,4.5,1.217895908E9],[1.0,2628.0,3.0,1.217896237E9],[1.0,2716.0,3.5,1.217896417E9],[1.0,2728.0,5.0,1.217897681E9],[1.0,2762.0,3.0,1.217896143E9],[1.0,2858.0,4.0,1.217896098E9],[1.0,2947.0,3.5,1.217895742E9],[1.0,2959.0,5.0,1.217896334E9],[1.0,3256.0,5.0,1.217895803E9],[1.0,3421.0,4.5,1.217895728E9],[1.0,3578.0,4.0,1.217896402E9],[1.0,4011.0,4.5,1.217897657E9],[1.0,4027.0,3.5,1.217897174E9],[1.0,4033.0,3.5,1.217897841E9],[1.0,4085.0,3.5,1.217897858E9],[1.0,4262.0,5.0,1.217897697E9],[1.0,4306.0,4.0,1.217895903E9],[1.0,4963.0,3.5,1.217896313E9],[1.0,4993.0,4.5,1.217895872E9],[1.0,4995.0,4.0,1.217896614E9],[1.0,5349.0,3.0,1.217896286E9],[1.0,5378.0,3.5,1.217897078E9],[1.0,5418.0,4.0,1.21789698E9],[1.0,5445.0,3.5,1.217895979E9],[1.0,5952.0,4.5,1.217896346E9],[1.0,6365.0,4.5,1.217896386E9],[1.0,6711.0,3.5,1.217896498E9],[1.0,6807.0,4.0,1.217897777E9],[1.0,7153.0,4.5,1.217896065E9],[1.0,8825.0,2.5,1.21789649E9],[1.0,8961.0,4.0,1.217896012E9],[1.0,32587.0,4.5,1.217896582E9],[1.0,33493.0,4.5,1.217896473E9],[1.0,33794.0,4.5,1.217896007E9],[1.0,33834.0,4.5,1.217897409E9],[1.0,45950.0,0.5,1.217897813E9],[1.0,48516.0,5.0,1.217896206E9],[1.0,48780.0,4.0,1.217897632E9],[1.0,49272.0,3.5,1.217896576E9],[1.0,52973.0,3.5,1.21789782E9],[1.0,54286.0,4.0,1.217896447E9],[1.0,57949.0,0.5,1.217896004E9],[2.0,1.0,5.0,8.59046895E8],[2.0,3.0,2.0,8.59046959E8],[2.0,5.0,3.0,8.59046959E8],[2.0,14.0,4.0,8.59047091E8],[2.0,17.0,5.0,8.59046896E8],[2.0,25.0,3.0,8.59046896E8],[2.0,32.0,3.0,8.59046895E8],[2.0,36.0,5.0,8.59046959E8],[2.0,52.0,4.0,8.59047004E8],[2.0,58.0,4.0,8.59047004E8],[2.0,62.0,5.0,8.59046896E8],[2.0,79.0,4.0,8.59047091E8],[2.0,95.0,4.0,8.59046895E8],[2.0,112.0,3.0,8.59047004E8],[2.0,260.0,4.0,8.59047004E8],[2.0,376.0,4.0,8.59047004E8],[2.0,494.0,4.0,8.59046959E8],[2.0,608.0,5.0,8.59046959E8],[2.0,637.0,3.0,8.59047091E8],[2.0,648.0,4.0,8.59046895E8],[2.0,661.0,4.0,8.59047091E8],[2.0,736.0,4.0,8.59046895E8],[2.0,780.0,4.0,8.59046895E8],[2.0,784.0,2.0,8.59047004E8],[2.0,788.0,4.0,8.59047004E8],[2.0,802.0,4.0,8.59047091E8],[2.0,805.0,5.0,8.59047091E8],[2.0,1073.0,4.0,8.59046959E8],[2.0,1356.0,4.0,8.59047091E8],[3.0,5.0,3.0,8.41483936E8],[3.0,7.0,3.0,8.41484087E8],[3.0,11.0,4.0,8.41483689E8],[3.0,21.0,5.0,8.4148362E8],[3.0,34.0,5.0,8.41483604E8],[3.0,36.0,4.0,8.41483842E8],[3.0,39.0,4.0,8.41483634E8],[3.0,45.0,5.0,8.41483936E8],[3.0,50.0,5.0,8.4148362E8],[3.0,105.0,3.0,8.41483842E8],[3.0,141.0,3.0,8.41483766E8],[3.0,144.0,4.0,8.41484203E8],[3.0,150.0,4.0,8.41483462E8],[3.0,165.0,3.0,8.41483481E8],[3.0,185.0,3.0,8.41483561E8],[3.0,222.0,5.0,8.4148395E8],[3.0,223.0,5.0,8.41483859E8],[3.0,232.0,4.0,8.41484075E8],[3.0,246.0,5.0,8.414839E8],[3.0,261.0,3.0,8.41483782E8],[3.0,272.0,5.0,8.41483888E8],[3.0,277.0,4.0,8.41483859E8],[3.0,281.0,3.0,8.41484049E8],[3.0,292.0,3.0,8.41483527E8],[3.0,296.0,5.0,8.41483462E8],[3.0,300.0,4.0,8.41483584E8],[3.0,339.0,3.0,8.41483545E8],[3.0,342.0,5.0,8.41483916E8],[3.0,345.0,5.0,8.41484049E8],[3.0,348.0,3.0,8.41484174E8],[3.0,349.0,3.0,8.41483481E8],[3.0,350.0,3.0,8.41483677E8],[3.0,356.0,3.0,8.41483545E8],[3.0,357.0,4.0,8.41483677E8],[3.0,367.0,4.0,8.41483604E8],[3.0,368.0,3.0,8.41483822E8],[3.0,373.0,3.0,8.4148422E8],[3.0,377.0,3.0,8.41483604E8],[3.0,380.0,3.0,8.41483463E8],[3.0,410.0,3.0,8.41483584E8],[3.0,417.0,4.0,8.41484158E8],[3.0,454.0,3.0,8.41483561E8],[3.0,457.0,4.0,8.41483501E8],[3.0,471.0,3.0,8.4148395E8],[3.0,477.0,4.0,8.41483987E8],[3.0,480.0,4.0,8.41483561E8],[3.0,485.0,3.0,8.41483859E8],[3.0,497.0,4.0,8.41483875E8],[3.0,500.0,4.0,8.4148362E8],[3.0,508.0,3.0,8.41483782E8],[3.0,509.0,5.0,8.41483708E8],[3.0,515.0,5.0,8.41483859E8],[3.0,527.0,4.0,8.41483658E8],[3.0,529.0,5.0,8.41483968E8],[3.0,532.0,3.0,8.41484049E8],[3.0,537.0,3.0,8.41484247E8],[3.0,538.0,4.0,8.41484316E8],[3.0,539.0,3.0,8.41483658E8],[3.0,586.0,4.0,8.41483634E8],[3.0,587.0,3.0,8.41483634E8],[3.0,588.0,3.0,8.41483481E8],[3.0,589.0,3.0,8.41483584E8],[3.0,590.0,4.0,8.41483461E8],[3.0,592.0,3.0,8.4148346E8],[3.0,593.0,5.0,8.41483501E8],[3.0,595.0,4.0,8.41483501E8],[3.0,597.0,3.0,8.41483634E8],[3.0,608.0,5.0,8.414839E8],[3.0,613.0,4.0,8.48052408E8],[3.0,648.0,4.0,8.41483842E8],[3.0,736.0,3.0,8.41483822E8],[3.0,800.0,5.0,8.41484158E8],[3.0,1161.0,4.0,8.48052408E8],[4.0,30.0,4.0,9.50322938E8],[4.0,32.0,5.0,9.5032375E8],[4.0,111.0,4.0,9.50323208E8],[4.0,154.0,4.0,9.50322965E8],[4.0,213.0,4.0,9.50323441E8],[4.0,296.0,4.0,9.50323526E8],[4.0,306.0,5.0,9.50323967E8],[4.0,307.0,5.0,9.50323407E8],[4.0,308.0,5.0,9.50323915E8],[4.0,318.0,4.0,9.50323355E8],[4.0,509.0,3.0,9.50323662E8],[4.0,527.0,4.0,9.50322655E8],[4.0,573.0,4.0,9.50323585E8],[4.0,593.0,4.0,9.50323141E8],[4.0,608.0,4.0,9.50323165E8],[4.0,858.0,5.0,9.50322891E8],[4.0,898.0,4.0,9.50323675E8],[4.0,899.0,5.0,9.50323707E8],[4.0,904.0,4.0,9.50323141E8],[4.0,905.0,5.0,9.50323027E8],[4.0,909.0,4.0,9.50323771E8],[4.0,910.0,5.0,9.50323049E8],[4.0,912.0,5.0,9.50323006E8],[4.0,913.0,5.0,9.50323285E8],[4.0,916.0,4.0,9.5032325E8],[4.0,919.0,5.0,9.50323407E8],[4.0,922.0,5.0,9.50324518E8],[4.0,928.0,4.0,9.50323087E8],[4.0,936.0,4.0,9.50323317E8],[4.0,937.0,5.0,9.50323355E8],[4.0,940.0,5.0,9.50323317E8],[4.0,943.0,4.0,9.50323729E8],[4.0,945.0,4.0,9.50322859E8],[4.0,946.0,4.0,9.50323285E8],[4.0,947.0,4.0,9.50323317E8],[4.0,951.0,5.0,9.50323638E8],[4.0,1085.0,5.0,9.50322829E8],[4.0,1094.0,4.0,9.50323087E8],[4.0,1176.0,4.0,9.50323355E8],[4.0,1185.0,4.0,9.50323796E8],[4.0,1186.0,3.0,9.50323662E8],[4.0,1196.0,4.0,9.50323441E8],[4.0,1203.0,5.0,9.50323355E8],[4.0,1204.0,5.0,9.50323087E8],[4.0,1207.0,5.0,9.50323481E8],[4.0,1209.0,4.0,9.50323513E8],[4.0,1219.0,3.0,9.50323141E8],[4.0,1224.0,4.0,9.50323707E8],[4.0,1225.0,5.0,9.50323165E8],[4.0,1230.0,4.0,9.50322729E8],[4.0,1233.0,5.0,9.50323006E8],[4.0,1244.0,4.0,9.50323141E8],[4.0,1247.0,4.0,9.50323707E8],[4.0,1250.0,5.0,9.50323208E8],[4.0,1252.0,4.0,9.50324518E8],[4.0,1254.0,5.0,9.50323285E8],[4.0,1256.0,5.0,9.5032325E8],[4.0,1267.0,3.0,9.50323049E8],[4.0,1276.0,5.0,9.50323585E8],[4.0,1277.0,4.0,9.50323407E8],[4.0,1281.0,5.0,9.50323231E8],[4.0,1283.0,4.0,9.50323285E8],[4.0,1284.0,4.0,9.50323441E8],[4.0,1296.0,4.0,9.50323208E8],[4.0,1333.0,3.0,9.50323707E8],[4.0,1358.0,4.0,9.50323638E8],[4.0,1392.0,4.0,9.50323796E8],[4.0,1412.0,4.0,9.50322891E8],[4.0,1446.0,4.0,9.50323407E8],[4.0,1511.0,3.0,9.50323662E8],[4.0,1617.0,4.0,9.50323208E8],[4.0,1633.0,5.0,9.50323796E8],[4.0,1719.0,5.0,9.50323208E8],[4.0,1732.0,2.0,9.50322729E8],[4.0,1734.0,4.0,9.50322859E8],[4.0,1931.0,4.0,9.50322965E8],[4.0,1936.0,5.0,9.50322914E8],[4.0,1944.0,3.0,9.50323231E8],[4.0,1945.0,4.0,9.50323141E8],[4.0,1948.0,4.0,9.50323708E8],[4.0,1949.0,5.0,9.50322829E8],[4.0,1997.0,5.0,9.50323481E8],[4.0,2019.0,4.0,9.5032458E8],[4.0,2132.0,5.0,9.50322914E8],[4.0,2160.0,4.0,9.50323553E8],[4.0,2186.0,4.0,9.50323609E8],[4.0,2212.0,4.0,9.50323441E8],[4.0,2301.0,3.0,9.50322729E8],[4.0,2324.0,5.0,9.50324206E8],[4.0,2622.0,4.0,9.50324262E8],[4.0,2629.0,4.0,9.50324357E8],[4.0,2671.0,4.0,9.50324319E8],[4.0,2683.0,1.0,9.50322729E8],[4.0,2687.0,5.0,9.50324262E8],[4.0,2690.0,4.0,9.50324319E8],[4.0,2692.0,4.0,9.50322914E8],[4.0,2713.0,2.0,9.50324357E8],[4.0,2723.0,2.0,9.50324335E8],[4.0,2724.0,3.0,9.50324319E8],[4.0,2725.0,5.0,9.50324287E8],[4.0,2728.0,5.0,9.50323165E8],[4.0,2739.0,5.0,9.50323796E8],[4.0,2759.0,3.0,9.50324319E8],[4.0,2761.0,4.0,9.50323355E8],[4.0,2763.0,4.0,9.50324319E8],[4.0,2770.0,4.0,9.50324262E8],[4.0,2828.0,2.0,9.5032437E8],[4.0,2848.0,4.0,9.50322965E8],[4.0,2871.0,3.0,9.50323553E8],[4.0,2874.0,4.0,9.50323317E8],[4.0,2935.0,4.0,9.50323006E8],[4.0,2948.0,3.0,9.50323317E8],[4.0,2951.0,3.0,9.50323609E8],[4.0,2969.0,4.0,9.50323585E8],[4.0,2987.0,5.0,9.50324532E8],[4.0,3035.0,5.0,9.50323729E8],[4.0,3088.0,5.0,9.50323638E8],[4.0,3095.0,5.0,9.50323441E8],[4.0,3114.0,5.0,9.50323407E8],[4.0,3122.0,5.0,9.5032443E8],[4.0,3196.0,5.0,9.50322859E8],[4.0,3260.0,4.0,9.50323481E8],[4.0,3271.0,3.0,9.50322729E8],[4.0,5060.0,5.0,9.50323407E8],[5.0,1.0,4.0,1.303501039E9],[5.0,63.0,3.0,1.303501454E9],[5.0,110.0,0.5,1.303501027E9],[5.0,170.0,2.0,1.303499098E9],[5.0,175.0,4.0,1.303499848E9],[5.0,231.0,0.5,1.303501088E9],[5.0,319.0,1.0,1.30349913E9],[5.0,344.0,1.0,1.303501063E9],[5.0,364.0,3.0,1.303501067E9],[5.0,480.0,3.0,1.303500063E9],[5.0,500.0,0.5,1.303501086E9],[5.0,588.0,3.5,1.303501048E9],[5.0,592.0,0.5,1.303501032E9],[5.0,595.0,4.0,1.303501072E9],[5.0,778.0,4.0,1.303499835E9],[5.0,1012.0,0.5,1.303499244E9],[5.0,1206.0,4.5,1.303499819E9],[5.0,1517.0,3.5,1.303501407E9],[5.0,1580.0,3.5,1.303501093E9],[5.0,1907.0,4.5,1.303500565E9],[5.0,2092.0,3.5,1.303499525E9],[5.0,2300.0,4.0,1.30349914E9],[5.0,2316.0,3.5,1.303499415E9],[5.0,2427.0,0.5,1.303499066E9],[5.0,2485.0,3.0,1.303500096E9],[5.0,2490.0,0.5,1.303499081E9],[5.0,2571.0,1.5,1.303501053E9],[5.0,2657.0,5.0,1.303499758E9],[5.0,2683.0,4.0,1.303501422E9],[5.0,2687.0,3.5,1.303500744E9],[5.0,2762.0,3.5,1.30350108E9],[5.0,2792.0,2.0,1.303499206E9],[5.0,2805.0,2.5,1.303499179E9],[5.0,2871.0,1.5,1.303499084E9],[5.0,2959.0,1.5,1.303501104E9],[5.0,3616.0,3.5,1.303500222E9],[5.0,3869.0,2.0,1.303499191E9],[5.0,4016.0,4.0,1.303500821E9],[5.0,4018.0,2.5,1.303500213E9],[5.0,4168.0,2.5,1.303500195E9],[5.0,4306.0,4.0,1.303500512E9],[5.0,4890.0,3.5,1.303499201E9],[5.0,5065.0,1.0,1.30349942E9],[5.0,5380.0,5.0,1.303500762E9],[5.0,5481.0,3.5,1.303501438E9],[5.0,6377.0,3.5,1.303501244E9],[5.0,7046.0,2.5,1.303499512E9],[5.0,7375.0,4.0,1.303500228E9],[5.0,8360.0,4.0,1.303500517E9],[5.0,32017.0,3.5,1.303500405E9],[5.0,33499.0,4.0,1.303500204E9],[5.0,43930.0,3.0,1.303500186E9],[5.0,44193.0,3.5,1.303500177E9],[5.0,45431.0,4.0,1.303500748E9],[5.0,46972.0,5.0,1.303500388E9],[5.0,52975.0,3.5,1.303500834E9],[5.0,54259.0,4.0,1.303499858E9],[5.0,56152.0,4.5,1.303499798E9],[5.0,59784.0,3.5,1.303500817E9],[5.0,60126.0,4.0,1.303501385E9],[5.0,63859.0,5.0,1.303499888E9],[5.0,67408.0,4.5,1.303500804E9],[5.0,68793.0,5.0,1.303500362E9],[5.0,68954.0,5.0,1.303499879E9],[5.0,71264.0,5.0,1.303500727E9],[5.0,72737.0,4.5,1.303500318E9],[5.0,78637.0,3.5,1.303500906E9],[5.0,81847.0,5.0,1.303500307E9],[6.0,480.0,3.5,1.34869377E9],[6.0,851.0,3.0,1.348693323E9],[6.0,1073.0,5.0,1.348693765E9],[6.0,1097.0,4.0,1.348693761E9],[6.0,1199.0,4.0,1.348693919E9],[6.0,1223.0,5.0,1.348693906E9],[6.0,1682.0,4.0,1.348881316E9],[6.0,1732.0,4.5,1.348693747E9],[6.0,1884.0,3.5,1.348881393E9],[6.0,1965.0,5.0,1.348692303E9],[6.0,2205.0,4.0,1.348693544E9],[6.0,2329.0,5.0,1.348693741E9],[6.0,2335.0,3.0,1.348692322E9],[6.0,2572.0,5.0,1.348693884E9],[6.0,2599.0,4.5,1.348693872E9],[6.0,2694.0,3.5,1.34869388E9],[6.0,2858.0,5.0,1.348693734E9],[6.0,2918.0,4.0,1.34869373E9],[6.0,2959.0,5.0,1.348881402E9],[6.0,3082.0,4.0,1.348693848E9],[6.0,3262.0,4.0,1.348693273E9],[6.0,3897.0,4.0,1.348693829E9],[6.0,4054.0,3.5,1.348693211E9],[6.0,4090.0,4.0,1.348693358E9],[6.0,4239.0,4.0,1.348881216E9],[6.0,4369.0,2.5,1.34869382E9],[6.0,4728.0,3.0,1.348693195E9],[6.0,4878.0,4.0,1.348693812E9],[6.0,4886.0,3.0,1.348881259E9],[6.0,4963.0,5.0,1.348693727E9],[6.0,5014.0,4.0,1.348693221E9],[6.0,5989.0,5.0,1.34869381E9],[6.0,6377.0,3.5,1.348881243E9],[6.0,6711.0,4.0,1.348881409E9],[6.0,6874.0,5.0,1.348881362E9],[6.0,7147.0,3.0,1.348881276E9],[6.0,7361.0,5.0,1.348881389E9],[6.0,7438.0,5.0,1.348881371E9],[6.0,8784.0,5.0,1.348881415E9],[6.0,30810.0,5.0,1.34869398E9],[6.0,33004.0,5.0,1.348692341E9],[6.0,41573.0,4.0,1.348693455E9],[6.0,42002.0,4.0,1.34869352E9],[6.0,44191.0,3.0,1.348881368E9],[6.0,44195.0,4.5,1.348693797E9],[6.0,45722.0,4.0,1.348693793E9],[6.0,46578.0,5.0,1.348881313E9],[6.0,46976.0,5.0,1.348881236E9],[6.0,48394.0,3.0,1.348881319E9],[6.0,49272.0,4.0,1.348693802E9],[6.0,55247.0,4.5,1.348694072E9],[6.0,55765.0,5.0,1.348693956E9],[6.0,56367.0,5.0,1.348693782E9],[6.0,60069.0,5.0,1.34869378E9],[6.0,66665.0,5.0,1.348693493E9],[6.0,68954.0,4.0,1.348881432E9],[6.0,69122.0,3.0,1.348693949E9],[6.0,72011.0,4.0,1.348881233E9],[6.0,76251.0,3.0,1.348693953E9],[6.0,78039.0,3.0,1.34869359E9],[6.0,94864.0,4.5,1.3486936E9],[7.0,10.0,4.0,1.32206297E9],[7.0,32.0,5.0,1.322058768E9],[7.0,47.0,5.0,1.322062854E9],[7.0,70.0,4.5,1.322063954E9],[7.0,145.0,4.0,1.322063997E9],[7.0,165.0,5.0,1.322062886E9],[7.0,196.0,2.0,1.322063845E9],[7.0,231.0,4.0,1.322062919E9],[7.0,260.0,5.0,1.322062772E9],[7.0,288.0,4.5,1.322063376E9],[7.0,293.0,4.0,1.32206338E9],[7.0,296.0,3.5,1.322062749E9],[7.0,316.0,4.0,1.322062901E9],[7.0,344.0,1.0,1.322062846E9],[7.0,356.0,5.0,1.322062754E9],[7.0,367.0,1.0,1.322062926E9],[7.0,377.0,3.5,1.322062833E9],[7.0,485.0,3.5,1.322063868E9],[7.0,527.0,2.5,1.32205852E9],[7.0,541.0,4.0,1.322063057E9],[7.0,546.0,2.5,1.322056604E9],[7.0,589.0,4.5,1.322065131E9],[7.0,593.0,5.0,1.322062756E9],[7.0,648.0,3.5,1.322062866E9],[7.0,673.0,2.5,1.322064247E9],[7.0,733.0,4.5,1.322062938E9],[7.0,741.0,3.5,1.322064829E9],[7.0,780.0,4.0,1.322062791E9],[7.0,858.0,3.5,1.32205841E9],[7.0,1036.0,5.0,1.322063044E9],[7.0,1080.0,5.0,1.322063494E9],[7.0,1089.0,3.0,1.322063354E9],[7.0,1127.0,3.0,1.322063602E9],[7.0,1136.0,5.0,1.322062989E9],[7.0,1196.0,5.0,1.322062818E9],[7.0,1198.0,5.0,1.322062825E9],[7.0,1200.0,5.0,1.322063112E9],[7.0,1206.0,3.0,1.322063399E9],[7.0,1208.0,5.0,1.322063434E9],[7.0,1210.0,5.0,1.322062796E9],[7.0,1214.0,5.0,1.322063041E9],[7.0,1221.0,3.5,1.322058496E9],[7.0,1222.0,5.0,1.322063479E9],[7.0,1240.0,5.0,1.322062949E9],[7.0,1258.0,4.0,1.322063438E9],[7.0,1291.0,4.0,1.322063022E9],[7.0,1320.0,4.5,1.322063861E9],[7.0,1370.0,4.0,1.322063701E9],[7.0,1391.0,5.0,1.322063573E9],[7.0,1407.0,5.0,1.322063575E9],[7.0,1517.0,4.5,1.322063408E9],[7.0,1527.0,4.0,1.322063097E9],[7.0,1580.0,4.0,1.322062909E9],[7.0,1610.0,4.5,1.322063464E9],[7.0,1676.0,5.0,1.32206372E9],[7.0,1687.0,4.5,1.322056646E9],[7.0,1690.0,5.0,1.322064119E9],[7.0,1722.0,4.0,1.322063974E9],[7.0,1732.0,3.5,1.322063537E9],[7.0,1747.0,4.0,1.32206414E9],[7.0,1862.0,2.0,1.322057079E9],[7.0,1954.0,0.5,1.322063818E9],[7.0,1991.0,3.5,1.322057039E9],[7.0,2028.0,5.0,1.322062892E9],[7.0,2115.0,4.5,1.322063485E9],[7.0,2161.0,3.5,1.322064222E9],[7.0,2167.0,5.0,1.322064033E9],[7.0,2288.0,3.5,1.322056537E9],[7.0,2329.0,5.0,1.322059284E9],[7.0,2353.0,4.0,1.322063748E9],[7.0,2467.0,4.0,1.322065026E9],[7.0,2470.0,3.0,1.322063962E9],[7.0,2571.0,5.0,1.322062812E9],[7.0,2617.0,2.5,1.322063594E9],[7.0,2628.0,2.5,1.322062956E9],[7.0,2672.0,2.5,1.322056727E9],[7.0,2683.0,5.0,1.322063125E9],[7.0,2692.0,4.0,1.322063635E9],[7.0,2699.0,1.5,1.322063766E9],[7.0,2700.0,5.0,1.322063566E9],[7.0,2701.0,3.0,1.322064052E9],[7.0,2710.0,3.0,1.322063503E9],[7.0,2712.0,1.5,1.322063732E9],[7.0,2788.0,4.5,1.322064874E9],[7.0,2807.0,4.0,1.32206271E9],[7.0,2890.0,4.0,1.322063987E9],[7.0,2916.0,3.0,1.3220635E9],[7.0,2959.0,5.0,1.322058885E9],[7.0,3033.0,4.0,1.32206406E9],[7.0,3052.0,4.5,1.322063644E9],[7.0,3081.0,4.0,1.322063927E9],[7.0,3176.0,4.0,1.322063881E9],[7.0,3253.0,3.5,1.322063936E9],[7.0,3275.0,5.0,1.322064676E9],[7.0,3441.0,3.5,1.322056817E9],[7.0,3527.0,3.0,1.322063895E9],[7.0,3623.0,2.5,1.322063609E9],[7.0,3793.0,4.0,1.322063109E9],[7.0,3977.0,3.5,1.322063618E9],[7.0,3994.0,3.5,1.322063915E9],[7.0,4011.0,5.0,1.322063716E9],[7.0,4306.0,3.0,1.322063006E9],[7.0,4343.0,1.5,1.32205669E9],[7.0,4370.0,2.5,1.322064206E9],[7.0,4387.0,4.0,1.322057289E9],[7.0,4553.0,3.5,1.322057354E9],[7.0,4878.0,4.0,1.322063664E9],[7.0,4963.0,4.5,1.322063469E9],[7.0,4993.0,3.0,1.322062944E9],[7.0,5349.0,3.0,1.322063461E9],[7.0,5378.0,2.5,1.322063672E9],[7.0,5418.0,4.0,1.322063582E9],[7.0,5608.0,2.5,1.322064898E9],[7.0,5669.0,4.0,1.322064028E9],[7.0,5903.0,5.0,1.322059187E9],[7.0,5952.0,3.0,1.322062979E9],[7.0,6333.0,4.5,1.322063795E9],[7.0,6365.0,3.0,1.322063681E9],[7.0,6502.0,2.5,1.322058802E9],[7.0,6539.0,2.5,1.322063427E9],[7.0,6794.0,0.5,1.322057726E9],[7.0,6807.0,4.5,1.322065097E9],[7.0,6874.0,2.5,1.322063539E9],[7.0,6934.0,3.0,1.322064177E9],[7.0,7153.0,3.0,1.322063087E9],[7.0,7438.0,2.5,1.322063647E9],[7.0,8636.0,2.0,1.322063803E9],[7.0,8874.0,2.0,1.322064664E9],[7.0,27611.0,4.5,1.322064733E9],[7.0,32587.0,5.0,1.322058836E9],[7.0,33493.0,3.0,1.322064189E9],[7.0,33794.0,3.5,1.322063693E9],[7.0,36529.0,1.5,1.322064926E9],[7.0,37380.0,3.5,1.32205761E9],[7.0,44191.0,4.0,1.322064165E9],[7.0,44665.0,5.0,1.322059087E9],[7.0,47610.0,4.0,1.322065169E9],[7.0,47997.0,4.5,1.322058863E9],[7.0,48394.0,2.0,1.322064702E9],[7.0,48774.0,2.5,1.322064811E9],[7.0,52281.0,3.5,1.322065088E9],[7.0,57532.0,1.5,1.322062605E9],[7.0,58559.0,5.0,1.32205894E9],[7.0,59315.0,2.0,1.322064752E9],[7.0,60126.0,4.5,1.322057527E9],[7.0,60161.0,3.5,1.322065251E9],[7.0,60684.0,3.5,1.322065045E9],[7.0,62956.0,3.0,1.322057926E9],[7.0,63113.0,4.0,1.322057024E9],[7.0,67255.0,3.5,1.322064635E9],[7.0,68157.0,2.0,1.32206458E9],[7.0,68791.0,3.5,1.322058563E9],[7.0,69122.0,3.5,1.322064996E9],[7.0,71535.0,2.0,1.322064722E9],[7.0,74458.0,3.5,1.322064784E9],[7.0,79008.0,4.0,1.32206462E9],[7.0,79132.0,2.0,1.322059458E9],[7.0,84152.0,3.5,1.322065007E9],[7.0,87232.0,2.0,1.322064955E9],[7.0,88744.0,2.0,1.322059122E9],[7.0,90603.0,3.5,1.322058685E9],[8.0,1.0,5.0,8.58610933E8],[8.0,3.0,4.0,8.5861101E8],[8.0,5.0,3.0,8.58611848E8],[8.0,25.0,5.0,8.58611295E8],[8.0,32.0,3.0,8.58610933E8],[8.0,36.0,5.0,8.5861224E8],[8.0,52.0,5.0,8.58611682E8],[8.0,58.0,3.0,8.586123E8],[8.0,62.0,4.0,8.58611351E8],[8.0,86.0,4.0,8.58611885E8],[8.0,95.0,3.0,8.58612404E8],[8.0,104.0,3.0,8.58611351E8],[8.0,107.0,3.0,8.58612128E8],[8.0,140.0,4.0,8.58612027E8],[8.0,141.0,3.0,8.58610933E8],[8.0,260.0,4.0,8.58611469E8],[8.0,376.0,3.0,8.58611495E8],[8.0,648.0,5.0,8.58610933E8],[8.0,673.0,3.0,8.5861119E8],[8.0,724.0,3.0,8.58611606E8],[8.0,726.0,5.0,8.58611682E8],[8.0,731.0,1.0,8.58612008E8],[8.0,733.0,3.0,8.5861147E8],[8.0,736.0,3.0,8.58610933E8],[8.0,766.0,5.0,8.58611946E8],[8.0,778.0,4.0,8.58612353E8],[8.0,780.0,4.0,8.58610933E8],[8.0,783.0,5.0,8.58611101E8],[8.0,785.0,2.0,8.58611351E8],[8.0,786.0,3.0,8.5861101E8],[8.0,788.0,5.0,8.58611351E8],[8.0,802.0,4.0,8.58611817E8],[8.0,804.0,4.0,8.58611659E8],[8.0,805.0,4.0,8.58611606E8],[8.0,808.0,4.0,8.5861147E8],[8.0,818.0,3.0,8.58611425E8],[8.0,832.0,3.0,8.58611351E8],[8.0,880.0,1.0,8.58612043E8],[8.0,991.0,5.0,8.58611971E8],[8.0,1042.0,5.0,8.58611101E8],[8.0,1047.0,4.0,8.58611797E8],[8.0,1057.0,3.0,8.58611425E8],[8.0,1059.0,4.0,8.58611295E8],[8.0,1061.0,4.0,8.58611915E8],[8.0,1073.0,5.0,8.58611351E8],[8.0,1120.0,5.0,8.58611295E8],[8.0,1183.0,1.0,8.58611295E8],[8.0,1210.0,5.0,8.58611101E8],[8.0,1353.0,2.0,8.58611946E8],[8.0,1357.0,3.0,8.58611295E8],[8.0,1358.0,5.0,8.58611425E8],[8.0,1393.0,5.0,8.58611295E8],[8.0,1407.0,5.0,8.58611351E8],[8.0,1409.0,3.0,8.58611797E8],[8.0,1410.0,5.0,8.58611559E8],[8.0,1414.0,3.0,8.58611425E8],[8.0,1416.0,4.0,8.58611295E8],[8.0,1471.0,5.0,8.58611143E8],[8.0,1476.0,5.0,8.58611101E8],[9.0,3.0,3.0,8.42687044E8],[9.0,6.0,4.0,8.426866E8],[9.0,10.0,3.0,8.42686329E8],[9.0,14.0,3.0,8.42687061E8],[9.0,16.0,4.0,8.42686699E8],[9.0,19.0,2.0,8.4268637E8],[9.0,21.0,3.0,8.42686387E8],[9.0,23.0,3.0,8.42686803E8],[9.0,25.0,4.0,8.42686567E8],[9.0,32.0,3.0,8.42686434E8],[9.0,47.0,3.0,8.42686351E8],[9.0,50.0,2.0,8.42686415E8],[9.0,52.0,2.0,8.4268708E8],[9.0,58.0,3.0,8.4268684E8],[9.0,95.0,3.0,8.42686534E8],[9.0,110.0,3.0,8.42686309E8],[9.0,122.0,2.0,8.42686821E8],[9.0,150.0,4.0,8.4268622E8],[9.0,153.0,3.0,8.42686249E8],[9.0,161.0,4.0,8.42686293E8],[9.0,163.0,3.0,8.42686649E8],[9.0,165.0,3.0,8.42686248E8],[9.0,172.0,3.0,8.42686583E8],[9.0,173.0,2.0,8.42686475E8],[9.0,185.0,2.0,8.42686329E8],[9.0,194.0,4.0,8.42687061E8],[9.0,195.0,1.0,8.4268708E8],[9.0,198.0,3.0,8.42686901E8],[9.0,204.0,2.0,8.42686515E8],[9.0,223.0,4.0,8.42686617E8],[9.0,227.0,2.0,8.42686664E8],[9.0,230.0,3.0,8.4268677E8],[9.0,231.0,4.0,8.42686269E8],[9.0,235.0,4.0,8.42686515E8],[9.0,246.0,3.0,8.4268672E8],[9.0,248.0,2.0,8.42686918E8],[9.0,253.0,3.0,8.42686329E8],[9.0,260.0,4.0,8.4268708E8],[9.0,267.0,1.0,8.4268701E8],[9.0,281.0,3.0,8.42686788E8],[9.0,288.0,4.0,8.42686329E8],[9.0,293.0,4.0,8.42686515E8],[9.0,296.0,5.0,8.42686221E8],[9.0,300.0,3.0,8.42686352E8],[9.0,305.0,2.0,8.42686859E8],[9.0,315.0,2.0,8.42686474E8],[9.0,316.0,3.0,8.42686269E8],[9.0,318.0,3.0,8.42686294E8],[9.0,319.0,3.0,8.42686788E8],[9.0,329.0,1.0,8.42686293E8],[9.0,333.0,3.0,8.4268655E8],[9.0,337.0,2.0,8.42686474E8],[9.0,344.0,2.0,8.42686248E8],[9.0,345.0,2.0,8.42686901E8],[9.0,348.0,3.0,8.42686664E8],[9.0,349.0,3.0,8.42686248E8],[9.0,350.0,2.0,8.42686455E8],[9.0,353.0,3.0,8.4268655E8],[9.0,355.0,2.0,8.42686633E8],[9.0,356.0,3.0,8.42686293E8],[9.0,357.0,3.0,8.42686455E8],[9.0,361.0,3.0,8.42687028E8],[9.0,367.0,3.0,8.4268637E8],[9.0,368.0,3.0,8.42686567E8],[9.0,370.0,2.0,8.42686617E8],[9.0,371.0,2.0,8.42686901E8],[9.0,372.0,2.0,8.42686803E8],[9.0,376.0,3.0,8.4268672E8],[9.0,377.0,3.0,8.4268637E8],[9.0,380.0,3.0,8.42686221E8],[9.0,410.0,2.0,8.42686352E8],[9.0,412.0,2.0,8.42686949E8],[9.0,415.0,2.0,8.42687044E8],[9.0,417.0,3.0,8.42686965E8],[9.0,419.0,2.0,8.42686918E8],[9.0,427.0,2.0,8.42686859E8],[9.0,431.0,3.0,8.4268675E8],[9.0,432.0,2.0,8.42686455E8],[9.0,434.0,3.0,8.42686293E8],[9.0,440.0,2.0,8.42686455E8],[9.0,442.0,3.0,8.42686491E8],[9.0,454.0,2.0,8.42686329E8],[9.0,455.0,1.0,8.42686859E8],[9.0,457.0,3.0,8.42686269E8],[9.0,466.0,2.0,8.42686678E8],[9.0,471.0,3.0,8.4268672E8],[9.0,474.0,3.0,8.42686474E8],[9.0,475.0,3.0,8.42686878E8],[9.0,477.0,2.0,8.42686878E8],[9.0,480.0,3.0,8.42686309E8],[9.0,481.0,3.0,8.42686965E8],[9.0,485.0,3.0,8.42686617E8],[9.0,489.0,2.0,8.42686949E8],[9.0,494.0,3.0,8.42686822E8],[9.0,497.0,4.0,8.42686633E8],[9.0,500.0,3.0,8.4268637E8],[9.0,508.0,3.0,8.42686534E8],[9.0,509.0,1.0,8.42686491E8],[9.0,514.0,2.0,8.42687044E8],[9.0,515.0,3.0,8.42686601E8],[9.0,519.0,1.0,8.42687044E8],[9.0,527.0,3.0,8.42686415E8],[9.0,532.0,3.0,8.42686788E8],[9.0,535.0,3.0,8.42686933E8],[9.0,537.0,2.0,8.4268698E8],[9.0,539.0,2.0,8.42686415E8],[9.0,540.0,2.0,8.42686878E8],[9.0,543.0,2.0,8.4268684E8],[9.0,555.0,4.0,8.42686633E8],[9.0,585.0,3.0,8.4268655E8],[9.0,586.0,2.0,8.42686387E8],[9.0,587.0,2.0,8.42686387E8],[9.0,589.0,4.0,8.42686351E8],[9.0,590.0,3.0,8.4268622E8],[9.0,592.0,3.0,8.42686219E8],[9.0,593.0,3.0,8.42686269E8],[9.0,597.0,1.0,8.42686387E8],[9.0,610.0,1.0,8.42686736E8],[9.0,648.0,3.0,8.42686567E8],[9.0,733.0,3.0,8.4268677E8],[9.0,784.0,3.0,8.42686965E8],[10.0,39.0,5.0,1.318896763E9],[10.0,180.0,2.5,1.318896428E9],[10.0,253.0,4.0,1.318896938E9],[10.0,327.0,2.5,1.318896461E9],[10.0,356.0,4.0,1.318897003E9],[10.0,480.0,2.0,1.318897016E9],[10.0,934.0,1.0,1.318896552E9],[10.0,1093.0,4.0,1.318896442E9],[10.0,1298.0,0.5,1.318896487E9],[10.0,1727.0,3.5,1.318896704E9],[10.0,2081.0,5.0,1.318896908E9],[10.0,2146.0,2.0,1.318896615E9],[10.0,2390.0,4.0,1.318896677E9],[10.0,2528.0,4.5,1.318896512E9],[10.0,2572.0,5.0,1.318896778E9],[10.0,2581.0,2.0,1.318896456E9],[10.0,3159.0,3.5,1.318896568E9],[10.0,3186.0,3.5,1.318896532E9],[10.0,3362.0,4.5,1.318896475E9],[10.0,4880.0,4.0,1.318896693E9],[10.0,7445.0,3.5,1.318896573E9],[10.0,7451.0,5.0,1.3188968E9],[10.0,81591.0,4.0,1.318896707E9],[11.0,1.0,4.0,8.5081581E8],[11.0,10.0,3.0,8.50816421E8],[11.0,17.0,3.0,8.50815856E8],[11.0,19.0,3.0,8.50816476E8],[11.0,34.0,3.0,8.50817622E8],[11.0,48.0,2.0,8.50816573E8],[11.0,107.0,2.0,8.50816521E8],[11.0,111.0,4.0,8.50816421E8],[11.0,150.0,4.0,8.50815571E8],[11.0,153.0,3.0,8.50816035E8],[11.0,154.0,3.0,8.50817332E8],[11.0,165.0,3.0,8.50817914E8],[11.0,260.0,5.0,8.50816371E8],[11.0,265.0,4.0,8.50816476E8],[11.0,292.0,4.0,8.50815663E8],[11.0,306.0,3.0,8.50817371E8],[11.0,316.0,4.0,8.50815615E8],[11.0,317.0,2.0,8.50816286E8],[11.0,329.0,5.0,8.50815615E8],[11.0,344.0,3.0,8.50815571E8],[11.0,349.0,4.0,8.50815614E8],[11.0,350.0,3.0,8.5081581E8],[11.0,357.0,2.0,8.50815769E8],[11.0,362.0,3.0,8.50816662E8],[11.0,364.0,3.0,8.50815719E8],[11.0,367.0,3.0,8.50815719E8],[11.0,368.0,3.0,8.50816371E8],[11.0,370.0,3.0,8.50816662E8],[11.0,377.0,3.0,8.50815719E8],[11.0,410.0,3.0,8.50817072E8],[11.0,420.0,2.0,8.5081581E8],[11.0,434.0,3.0,8.50815615E8],[11.0,454.0,3.0,8.50815663E8],[11.0,480.0,4.0,8.50815615E8],[11.0,500.0,3.0,8.50815719E8],[11.0,539.0,3.0,8.50815769E8],[11.0,541.0,4.0,8.50817145E8],[11.0,552.0,3.0,8.50816335E8],[11.0,568.0,3.0,8.5081756E8],[11.0,586.0,3.0,8.5081581E8],[11.0,587.0,5.0,8.50815719E8],[11.0,588.0,4.0,8.50816286E8],[11.0,589.0,3.0,8.50816207E8],[11.0,590.0,3.0,8.5081557E8],[11.0,592.0,3.0,8.50816035E8],[11.0,593.0,5.0,8.50815615E8],[11.0,594.0,4.0,8.50816335E8],[11.0,596.0,3.0,8.50816662E8],[11.0,597.0,4.0,8.50815719E8],[11.0,616.0,3.0,8.5081662E8],[11.0,661.0,3.0,8.50816695E8],[11.0,720.0,5.0,8.50816371E8],[11.0,745.0,5.0,8.50816476E8],[11.0,750.0,3.0,8.50817184E8],[11.0,788.0,2.0,8.50816573E8],[11.0,805.0,3.0,8.50816286E8],[11.0,903.0,3.0,8.50818019E8],[11.0,904.0,4.0,8.50817403E8],[11.0,908.0,4.0,8.50817461E8],[11.0,910.0,3.0,8.50817788E8],[11.0,912.0,3.0,8.50817114E8],[11.0,919.0,5.0,8.50817427E8],[11.0,924.0,5.0,8.50817184E8],[11.0,969.0,3.0,8.50817495E8],[11.0,1019.0,3.0,8.50817715E8],[11.0,1023.0,4.0,8.5081756E8],[11.0,1028.0,4.0,8.50817788E8],[11.0,1035.0,3.0,8.5081662E8],[11.0,1036.0,3.0,8.50816237E8],[11.0,1073.0,3.0,8.50816286E8],[11.0,1079.0,4.0,8.50816573E8],[11.0,1080.0,3.0,8.50817072E8],[11.0,1082.0,3.0,8.50817495E8],[11.0,1084.0,4.0,8.50816476E8],[11.0,1086.0,3.0,8.50817972E8],[11.0,1097.0,3.0,8.50816476E8],[11.0,1127.0,4.0,8.50817788E8],[11.0,1136.0,4.0,8.50817072E8],[11.0,1148.0,5.0,8.5081662E8],[11.0,1193.0,5.0,8.50817686E8],[11.0,1196.0,5.0,8.50817222E8],[11.0,1198.0,4.0,8.50817183E8],[11.0,1199.0,3.0,8.50817294E8],[11.0,1200.0,4.0,8.5081775E8],[11.0,1206.0,3.0,8.50817822E8],[11.0,1210.0,4.0,8.50817332E8],[11.0,1214.0,4.0,8.50817822E8],[11.0,1219.0,3.0,8.50818019E8],[11.0,1220.0,3.0,8.5081775E8],[11.0,1240.0,4.0,8.50817686E8],[11.0,1269.0,4.0,8.50817788E8],[11.0,1278.0,4.0,8.50817623E8],[11.0,1282.0,5.0,8.5081756E8],[11.0,1291.0,4.0,8.50817623E8],[11.0,1356.0,5.0,8.50816807E8],[11.0,1374.0,4.0,8.50817584E8],[11.0,5060.0,5.0,8.5081775E8],[12.0,3.0,3.0,1.144396293E9],[12.0,16.0,1.5,1.144396284E9],[12.0,235.0,3.0,1.144396288E9],[12.0,266.0,4.0,1.144396182E9],[12.0,350.0,1.0,1.144396206E9],[12.0,553.0,3.0,1.14439631E9],[12.0,594.0,4.5,1.144396233E9],[12.0,708.0,4.0,1.144396245E9],[12.0,750.0,2.5,1.144396215E9],[12.0,1080.0,4.0,1.1443963E9],[12.0,1101.0,4.0,1.144396239E9],[12.0,1208.0,1.0,1.1443962E9],[12.0,1225.0,1.0,1.144396198E9],[12.0,1258.0,2.5,1.144396306E9],[12.0,1917.0,2.0,1.144396196E9],[12.0,2012.0,4.0,1.144396262E9],[12.0,2174.0,4.0,1.144396267E9],[12.0,2710.0,4.0,1.144396281E9],[12.0,2797.0,4.0,1.144396274E9],[12.0,5952.0,4.0,1.144396227E9],[13.0,20.0,3.5,1.215872228E9],[13.0,50.0,4.0,1.215873838E9],[13.0,111.0,4.5,1.215873819E9],[13.0,277.0,3.0,1.21587347E9],[13.0,1148.0,3.0,1.215873857E9],[13.0,1213.0,4.0,1.215873724E9],[13.0,1223.0,3.5,1.21587385E9],[13.0,1359.0,4.5,1.215873565E9],[13.0,1722.0,2.5,1.215873449E9],[13.0,1920.0,3.0,1.215872286E9],[13.0,2133.0,3.5,1.215872213E9],[13.0,2633.0,3.5,1.215872526E9],[13.0,2959.0,4.0,1.215873716E9],[13.0,2991.0,3.5,1.215872232E9],[13.0,3082.0,4.0,1.215873488E9],[13.0,3113.0,2.5,1.21587219E9],[13.0,4005.0,3.0,1.215872502E9],[13.0,4878.0,4.0,1.215873678E9],[13.0,5424.0,1.5,1.21587307E9],[13.0,5879.0,3.0,1.215872817E9],[13.0,8620.0,5.0,1.215873688E9],[13.0,8641.0,3.5,1.215872321E9],[13.0,34150.0,2.5,1.215873901E9],[13.0,39715.0,3.0,1.215873894E9],[13.0,45662.0,2.5,1.215873918E9],[13.0,48394.0,4.0,1.215873783E9],[13.0,52458.0,4.0,1.215872756E9],[13.0,56003.0,3.5,1.215873945E9],[14.0,1.0,4.0,8.51766286E8],[14.0,3.0,3.0,8.51766337E8],[14.0,5.0,3.0,8.51766337E8],[14.0,7.0,3.0,8.51766337E8],[14.0,17.0,5.0,8.51766287E8],[14.0,62.0,3.0,8.51766287E8],[14.0,104.0,3.0,8.5176638E8],[14.0,141.0,5.0,8.51766287E8],[14.0,608.0,5.0,8.51766337E8],[14.0,648.0,3.0,8.51766288E8],[14.0,719.0,3.0,8.5176649E8],[14.0,724.0,3.0,8.51766456E8],[14.0,736.0,3.0,8.51766287E8],[14.0,761.0,2.0,8.5176649E8],[14.0,780.0,4.0,8.51766286E8],[14.0,784.0,2.0,8.5176638E8],[14.0,786.0,3.0,8.5176638E8],[14.0,852.0,3.0,8.51766515E8],[14.0,1073.0,5.0,8.5176638E8],[14.0,1356.0,4.0,8.51766456E8],[14.0,1367.0,4.0,8.5176662E8],[15.0,50.0,5.0,1.447478172E9],[15.0,101.0,5.0,1.447478451E9]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\""},{"name":"movieId","type":"\"integer\""},{"name":"rating","type":"\"double\""},{"name":"timestamp","type":"\"integer\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"startTime":1.464835787398E12,"submitTime":1.464835528659E12,"finishTime":1.464835787786E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5b43ec4d-fec2-48fb-b096-192ba53d1fbb"},{"version":"CommandV1","origId":123809,"guid":"e69a87b9-e508-4747-816f-5a913649a7f6","subtype":"command","commandType":"auto","position":1.84228515625,"command":"%md\nFor using mllib we need to get an RDD made of rows of `org.apache.spark.mllib.recommendation.Rating` as follows:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.46483552871E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8ec1e07d-5aa0-4afb-b3f4-eb0573e6380d"},{"version":"CommandV1","origId":123810,"guid":"4944d6e0-9286-45de-ab09-d7cd64ad2c2e","subtype":"command","commandType":"auto","position":1.8427734375,"command":"val ratings = ratingsText\n                .mapPartitionsWithIndex { (idx, iter) => if (idx == 0) iter.drop(1) else iter } // to drop first line\n                .map(_.split(',') match { case Array(user, item, rate, timestamp) =>\n                                              Rating(user.toInt, item.toInt, rate.toDouble) // to get Rating from user, item, rate\n               })","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratings: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[11728] at map at &lt;console&gt;:53\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:47: error: not found: value ratingsText\n       val ratings = ratingsText\n                     ^\n</div>","error":null,"startTime":1.464840310951E12,"submitTime":1.464840107739E12,"finishTime":1.464840311255E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3aabbbe6-44e7-4832-9f76-656ca641d257"},{"version":"CommandV1","origId":123811,"guid":"54846c1f-9b5f-4f8b-8097-6808fd11e37a","subtype":"command","commandType":"auto","position":1.84326171875,"command":"// Build the recommendation model using ALS\nval rank = 10\nval numIterations = 10\nval model = ALS.train(ratings, rank, numIterations, 0.01)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rank: Int = 10\nnumIterations: Int = 10\nmodel: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@7f9d390a\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.46484031363E12,"submitTime":1.464840110415E12,"finishTime":1.464840317136E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a900a180-da00-4795-8634-d8f63da2749e"},{"version":"CommandV1","origId":123812,"guid":"87f40d38-4f1e-4583-a556-f4354ee741c2","subtype":"command","commandType":"auto","position":1.843505859375,"command":"// Evaluate the model on rating data\nval usersProducts = ratings.map { case Rating(user, product, rate) =>\n  (user, product)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">usersProducts: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[11937] at map at &lt;console&gt;:54\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464840319102E12,"submitTime":1.464840115897E12,"finishTime":1.464840319212E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"409580e1-00c9-4b46-b377-2866dc6568ce"},{"version":"CommandV1","origId":123813,"guid":"f07e7c73-a313-4924-8a16-17ece04517f7","subtype":"command","commandType":"auto","position":1.8436279296875,"command":"val predictions =\n  model.predict(usersProducts).map { case Rating(user, product, rate) =>\n    ((user, product), rate)\n  }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictions: org.apache.spark.rdd.RDD[((Int, Int), Double)] = MapPartitionsRDD[11947] at map at &lt;console&gt;:62\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464840321306E12,"submitTime":1.464840118098E12,"finishTime":1.464840322128E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3b35931e-89b8-4602-b6a8-e1ef5beecfe0"},{"version":"CommandV1","origId":123814,"guid":"90c1b9c5-91fa-4866-8973-fb984320764e","subtype":"command","commandType":"auto","position":1.84368896484375,"command":"val ratesAndPreds = ratings.map { case Rating(user, product, rate) =>\n  ((user, product), rate)\n}.join(predictions)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ratesAndPreds: org.apache.spark.rdd.RDD[((Int, Int), (Double, Double))] = MapPartitionsRDD[11951] at join at &lt;console&gt;:65\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464840324456E12,"submitTime":1.464840121266E12,"finishTime":1.464840324601E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8d5eeba6-d4d6-474f-9c48-6cc6c022b99c"},{"version":"CommandV1","origId":123815,"guid":"cc054ab2-b716-4ee0-913e-67a0e88c2037","subtype":"command","commandType":"auto","position":1.843719482421875,"command":"val MSE = ratesAndPreds.map { case ((user, product), (r1, r2)) =>\n  val err = (r1 - r2)\n  err * err\n}.mean()\nprintln(\"Mean Squared Error = \" + MSE)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Mean Squared Error = 0.255044518403085\nMSE: Double = 0.255044518403085\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.464840326522E12,"submitTime":1.464840123299E12,"finishTime":1.464840328607E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3cd43577-82e6-4b44-a51c-5077a0e0e8e8"},{"version":"CommandV1","origId":123816,"guid":"19cbea41-555d-44f0-9217-5f3ac2eebfb9","subtype":"command","commandType":"auto","position":1.8437232971191406,"command":"%md\nWhat does `ALS.trainImplicit` do?\nExplain this by looking at the docs...","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.464835529051E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ce9f1115-f2d2-455b-be61-363f8e976b01"},{"version":"CommandV1","origId":123817,"guid":"35afe480-31a0-4659-a083-36a0fc814c17","subtype":"command","commandType":"auto","position":1.8437271118164062,"command":"val alpha = 0.01\nval lambda = 0.01\nval model = ALS.trainImplicit(ratings, rank, numIterations, lambda, alpha)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">alpha: Double = 0.01\nlambda: Double = 0.01\nmodel: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@7a33b9ee\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"startTime":1.46484033461E12,"submitTime":1.464840131416E12,"finishTime":1.464840339128E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0f5ec02e-9802-4efd-9335-3a1a0e04ea9e"},{"version":"CommandV1","origId":123818,"guid":"c2f755c7-d107-4812-8ac8-f294894fd967","subtype":"command","commandType":"auto","position":1.8437309265136719,"command":"// Save and load model  - SKIP for now \n//model.save(sc, \"target/tmp/myCollaborativeFilter\") // \"target/tmp/myCollaborativeFilter\" should be appropriately chosen\n//val sameModel = MatrixFactorizationModel.load(sc, \"target/tmp/myCollaborativeFilter\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"startTime":1.464835529182E12,"submitTime":1.464835529182E12,"finishTime":1.464835585258E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"hww22@uclive.ac.nz","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2f559b3a-6a19-45db-b222-34b3a701de1c"},{"version":"CommandV1","origId":136860,"guid":"b1972344-02b8-47fd-aad7-ea0698b3a5db","subtype":"command","commandType":"auto","position":2.843730926513672,"command":"%md\n# [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/)\n\n## Movie Recommender\n\n### Scalable data science project by Harry Wallace\n\n*supported by* [![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/databricks_logoTM_200px.png)](https://databricks.com/)\nand \n[![](https://raw.githubusercontent.com/raazesh-sainudiin/scalable-data-science/master/images/AWS_logoTM_200px.png)](https://www.awseducate.com/microsite/CommunitiesEngageHome)\n\nMost of the content below is from Module 5 of Anthony Joseph's edX course CS100-1x from the Community Edition of databricks that has been added to this databricks shard at [/#workspace/scalable-data-science/xtraResources/edXBigDataSeries2015/CS100-1x](/#workspace/scalable-data-science/xtraResources/edXBigDataSeries2015/CS100-1x) as extra resources for the project-focussed course [Scalable Data Science](http://www.math.canterbury.ac.nz/~r.sainudiin/courses/ScalableDataScience/). Here we use scala instead of python.\n\n(done with significant assistance from Raazesh Sainudiin for all the code in scala here)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3fe9b32f-7326-4199-9c1a-3b3079cc7b4a"}],"dashboards":[],"guid":"44e8094e-7a6c-4b6d-bac9-ff4897db8aaa","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201602081754420800-0c2673ac858e227cad536fdb45d140aeded238db/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
